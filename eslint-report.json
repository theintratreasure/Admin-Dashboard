[{"filePath":"E:\\Admin-frontend-als\\api\\axios.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\Components\\LoginCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\account-plan\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\account-security\\change-login-password\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\Dashboard\\DashboardOverview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\Topbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\account-plans\\AccountPlanForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\account-plans\\AccountPlanModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\account-plans\\AccountPlanTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\instrument\\InstrumentForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\kyc\\AdminKycTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\kyc\\AdminKycViewModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\market-setting\\MarketScheduleEditModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[594,597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[594,597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { X, Plus, Trash2 } from \"lucide-react\";\r\n\r\nimport PremiumInput from \"../ui/PremiumInput\";\r\nimport Toggle from \"../ui/Toggle\";\r\n\r\nimport { useUpdateMarketSchedule } from \"@/queries/marketSchedule.queries\";\r\nimport { MarketSegment } from \"@/services/marketSchedule.service\";\r\n\r\nconst DAYS = [\r\n  \"MONDAY\",\r\n  \"TUESDAY\",\r\n  \"WEDNESDAY\",\r\n  \"THURSDAY\",\r\n  \"FRIDAY\",\r\n  \"SATURDAY\",\r\n  \"SUNDAY\",\r\n];\r\n\r\nexport default function MarketScheduleEditModal({\r\n  segment,\r\n  data,\r\n  onClose,\r\n  onSaved,\r\n}: {\r\n  segment: MarketSegment;\r\n  data: any;\r\n  onClose: () => void;\r\n  onSaved: () => void;\r\n}) {\r\n  const updateMutation = useUpdateMarketSchedule(segment);\r\n\r\n  /* ===== STATES (ALL PUT FIELDS) ===== */\r\n  const [openTime, setOpenTime] = useState(data.openTime);\r\n  const [closeTime, setCloseTime] = useState(data.closeTime);\r\n  const [timezone, setTimezone] = useState(data.timezone);\r\n  const [isEnabled, setIsEnabled] = useState(data.isEnabled);\r\n\r\n  const [weeklyOff, setWeeklyOff] = useState<string[]>(data.weeklyOff || []);\r\n  const [holidays, setHolidays] = useState<string[]>(data.holidays || []);\r\n\r\n  const [satClose, setSatClose] = useState(\r\n    data.dayOverrides?.SATURDAY?.closeTime || \"\"\r\n  );\r\n\r\n  const [dateOverrides, setDateOverrides] = useState<\r\n    Record<string, { closeTime: string }>\r\n  >(data.dateOverrides || {});\r\n\r\n  const [newHoliday, setNewHoliday] = useState(\"\");\r\n  const [newDate, setNewDate] = useState(\"\");\r\n  const [newDateClose, setNewDateClose] = useState(\"\");\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\">\r\n      <div className=\"w-[95%] max-w-2xl rounded-xl bg-[var(--card-bg)] border border-[var(--card-border)] shadow-xl overflow-y-auto max-h-[90vh]\">\r\n\r\n        {/* HEADER */}\r\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-[var(--card-border)]\">\r\n          <h2 className=\"text-lg font-semibold\">Edit Market Schedule</h2>\r\n          <button onClick={onClose}>\r\n            <X size={18} />\r\n          </button>\r\n        </div>\r\n\r\n        {/* BODY */}\r\n        <div className=\"px-6 py-5 space-y-6\">\r\n\r\n          {/* TIME */}\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            <PremiumInput label=\"Open Time\" value={openTime} onChange={setOpenTime} />\r\n            <PremiumInput label=\"Close Time\" value={closeTime} onChange={setCloseTime} />\r\n          </div>\r\n\r\n          {/* TIMEZONE */}\r\n          <PremiumInput\r\n            label=\"Timezone\"\r\n            value={timezone}\r\n            onChange={setTimezone}\r\n          />\r\n\r\n          {/* WEEKLY OFF */}\r\n          <div>\r\n            <p className=\"text-sm mb-2 text-[var(--text-muted)]\">Weekly Off</p>\r\n            <div className=\"flex flex-wrap gap-3\">\r\n              {DAYS.map((day) => (\r\n                <label key={day} className=\"flex gap-2 items-center text-sm\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={weeklyOff.includes(day)}\r\n                    onChange={() =>\r\n                      setWeeklyOff((prev) =>\r\n                        prev.includes(day)\r\n                          ? prev.filter((d) => d !== day)\r\n                          : [...prev, day]\r\n                      )\r\n                    }\r\n                  />\r\n                  {day}\r\n                </label>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* HOLIDAYS */}\r\n          <div>\r\n            <p className=\"text-sm mb-2 text-[var(--text-muted)]\">Holidays</p>\r\n            <div className=\"flex gap-2\">\r\n              <input\r\n                type=\"date\"\r\n                value={newHoliday}\r\n                onChange={(e) => setNewHoliday(e.target.value)}\r\n                className=\"input\"\r\n              />\r\n              <button\r\n                className=\"btn btn-primary\"\r\n                onClick={() => {\r\n                  if (!newHoliday) return;\r\n                  setHolidays([...holidays, newHoliday]);\r\n                  setNewHoliday(\"\");\r\n                }}\r\n              >\r\n                <Plus size={16} />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"mt-2 space-y-1\">\r\n              {holidays.map((h) => (\r\n                <div key={h} className=\"flex items-center justify-between pill\">\r\n                  {h}\r\n                  <button onClick={() => setHolidays(holidays.filter(x => x !== h))}>\r\n                    <Trash2 size={14} />\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* SATURDAY OVERRIDE */}\r\n          <PremiumInput\r\n            label=\"Saturday Close Time\"\r\n            value={satClose}\r\n            onChange={setSatClose}\r\n          />\r\n\r\n          {/* DATE OVERRIDES */}\r\n          <div>\r\n            <p className=\"text-sm mb-2 text-[var(--text-muted)]\">Date Overrides</p>\r\n\r\n            <div className=\"grid md:grid-cols-3 gap-2\">\r\n              <input type=\"date\" value={newDate} onChange={e => setNewDate(e.target.value)} className=\"input\" />\r\n              <input type=\"time\" value={newDateClose} onChange={e => setNewDateClose(e.target.value)} className=\"input\" />\r\n              <button\r\n                className=\"btn btn-primary\"\r\n                onClick={() => {\r\n                  if (!newDate || !newDateClose) return;\r\n                  setDateOverrides({\r\n                    ...dateOverrides,\r\n                    [newDate]: { closeTime: newDateClose },\r\n                  });\r\n                  setNewDate(\"\");\r\n                  setNewDateClose(\"\");\r\n                }}\r\n              >\r\n                <Plus size={16} />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"mt-2 space-y-1\">\r\n              {Object.entries(dateOverrides).map(([date, obj]) => (\r\n                <div key={date} className=\"flex items-center justify-between pill\">\r\n                  {date} â†’ {obj.closeTime}\r\n                  <button\r\n                    onClick={() => {\r\n                      const copy = { ...dateOverrides };\r\n                      delete copy[date];\r\n                      setDateOverrides(copy);\r\n                    }}\r\n                  >\r\n                    <Trash2 size={14} />\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* ENABLE */}\r\n          <Toggle\r\n            label=\"Market Enabled\"\r\n            value={isEnabled}\r\n            onChange={setIsEnabled}\r\n          />\r\n        </div>\r\n\r\n        {/* FOOTER */}\r\n        <div className=\"flex justify-end gap-3 px-6 py-4 border-t border-[var(--card-border)]\">\r\n          <button onClick={onClose} className=\"btn btn-ghost\">\r\n            Cancel\r\n          </button>\r\n\r\n          <button\r\n            disabled={updateMutation.isPending}\r\n            onClick={async () => {\r\n              await updateMutation.mutateAsync({\r\n                openTime,\r\n                closeTime,\r\n                weeklyOff,\r\n                holidays,\r\n                timezone,\r\n                isEnabled,\r\n                dayOverrides: satClose\r\n                  ? { SATURDAY: { closeTime: satClose } }\r\n                  : undefined,\r\n                dateOverrides:\r\n                  Object.keys(dateOverrides).length > 0\r\n                    ? dateOverrides\r\n                    : undefined,\r\n              });\r\n              onSaved();\r\n            }}\r\n            className=\"btn btn-primary\"\r\n          >\r\n            {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\payment\\AddPaymentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[580,583],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[580,583],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":187,"column":37,"nodeType":"JSXOpeningElement","endLine":191,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { uploadToCloudinary } from \"@/services/cloudinary.service\";\r\nimport { useAddPaymentMethod } from \"@/hooks/payment-method/useAddPaymentMethod\";\r\nimport GlobalLoader from \"../ui/GlobalLoader\";\r\nimport { X } from \"lucide-react\";\r\nimport { Landmark, QrCode, Bitcoin } from \"lucide-react\";\r\n\r\nexport default function AddPaymentModal({ onClose }: { onClose: () => void }) {\r\n    const add = useAddPaymentMethod();\r\n    const [type, setType] = useState<\"BANK\" | \"UPI\" | \"CRYPTO\">(\"BANK\");\r\n    const [form, setForm] = useState<any>({});\r\n    const [file, setFile] = useState<File | null>(null);\r\n    const [preview, setPreview] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const submit = async () => {\r\n        if (!file) return;\r\n        setLoading(true);\r\n\r\n        const img = await uploadToCloudinary(file);\r\n\r\n        add.mutate(\r\n            {\r\n                type,\r\n                title: form.title,\r\n                bank_name: form.bank_name,\r\n                account_name: form.account_name,\r\n                account_number: form.account_number,\r\n                ifsc: form.ifsc,\r\n                upi_id: form.upi_id,\r\n                crypto_network: form.crypto_network,\r\n                crypto_address: form.crypto_address,\r\n                image_url: img.secure_url,\r\n                image_public_id: img.public_id,\r\n            },\r\n            { onSuccess: onClose, onSettled: () => setLoading(false) }\r\n        );\r\n    };\r\n\r\n    const handleFileChange = (f: File | null) => {\r\n        setFile(f);\r\n        setPreview(f ? URL.createObjectURL(f) : null);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {loading && <GlobalLoader />}\r\n\r\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm\">\r\n                <div\r\n                    className=\"relative w-full max-w-xl rounded-2xl\r\n          bg-[var(--card-bg)]\r\n          border border-[var(--card-border)]\r\n          shadow-2xl shadow-black/40\r\n          px-6 py-5 md:px-8 md:py-6\"\r\n                >\r\n                    {/* Close */}\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"absolute right-4 top-4 inline-flex h-8 w-8 items-center justify-center rounded-full\r\n            bg-[var(--hover-bg)]\r\n            text-[var(--text-muted)]\r\n            hover:opacity-80 transition\"\r\n                    >\r\n                        <X size={16} />\r\n                    </button>\r\n\r\n                    {/* Header */}\r\n                    <div className=\"mb-4 space-y-1 pr-8\">\r\n                        <h2 className=\"text-xl md:text-2xl font-semibold tracking-tight text-[var(--foreground)]\">\r\n                            Add payment method\r\n                        </h2>\r\n                        <p className=\"text-xs md:text-sm text-[var(--text-muted)]\">\r\n                            These details will be shared with customers when they pay you.\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Content */}\r\n                    <div className=\"space-y-5 max-h-[70vh] overflow-y-auto pr-1\">\r\n                        {/* Top row */}\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-xs font-medium text-[var(--text-muted)] mb-1.5\">\r\n                                    Payment type\r\n                                </label>\r\n\r\n                                <div className=\"flex gap-2\">\r\n  {([\"BANK\", \"UPI\", \"CRYPTO\"] as const).map((v) => {\r\n    const Icon =\r\n      v === \"BANK\"\r\n        ? Landmark\r\n        : v === \"UPI\"\r\n        ? QrCode\r\n        : Bitcoin;\r\n\r\n    return (\r\n      <button\r\n        key={v}\r\n        type=\"button\"\r\n        onClick={() => setType(v)}\r\n        className={`flex flex-1 items-center justify-center gap-2 rounded-lg border px-3 py-2\r\n        text-xs md:text-sm font-medium transition\r\n        ${\r\n          type === v\r\n            ? \"border-[var(--success)] bg-[var(--hover-bg)] text-[var(--foreground)]\"\r\n            : \"border-[var(--card-border)] bg-[var(--hover-bg)] text-[var(--text-muted)] hover:opacity-80\"\r\n        }`}\r\n      >\r\n        <Icon size={16} />\r\n        <span>\r\n          {v === \"BANK\" && \"Bank\"}\r\n          {v === \"UPI\" && \"UPI\"}\r\n          {v === \"CRYPTO\" && \"Crypto\"}\r\n        </span>\r\n      </button>\r\n    );\r\n  })}\r\n</div>\r\n\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-xs font-medium text-[var(--text-muted)] mb-1.5\">\r\n                                    Title\r\n                                </label>\r\n                                <input\r\n                                    className=\"input w-full\"\r\n                                    placeholder=\"e.g. Primary business account\"\r\n                                    onChange={(e) =>\r\n                                        setForm({ ...form, title: e.target.value })\r\n                                    }\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Fields */}\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            {type === \"BANK\" && (\r\n                                <>\r\n                                    <Input label=\"Bank name\" placeholder=\"HDFC Bank\" onChange={(v) => setForm({ ...form, bank_name: v })} />\r\n                                    <Input label=\"Account holder\" placeholder=\"John Doe\" onChange={(v) => setForm({ ...form, account_name: v })} />\r\n                                    <Input label=\"Account number\" placeholder=\"************1234\" onChange={(v) => setForm({ ...form, account_number: v })} />\r\n                                    <Input label=\"IFSC code\" placeholder=\"HDFC0001234\" onChange={(v) => setForm({ ...form, ifsc: v })} />\r\n                                </>\r\n                            )}\r\n\r\n                            {type === \"UPI\" && (\r\n                                <Input label=\"UPI ID\" placeholder=\"username@upi\" onChange={(v) => setForm({ ...form, upi_id: v })} />\r\n                            )}\r\n\r\n                            {type === \"CRYPTO\" && (\r\n                                <>\r\n                                    <Input label=\"Network\" placeholder=\"TRC20 / ERC20 / Polygon\" onChange={(v) => setForm({ ...form, crypto_network: v })} />\r\n                                    <Input label=\"Wallet address\" placeholder=\"0x...\" onChange={(v) => setForm({ ...form, crypto_address: v })} />\r\n                                </>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Upload */}\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"block text-xs font-medium text-[var(--text-muted)]\">\r\n                                Proof / QR / Image\r\n                            </label>\r\n\r\n                            <div className=\"flex flex-col gap-2 rounded-xl border border-dashed border-[var(--card-border)]\r\n              bg-[var(--hover-bg)] p-3 text-xs text-[var(--text-muted)]\">\r\n                                <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n                                    <p>Upload a QR code, cheque, or reference image.</p>\r\n                                    <label className=\"inline-flex cursor-pointer items-center rounded-lg bg-[var(--primary)] px-3 py-1.5 text-xs font-medium text-white\">\r\n                                        Choose file\r\n                                        <input\r\n                                            type=\"file\"\r\n                                            className=\"hidden\"\r\n                                            accept=\"image/*\"\r\n                                            onChange={(e) =>\r\n                                                handleFileChange(e.target.files?.[0] || null)\r\n                                            }\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {preview && (\r\n                                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--hover-bg)] p-2 inline-block\">\r\n                                    <img\r\n                                        src={preview}\r\n                                        alt=\"Preview\"\r\n                                        className=\"max-h-40 rounded-md object-contain\"\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Footer */}\r\n                    <div className=\"mt-5 flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\">\r\n                        <button className=\"btn btn-ghost\" onClick={onClose}>\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            className=\"btn btn-primary disabled:opacity-60\"\r\n                            onClick={submit}\r\n                            disabled={loading || !file || !form.title}\r\n                        >\r\n                            Save payment method\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nfunction Input({\r\n    label,\r\n    value,\r\n    onChange,\r\n    placeholder,\r\n}: {\r\n    label: string;\r\n    value?: string;\r\n    placeholder?: string;\r\n    onChange: (v: string) => void;\r\n}) {\r\n    return (\r\n        <div className=\"space-y-1\">\r\n            <label className=\"block text-xs font-medium text-[var(--text-muted)]\">\r\n                {label}\r\n            </label>\r\n            <input\r\n                className=\"input w-full\"\r\n                defaultValue={value}\r\n                placeholder={placeholder}\r\n                onChange={(e) => onChange(e.target.value)}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\payment\\EditPaymentModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[374,377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[374,377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[489,492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[489,492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[773,776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[773,776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":147,"column":19,"nodeType":"JSXOpeningElement","endLine":151,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { uploadToCloudinary } from \"@/services/cloudinary.service\";\r\nimport { useUpdatePaymentMethod } from \"@/hooks/payment-method/useUpdatePaymentMethod\";\r\nimport GlobalLoader from \"../ui/GlobalLoader\";\r\nimport { X } from \"lucide-react\";\r\n\r\nexport default function EditPaymentModal({\r\n  data,\r\n  onClose,\r\n}: {\r\n  data: any;\r\n  onClose: () => void;\r\n}) {\r\n  const update = useUpdatePaymentMethod();\r\n  const [form, setForm] = useState<any>({ ...data });\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [preview, setPreview] = useState<string | null>(data.image_url || null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const save = async () => {\r\n    setLoading(true);\r\n\r\n    const payload: any = {\r\n      title: form.title,\r\n      bank_name: form.bank_name,\r\n      account_name: form.account_name,\r\n      account_number: form.account_number,\r\n      ifsc: form.ifsc,\r\n      upi_id: form.upi_id,\r\n      crypto_network: form.crypto_network,\r\n      crypto_address: form.crypto_address,\r\n    };\r\n\r\n    if (file) {\r\n      const img = await uploadToCloudinary(file);\r\n      payload.image_url = img.secure_url;\r\n      payload.image_public_id = img.public_id;\r\n    }\r\n\r\n    update.mutate(\r\n      { id: data._id, payload },\r\n      {\r\n        onSuccess: onClose,\r\n        onSettled: () => setLoading(false),\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleFileChange = (f: File | null) => {\r\n    setFile(f);\r\n    setPreview(f ? URL.createObjectURL(f) : data.image_url || null);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {loading && <GlobalLoader />}\r\n\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm\">\r\n        <div\r\n          className=\"relative w-full max-w-xl rounded-2xl\r\n          bg-[var(--card-bg)]\r\n          border border-[var(--card-border)]\r\n          shadow-2xl shadow-black/40\r\n          px-6 py-5 md:px-8 md:py-6 animate-[fadeIn_0.18s_ease-out]\"\r\n        >\r\n          {/* Close */}\r\n          <button\r\n            onClick={onClose}\r\n            className=\"absolute right-4 top-4 inline-flex h-8 w-8 items-center justify-center rounded-full\r\n            bg-[var(--hover-bg)]\r\n            text-[var(--text-muted)]\r\n            hover:opacity-80 transition\"\r\n          >\r\n            <X size={16} />\r\n          </button>\r\n\r\n          {/* Header */}\r\n          <div className=\"mb-4 space-y-1 pr-8\">\r\n            <h2 className=\"text-xl md:text-2xl font-semibold tracking-tight text-[var(--foreground)]\">\r\n              Edit payment method\r\n            </h2>\r\n            <p className=\"text-xs md:text-sm text-[var(--text-muted)]\">\r\n              Update existing payout details for this method.\r\n            </p>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"space-y-5 max-h-[70vh] overflow-y-auto pr-1\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <Field\r\n                label=\"Title\"\r\n                value={form.title}\r\n                onChange={(v) => setForm({ ...form, title: v })}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              {form.type === \"BANK\" && (\r\n                <>\r\n                  <Field label=\"Bank name\" placeholder=\"HDFC Bank\" value={form.bank_name} onChange={(v) => setForm({ ...form, bank_name: v })} />\r\n                  <Field label=\"Account holder\" placeholder=\"John Doe\" value={form.account_name} onChange={(v) => setForm({ ...form, account_name: v })} />\r\n                  <Field label=\"Account number\" placeholder=\"************1234\" value={form.account_number} onChange={(v) => setForm({ ...form, account_number: v })} />\r\n                  <Field label=\"IFSC code\" placeholder=\"HDFC0001234\" value={form.ifsc} onChange={(v) => setForm({ ...form, ifsc: v })} />\r\n                </>\r\n              )}\r\n\r\n              {form.type === \"UPI\" && (\r\n                <Field label=\"UPI ID\" placeholder=\"username@upi\" value={form.upi_id} onChange={(v) => setForm({ ...form, upi_id: v })} />\r\n              )}\r\n\r\n              {form.type === \"CRYPTO\" && (\r\n                <>\r\n                  <Field label=\"Network\" placeholder=\"TRC20 / ERC20 / Polygon\" value={form.crypto_network} onChange={(v) => setForm({ ...form, crypto_network: v })} />\r\n                  <Field label=\"Wallet address\" placeholder=\"0x...\" value={form.crypto_address} onChange={(v) => setForm({ ...form, crypto_address: v })} />\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            {/* Upload */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"block text-xs font-medium text-[var(--text-muted)]\">\r\n                Replace image (optional)\r\n              </label>\r\n\r\n              <div className=\"flex flex-col gap-2 rounded-xl border border-dashed border-[var(--card-border)]\r\n              bg-[var(--hover-bg)] p-3 text-xs text-[var(--text-muted)]\">\r\n                <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n                  <p>Upload a new QR or proof image.</p>\r\n                  <label className=\"inline-flex cursor-pointer items-center rounded-lg bg-[var(--primary)] px-3 py-1.5 text-xs font-medium text-white\">\r\n                    Upload\r\n                    <input\r\n                      type=\"file\"\r\n                      className=\"hidden\"\r\n                      accept=\"image/*\"\r\n                      onChange={(e) =>\r\n                        handleFileChange(e.target.files?.[0] || null)\r\n                      }\r\n                    />\r\n                  </label>\r\n                </div>\r\n              </div>\r\n\r\n              {preview && (\r\n                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--hover-bg)] p-2 inline-block\">\r\n                  <img\r\n                    src={preview}\r\n                    alt=\"Payment image\"\r\n                    className=\"max-h-40 rounded-md object-contain\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"mt-5 flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\">\r\n            <button className=\"btn btn-ghost\" onClick={onClose}>\r\n              Cancel\r\n            </button>\r\n            <button\r\n              className=\"btn btn-primary disabled:opacity-60\"\r\n              onClick={save}\r\n              disabled={loading || !form.title}\r\n            >\r\n              Save changes\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction Field({\r\n  label,\r\n  value,\r\n  onChange,\r\n  placeholder,\r\n}: {\r\n  label: string;\r\n  value?: string;\r\n  placeholder?: string;\r\n  onChange: (v: string) => void;\r\n}) {\r\n  return (\r\n    <div className=\"space-y-1\">\r\n      <label className=\"block text-xs font-medium text-[var(--text-muted)]\">\r\n        {label}\r\n      </label>\r\n      <input\r\n        className=\"input w-full\"\r\n        value={value || \"\"}\r\n        placeholder={placeholder}\r\n        onChange={(e) => onChange(e.target.value)}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\payment\\PaymentMethodCard.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":164,"column":15,"nodeType":"JSXOpeningElement","endLine":169,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\nimport {\n  Bitcoin,\n  Building2,\n  Copy,\n  CreditCard,\n  Landmark,\n  Pencil,\n  QrCode,\n  Trash2,\n} from \"lucide-react\";\nimport { useTogglePaymentStatus } from \"@/hooks/payment-method/useTogglePaymentStatus\";\nimport { useDeletePaymentMethod } from \"@/hooks/payment-method/useDeletePaymentMethod\";\nimport type { PaymentType } from \"@/services/payment-method/payment-method.service\";\n\ntype PaymentMethod = {\n  _id: string;\n  type: PaymentType;\n  title: string;\n  is_active: boolean;\n  bank_name?: string;\n  account_name?: string;\n  account_number?: string;\n  ifsc?: string;\n  upi_id?: string;\n  crypto_network?: string;\n  crypto_address?: string;\n  image_url?: string;\n};\n\nexport default function PaymentMethodCard({\n  data,\n  onEdit,\n}: {\n  data: PaymentMethod;\n  onEdit: () => void;\n}) {\n  const toggle = useTogglePaymentStatus();\n  const del = useDeletePaymentMethod();\n  const [toast, setToast] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!toast) return;\n    const t = setTimeout(() => setToast(null), 2000);\n    return () => clearTimeout(t);\n  }, [toast]);\n\n  const typeMeta = getTypeMeta(data.type);\n  const TypeIcon = typeMeta.icon;\n\n  return (\n    <article className=\"relative overflow-hidden rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)]\">\n      <div className={`h-1 w-full ${typeMeta.stripClass}`} />\n\n      <div className=\"space-y-4 p-4 sm:p-5\">\n        <div className=\"flex flex-wrap items-start justify-between gap-3\">\n          <div className=\"min-w-0\">\n            <div className=\"flex flex-wrap items-center gap-2\">\n              <span\n                className={`inline-flex items-center gap-1 rounded-full border px-2.5 py-1 text-[10px] font-semibold uppercase tracking-wide ${typeMeta.pillClass}`}\n              >\n                <TypeIcon size={12} />\n                {typeMeta.label}\n              </span>\n              <span\n                className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${\n                  data.is_active\n                    ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n                    : \"border-rose-500/40 bg-rose-500/10 text-rose-700\"\n                }`}\n              >\n                {data.is_active ? \"Active\" : \"Inactive\"}\n              </span>\n            </div>\n            <h3 className=\"mt-2 truncate text-base font-semibold text-[var(--foreground)] sm:text-lg\">\n              {data.title || \"Untitled Method\"}\n            </h3>\n            <p className=\"text-xs text-[var(--text-muted)]\">{typeMeta.description}</p>\n          </div>\n\n          <label className=\"inline-flex items-center gap-2 rounded-full border border-[var(--card-border)] bg-[var(--input-bg)] px-2 py-1 text-[11px] font-medium text-[var(--text-muted)]\">\n            {data.is_active ? \"Enabled\" : \"Disabled\"}\n            <button\n              type=\"button\"\n              aria-label=\"Toggle payment status\"\n              onClick={() =>\n                toggle.mutate({ id: data._id, is_active: !data.is_active })\n              }\n              className={`relative inline-flex h-5 w-9 items-center rounded-full border transition ${\n                data.is_active\n                  ? \"border-emerald-500/50 bg-emerald-500/20\"\n                  : \"border-slate-400/60 bg-slate-300/40\"\n              }`}\n            >\n              <span\n                className={`h-4 w-4 rounded-full bg-white shadow-sm transition-transform ${\n                  data.is_active ? \"translate-x-4\" : \"translate-x-0.5\"\n                }`}\n              />\n            </button>\n          </label>\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-2\">\n          {data.type === \"BANK\" && (\n            <>\n              <CopyField\n                icon={Landmark}\n                label=\"Bank Name\"\n                value={data.bank_name}\n                onCopy={() => setToast(\"Bank name copied\")}\n              />\n              <CopyField\n                icon={Building2}\n                label=\"Account Holder\"\n                value={data.account_name}\n                onCopy={() => setToast(\"Account holder copied\")}\n              />\n              <CopyField\n                icon={CreditCard}\n                label=\"Account Number\"\n                value={data.account_number}\n                onCopy={() => setToast(\"Account number copied\")}\n              />\n              <CopyField\n                icon={Building2}\n                label=\"IFSC\"\n                value={data.ifsc}\n                onCopy={() => setToast(\"IFSC copied\")}\n              />\n            </>\n          )}\n\n          {data.type === \"UPI\" && (\n            <CopyField\n              icon={QrCode}\n              label=\"UPI ID\"\n              value={data.upi_id}\n              onCopy={() => setToast(\"UPI ID copied\")}\n            />\n          )}\n\n          {data.type === \"CRYPTO\" && (\n            <>\n              <CopyField\n                icon={Bitcoin}\n                label=\"Network\"\n                value={data.crypto_network}\n                onCopy={() => setToast(\"Network copied\")}\n              />\n              <CopyField\n                icon={Bitcoin}\n                label=\"Wallet Address\"\n                value={data.crypto_address}\n                onCopy={() => setToast(\"Wallet address copied\")}\n              />\n            </>\n          )}\n        </div>\n\n        {data.image_url && (\n          <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-2\">\n            <div className=\"flex h-44 w-full items-center justify-center overflow-hidden rounded-lg border border-[var(--card-border)]/60 bg-gradient-to-br from-slate-100/60 via-white to-slate-100/50\">\n              <img\n                src={data.image_url}\n                alt={`${data.title} preview`}\n                loading=\"lazy\"\n                className=\"h-full w-full object-contain p-1\"\n              />\n            </div>\n          </div>\n        )}\n\n        <div className=\"flex flex-wrap items-center justify-end gap-2\">\n          <button\n            className=\"inline-flex items-center gap-1.5 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n            onClick={onEdit}\n          >\n            <Pencil size={13} />\n            Edit\n          </button>\n          <button\n            className=\"inline-flex items-center gap-1.5 rounded-lg border border-rose-500/30 bg-rose-500/5 px-3 py-2 text-xs font-semibold text-rose-600 hover:bg-rose-500/10\"\n            onClick={() => del.mutate(data._id)}\n          >\n            <Trash2 size={13} />\n            Delete\n          </button>\n        </div>\n      </div>\n\n      {toast && (\n        <div className=\"pointer-events-none absolute bottom-3 right-3 rounded-md bg-[var(--foreground)] px-2.5 py-1 text-[11px] font-medium text-white\">\n          {toast}\n        </div>\n      )}\n    </article>\n  );\n}\n\nfunction CopyField({\n  icon: Icon,\n  label,\n  value,\n  onCopy,\n}: {\n  icon: typeof Landmark;\n  label: string;\n  value?: string;\n  onCopy: () => void;\n}) {\n  const content = value?.trim() || \"--\";\n\n  const copy = async () => {\n    if (!value?.trim()) return;\n    await navigator.clipboard.writeText(value);\n    onCopy();\n  };\n\n  return (\n    <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2.5\">\n      <p className=\"inline-flex items-center gap-1.5 text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n        <Icon size={12} />\n        {label}\n      </p>\n      <div className=\"mt-1 flex items-center justify-between gap-2\">\n        <p className=\"truncate font-mono text-sm text-[var(--foreground)]\">{content}</p>\n        <button\n          type=\"button\"\n          onClick={copy}\n          className=\"inline-flex h-7 w-7 items-center justify-center rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)] hover:text-[var(--foreground)]\"\n          title={`Copy ${label}`}\n        >\n          <Copy size={12} />\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction getTypeMeta(type: PaymentType) {\n  if (type === \"BANK\") {\n    return {\n      label: \"Bank\",\n      description: \"Bank transfer details for manual deposits and payouts.\",\n      icon: Landmark,\n      stripClass: \"bg-gradient-to-r from-sky-500 to-blue-500\",\n      pillClass: \"border-sky-500/40 bg-sky-500/10 text-sky-700\",\n    };\n  }\n\n  if (type === \"UPI\") {\n    return {\n      label: \"UPI\",\n      description: \"UPI handle for instant payment collection.\",\n      icon: QrCode,\n      stripClass: \"bg-gradient-to-r from-violet-500 to-fuchsia-500\",\n      pillClass: \"border-violet-500/40 bg-violet-500/10 text-violet-700\",\n    };\n  }\n\n  return {\n    label: \"Crypto\",\n    description: \"Wallet address and network for crypto transactions.\",\n    icon: Bitcoin,\n    stripClass: \"bg-gradient-to-r from-amber-500 to-orange-500\",\n    pillClass: \"border-amber-500/40 bg-amber-500/10 text-amber-700\",\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\payment\\PaymentMethodPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\AdminCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\ConfirmModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\GlobalLoader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\PremiumInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\Toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\Toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\dollar-rate\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\health\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\inquiry\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\instruments\\action-ledger\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\instruments\\manage-scrips\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":9},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'form'. Either include it or remove the dependency array.","line":183,"column":6,"nodeType":"ArrayExpression","endLine":183,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [openForm, form.code, form.segment, form]","fix":{"range":[5396,5433],"text":"[openForm, form.code, form.segment, form]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":189,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5572,5575],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5572,5575],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":221,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6222,6225],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6222,6225],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":465,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":465,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15862,15865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15862,15865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":571,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":571,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20582,20585],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20582,20585],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useMemo, useCallback, useEffect, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\n  Search,\n  Plus,\n  Pencil,\n  Trash2,\n  X,\n  Bitcoin,\n  Landmark,\n  Layers,\n  CandlestickChart,\n  SlidersHorizontal,\n  Hash,\n  Type,\n  Boxes,\n  ArrowDownToLine,\n  ArrowUpToLine,\n  Sigma,\n  DollarSign,\n  MoveHorizontal,\n  Package,\n  ArrowUpRight,\n  ArrowDownRight,\n  ToggleRight,\n  BadgeCheck,\n  Power,\n} from \"lucide-react\";\n\r\nimport { useInstruments } from \"@/hooks/instruments/useInstruments\";\r\nimport { useCreateInstrument } from \"@/hooks/instruments/useCreateInstrument\";\r\nimport { useUpdateInstrument } from \"@/hooks/instruments/useUpdateInstrument\";\r\nimport { useDeleteInstrument } from \"@/hooks/instruments/useDeleteInstrument\";\r\n\r\nimport Pagination from \"../../components/ui/pagination\";\r\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\r\nimport PremiumInput from \"../../components/ui/PremiumInput\";\r\nimport Toggle from \"../../components/ui/Toggle\";\r\nimport ConfirmModal from \"../../components/ui/ConfirmModal\";\nimport { getSymbolList, SymbolListItem } from \"@/services/instrument.service\";\n\r\n/* ================= TYPES ================= */\r\n\r\ntype InstrumentFormState = {\n  _id?: string;\n  code: string;\n  name: string;\n  segment: string;\n  lotSize: number;\n  minQty: number;\n  maxQty: number;\n  qtyPrecision: number;\n  pricePrecision: number;\n  tickSize?: number | null;\n  spread: number;\n  contractSize: number;\n  swapEnabled: boolean;\n  swapLong: number;\n  swapShort: number;\n  isActive: boolean;\n  isTradeable: boolean;\n};\n\r\n/* ================= PAGE ================= */\r\n\r\nexport default function ManageInstruments() {\r\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(10);\n  const [search, setSearch] = useState(\"\");\n  const [isMobile, setIsMobile] = useState(false);\n  const [segment, setSegment] = useState<string | undefined>(undefined);\n  const [viewOpen, setViewOpen] = useState(false);\n  const viewBoxRef = useRef<HTMLDivElement | null>(null);\n  const symbolBoxRef = useRef<HTMLDivElement | null>(null);\n  const [symbolOpen, setSymbolOpen] = useState(false);\n  const [symbolLoading, setSymbolLoading] = useState(false);\n  const [symbolResults, setSymbolResults] = useState<SymbolListItem[]>([]);\n\r\n  const [openForm, setOpenForm] = useState(false);\r\n  const [form, setForm] = useState<InstrumentFormState | null>(null);\r\n  const [confirmOpen, setConfirmOpen] = useState(false);\r\n  const [selectedId, setSelectedId] = useState<string | null>(null);\n  const { data, isLoading } = useInstruments({ page, limit, segment });\n  const createMutation = useCreateInstrument();\n  const updateMutation = useUpdateInstrument();\n  const deleteMutation = useDeleteInstrument();\n  const [visibleCols, setVisibleCols] = useState({\n    code: true,\n    name: true,\n    segment: true,\n    lot: true,\n    minQty: true,\n    maxQty: true,\n    qtyPrecision: true,\n    pricePrecision: true,\n    tickSize: true,\n    spread: true,\n    swapLong: true,\n    swapShort: true,\n    contract: true,\n    swap: true,\n    tradeable: true,\n    active: true,\n    actions: true,\n  });\n\n  useEffect(() => {\n    const update = () => setIsMobile(window.innerWidth < 768);\n    update();\n    window.addEventListener(\"resize\", update);\n    return () => window.removeEventListener(\"resize\", update);\n  }, []);\n\n  useEffect(() => {\n    const onClick = (e: Event) => {\n      const target = e.target as Node;\n      const path = (e as Event & { composedPath?: () => EventTarget[] }).composedPath?.();\n      const isInsideView =\n        !!viewBoxRef.current &&\n        (viewBoxRef.current.contains(target) ||\n          (path && path.includes(viewBoxRef.current)));\n      if (!isInsideView) setViewOpen(false);\n      const isInsideSymbol =\n        !!symbolBoxRef.current &&\n        (symbolBoxRef.current.contains(target) ||\n          (path && path.includes(symbolBoxRef.current)));\n      if (!isInsideSymbol) setSymbolOpen(false);\n    };\n    document.addEventListener(\"mousedown\", onClick, true);\n    document.addEventListener(\"touchstart\", onClick, true);\n    return () => {\n      document.removeEventListener(\"mousedown\", onClick, true);\n      document.removeEventListener(\"touchstart\", onClick, true);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!openForm || !form) return;\n    const q = String(form.code || \"\").trim().toUpperCase();\n    if (!q) {\n      setSymbolResults([]);\n      setSymbolLoading(false);\n      return;\n    }\n\n    let active = true;\n    const handler = setTimeout(async () => {\n      setSymbolLoading(true);\n      const segKey = (form.segment || \"\").toUpperCase();\n      const category =\n        segKey === \"FOREX\"\n          ? \"FX\"\n          : segKey === \"CRYPTO\"\n          ? \"CRYPTO\"\n          : segKey === \"METAL\" || segKey === \"METALS\"\n          ? \"METAL\"\n          : segKey === \"INDICES\" || segKey === \"INDEX\"\n          ? \"INDEXES\"\n          : undefined;\n\n      try {\n        const list = await getSymbolList({\n          page: 1,\n          limit: 50,\n          search: q,\n          category,\n          isActive: true,\n          sortBy: \"createdAt\",\n          sortOrder: \"desc\",\n        });\n        if (active) setSymbolResults(list);\n      } finally {\n        if (active) setSymbolLoading(false);\n      }\n    }, 350);\n\n    return () => {\n      active = false;\n      clearTimeout(handler);\n    };\n  }, [openForm, form?.code, form?.segment]);\n\n  const instruments = useMemo(() => {\r\n    const rows = data?.data ?? [];\r\n    if (!search) return rows;\r\n\r\n    return rows.filter((r: any) =>\r\n      Object.values(r)\r\n        .join(\" \")\r\n        .toLowerCase()\r\n        .includes(search.toLowerCase())\r\n    );\r\n  }, [data, search]);\r\n\r\n  const totalPages = data?.pagination?.totalPages || 1;\r\n\r\n  const openCreate = () => {\r\n    setForm({\r\n      code: \"\",\r\n      name: \"\",\r\n      segment: \"\",\r\n      lotSize: 1,\r\n      minQty: 0,\r\n      maxQty: 0,\r\n      qtyPrecision: 2,\n      pricePrecision: 2,\n      tickSize: 0,\n      spread: 0,\n      contractSize: 1,\n      swapEnabled: false,\n      swapLong: 0,\n      swapShort: 0,\n      isActive: true,\n      isTradeable: true,\r\n    });\r\n    setOpenForm(true);\r\n  };\r\n\r\n  const openEdit = (row: any) => {\n    setForm(row);\n    setOpenForm(true);\n  };\n\n  const segmentMeta = (segment?: string) => {\n    const key = (segment || \"\").toUpperCase();\n    if (key === \"CRYPTO\") {\n      return { label: \"CRYPTO\", color: \"text-amber-600\", Icon: Bitcoin };\n    }\n    if (key === \"FOREX\") {\n      return { label: \"FOREX\", color: \"text-blue-600\", Icon: Landmark };\n    }\n    if (key === \"METAL\" || key === \"METALS\") {\n      return { label: \"METAL\", color: \"text-emerald-600\", Icon: Layers };\n    }\n    if (key === \"INDICES\" || key === \"INDEX\" || key === \"INDX\") {\n      return { label: \"INDICES\", color: \"text-purple-600\", Icon: CandlestickChart };\n    }\n    return { label: segment || \"--\", color: \"text-[var(--text-muted)]\", Icon: Layers };\n  };\n\n  const handleSave = async () => {\r\n    if (!form) return;\r\n\r\n    if (form._id) {\r\n      await updateMutation.mutateAsync({\r\n        id: form._id,\r\n        payload: form,\r\n      });\r\n    } else {\r\n      await createMutation.mutateAsync(form);\r\n    }\r\n\r\n    setOpenForm(false);\r\n    setForm(null);\r\n  };\r\n\r\n  /* ================= RENDER ================= */\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"\r\n    container-pad\r\n    space-y-8\r\n    overflow-x-hidden\r\n    max-w-6xl mx-0 md:mx-auto\r\n  \"\r\n    >\r\n\r\n      {/* HEADER */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-[15px] sm:text-2xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--primary-dark)] bg-clip-text text-transparent\">\n            Instruments Management\n          </h1>\n          <p className=\"text-[var(--text-muted)] mt-1 text-[11px] sm:text-base\">\n            Manage tradable instruments, contracts and trading rules\n          </p>\n        </div>\n\n        {!isMobile && (\n          <button\n            onClick={openCreate}\n            className=\"btn text-xs sm:text-sm border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-main)] hover:bg-[var(--hover-bg)]\"\n          >\n            Add Instrument\n          </button>\n        )}\n      </div>\n\r\n      {/* FILTERS */}\n      <div className=\"flex flex-wrap items-center\">\n        {[\n          { key: undefined, label: \"All\", Icon: Layers },\n          { key: \"CRYPTO\", label: \"Crypto\", Icon: Bitcoin },\n          { key: \"FOREX\", label: \"Forex\", Icon: Landmark },\n          { key: \"METAL\", label: \"Metal\", Icon: Layers },\n          { key: \"INDICES\", label: \"Indices\", Icon: CandlestickChart },\n        ].map((item, idx) => (\n          <button\n            key={item.label}\n            onClick={() => {\n              setSegment(item.key);\n              setPage(1);\n            }}\n            className={`px-3 py-1.5 border text-xs sm:text-sm inline-flex items-center gap-1.5 rounded-none ${\n              idx > 0 ? \"-ml-px\" : \"\"\n            } ${\n              segment === item.key\n                ? \"border-[var(--primary)] text-[var(--primary)] bg-[var(--hover-bg)] shadow-[inset_0_0_0_1px_var(--primary)]\"\n                : \"border-[var(--card-border)] text-[var(--text-muted)]\"\n            }`}\n          >\n            <item.Icon size={12} />\n            {item.label}\n          </button>\n        ))}\n      </div>\n\n      {/* SEARCH */}\n      <div\n        className=\"rounded-xl border-0 shadow-none p-0 flex items-center gap-3 sm:gap-4 bg-transparent\"\n        style={{ boxShadow: \"none\", border: \"none\", padding: 0 }}\n      >\n        <div className=\"relative w-full\">\n            <input\n              value={search}\n              onChange={(e) => {\n                setSearch(e.target.value);\n                setPage(1);\n              }}\n              placeholder=\"Search instruments...\"\n              className=\"input w-full pr-2 text-sm py-1 sm:py-2 sm:text-sm\"\n            />\n        </div>\n        <div className=\"flex items-center gap-2 ml-auto\">\n          {!isMobile && (\n            <div className=\"relative\" ref={viewBoxRef}>\n              <button\n                onClick={() => setViewOpen((v) => !v)}\n                className=\"p-2 text-[var(--text-main)] hover:text-[var(--primary)]\"\n                aria-label=\"Toggle columns\"\n              >\n                <SlidersHorizontal size={16} />\n              </button>\n              {viewOpen && (\n                <div\n                  className=\"absolute right-0 mt-2 rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] shadow-lg z-30 overflow-y-auto\"\n                  style={{ width: 240, maxHeight: \"45vh\" }}\n                >\n                  <div className=\"px-3 py-2 text-[11px] sm:text-xs text-[var(--text-muted)] border-b border-[var(--card-border)] sticky top-0 bg-[var(--card-bg)]\">\n                    Toggle columns\n                  </div>\n                  <div className=\"p-2 space-y-1\">\n                    {[\n                      { key: \"code\", label: \"Code\" },\n                      { key: \"name\", label: \"Name\" },\n                      { key: \"segment\", label: \"Segment\" },\n                      { key: \"lot\", label: \"Lot\" },\n                      { key: \"minQty\", label: \"Min Qty\" },\n                      { key: \"maxQty\", label: \"Max Qty\" },\n                      { key: \"qtyPrecision\", label: \"QTY Precision\" },\n                      { key: \"pricePrecision\", label: \"Price Precision\" },\n                      { key: \"tickSize\", label: \"Ticksize\" },\n                      { key: \"spread\", label: \"Spread\" },\n                      { key: \"swapLong\", label: \"Swap Long\" },\n                      { key: \"swapShort\", label: \"Swap Short\" },\n                      { key: \"contract\", label: \"Contract\" },\n                      { key: \"swap\", label: \"Swap\" },\n                      { key: \"tradeable\", label: \"Tradeable\" },\n                      { key: \"active\", label: \"Enable\" },\n                      { key: \"actions\", label: \"Actions\" },\n                    ].map((col) => (\n                      <label\n                        key={col.key}\n                        className=\"flex items-center gap-2 px-2 py-1 text-xs sm:text-sm cursor-pointer border-b border-[var(--card-border)] hover:bg-[var(--hover-bg)]\"\n                      >\n                        <input\n                          type=\"checkbox\"\n                          checked={visibleCols[col.key as keyof typeof visibleCols]}\n                          onChange={() =>\n                            setVisibleCols((prev) => ({\n                              ...prev,\n                              [col.key]: !prev[col.key as keyof typeof prev],\n                            }))\n                          }\n                          className=\"h-4 w-4 rounded border border-[var(--card-border)] bg-transparent accent-black\"\n                        />\n                        <span>{col.label}</span>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n          {isMobile && (\n            <button\n              onClick={openCreate}\n              className=\"btn flex items-center justify-center border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-main)] hover:bg-[var(--hover-bg)]\"\n              aria-label=\"Add Instrument\"\n            >\n              <Plus size={18} />\n            </button>\n          )}\n        </div>\n      </div>\n\r\n      {/* TABLE */}\r\n      <div\n        className=\"rounded-xl border-0 bg-[var(--card-bg)] shadow-none overflow-hidden p-0\"\n        style={{ boxShadow: \"none\", padding: 0 }}\n      >\n        <div className=\"relative overflow-x-auto overscroll-x-contain hidden md:block\">\n\n          <table className=\"table w-max min-w-[1500px]\">\n            <thead>\n              <tr>\n                {visibleCols.code && <th>Code</th>}\n                {visibleCols.name && <th>Name</th>}\n                {visibleCols.segment && <th>Segment</th>}\n                {visibleCols.lot && <th>Lot</th>}\n                {visibleCols.minQty && <th>Min Qty</th>}\n                {visibleCols.maxQty && <th>Max Qty</th>}\n                {visibleCols.qtyPrecision && <th>QTY Precision</th>}\n                {visibleCols.pricePrecision && <th>Price Precision</th>}\n                {visibleCols.tickSize && <th>Ticksize</th>}\n                {visibleCols.spread && <th>Spread</th>}\n                {visibleCols.swapLong && <th>Swap Long</th>}\n                {visibleCols.swapShort && <th>Swap Short</th>}\n                {visibleCols.contract && <th>Contract</th>}\n                {visibleCols.swap && <th>Swap</th>}\n                {visibleCols.tradeable && <th>Tradeable</th>}\n                {visibleCols.active && <th>Enable</th>}\n                {visibleCols.actions && <th className=\"text-center\">Actions</th>}\n              </tr>\n            </thead>\n\r\n            <tbody>\r\n              <AnimatePresence>\r\n                {isLoading ? (\n                  <tr>\n                    <td\n                      colSpan={Object.values(visibleCols).filter(Boolean).length}\n                      className=\"py-12 text-center\"\n                    >\n                      <GlobalLoader />\n                    </td>\n                  </tr>\n                ) : instruments.length === 0 ? (\n                  <tr>\n                    <td\n                      colSpan={Object.values(visibleCols).filter(Boolean).length}\n                      className=\"py-16 text-center\"\n                    >\n                      <div className=\"text-[var(--text-muted)]\">\n                        No instruments found\n                      </div>\n                    </td>\n                  </tr>\n                ) : (\n                  instruments.map((row: any, idx: number) => (\n                    <motion.tr\n                      key={row._id}\r\n                      initial={{ opacity: 0, x: 20 }}\r\n                      animate={{ opacity: 1, x: 0 }}\r\n                      transition={{ delay: idx * 0.03 }}\r\n                      className=\"group\"\r\n                    >\r\n                      {visibleCols.code && <td className=\"font-mono\">{row.code}</td>}\n                      {visibleCols.name && <td className=\"font-medium\">{row.name}</td>}\n                      {visibleCols.segment && (\n                        <td>\n                          {(() => {\n                            const meta = segmentMeta(row.segment);\n                            return (\n                              <span className={`inline-flex items-center gap-1.5 rounded-full border border-[var(--card-border)] px-2 py-0.5 text-xs font-medium ${meta.color}`}>\n                                <meta.Icon size={12} />\n                                {meta.label}\n                              </span>\n                            );\n                          })()}\n                        </td>\n                      )}\n                      {visibleCols.lot && <td>{row.lotSize}</td>}\n                      {visibleCols.minQty && <td>{row.minQty}</td>}\n                      {visibleCols.maxQty && <td>{row.maxQty}</td>}\n                      {visibleCols.qtyPrecision && <td>{row.qtyPrecision}</td>}\n                      {visibleCols.pricePrecision && <td>{row.pricePrecision}</td>}\n                      {visibleCols.tickSize && <td>{row.tickSize}</td>}\n                      {visibleCols.spread && <td>{row.spread}</td>}\n                      {visibleCols.swapLong && <td>{row.swapLong}</td>}\n                      {visibleCols.swapShort && <td>{row.swapShort}</td>}\n                      {visibleCols.contract && <td>{row.contractSize}</td>}\n                      {visibleCols.swap && (\n                        <td>\n                          <span\n                            className={\n                              row.swapEnabled ? \"text-green-700\" : \"text-red-700\"\n                            }\n                          >\n                            {row.swapEnabled ? \"Enabled\" : \"Disabled\"}\n                          </span>\n                        </td>\n                      )}\n                      {visibleCols.tradeable && (\n                        <td>\n                          <span\n                            className={\n                              row.isTradeable ? \"text-green-700\" : \"text-red-700\"\n                            }\n                          >\n                            {row.isTradeable ? \"True\" : \"False\"}\n                          </span>\n                        </td>\n                      )}\n                      {visibleCols.active && (\n                        <td>\n                          <span\n                            className={\n                              row.isActive ? \"text-green-700\" : \"text-red-700\"\n                            }\n                          >\n                            {row.isActive ? \"True\" : \"False\"}\n                          </span>\n                        </td>\n                      )}\n                      {visibleCols.actions && (\n                        <td className=\"text-center\">\n                          <div className=\"flex justify-center gap-2\">\n                            <button\n                              onClick={() => openEdit(row)}\n                              className=\"btn p-2\"\n                            >\n                              <Pencil size={14} />\n                            </button>\n                            <button\n                              onClick={() => {\n                                setSelectedId(row._id);\n                                setConfirmOpen(true);\n                              }}\n                              className=\"btn p-2 text-red-500\"\n                            >\n                              <Trash2 size={14} />\n                            </button>\n                          </div>\n                        </td>\n                      )}\n                    </motion.tr>\n                  ))\n                )}\n              </AnimatePresence>\r\n            </tbody>\r\n          </table>\n        </div>\n\n        {/* MOBILE LIST */}\n        <div className=\"md:hidden p-0 space-y-3 text-[11px]\">\n          {isLoading ? (\n            <div className=\"py-10\">\n              <GlobalLoader />\n            </div>\n          ) : instruments.length === 0 ? (\n            <div className=\"py-10 text-center text-[var(--text-muted)]\">\n              No instruments found\n            </div>\n          ) : (\n            instruments.map((row: any) => (\n              <div\n                key={row._id}\n                className=\"w-full rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-3 shadow-none relative overflow-hidden\"\n              >\n                <div\n                  className=\"pointer-events-none absolute inset-0 rounded-2xl animate-pulse\"\n                  style={{\n                    background:\n                      \"radial-gradient(120% 120% at 0% 0%, rgba(59,130,246,0.10), transparent 60%)\",\n                    animationDuration: \"3s\",\n                  }}\n                />\n                <div className=\"relative space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-semibold text-[12px]\">{row.code}</div>\n                      <div className=\"text-[10px] text-[var(--text-muted)]\">\n                        {row.name}\n                      </div>\n                    </div>\n                    {(() => {\n                      const meta = segmentMeta(row.segment);\n                      return (\n                        <span className={`inline-flex items-center gap-1.5 rounded-full border border-[var(--card-border)] px-2 py-0.5 text-[10px] font-medium ${meta.color}`}>\n                          <meta.Icon size={12} />\n                          {meta.label}\n                        </span>\n                      );\n                    })()}\n                  </div>\n\n                  <div className=\"grid grid-cols-2 gap-x-3 gap-y-1 text-[10px]\">\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Lot</span><span className=\"font-medium\">{row.lotSize}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Min Qty</span><span className=\"font-medium\">{row.minQty}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Max Qty</span><span className=\"font-medium\">{row.maxQty}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Qty Prec</span><span className=\"font-medium\">{row.qtyPrecision}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Price Prec</span><span className=\"font-medium\">{row.pricePrecision}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Tick</span><span className=\"font-medium\">{row.tickSize}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Spread</span><span className=\"font-medium\">{row.spread}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Contract</span><span className=\"font-medium\">{row.contractSize}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Swap Long</span><span className=\"font-medium\">{row.swapLong}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Swap Short</span><span className=\"font-medium\">{row.swapShort}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Swap</span><span className=\"font-medium\">{row.swapEnabled ? \"Enabled\" : \"Disabled\"}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Tradeable</span><span className=\"font-medium\">{row.isTradeable ? \"Yes\" : \"No\"}</span></div>\n                    <div className=\"flex justify-between\"><span className=\"text-[var(--text-muted)]\">Active</span><span className=\"font-medium\">{row.isActive ? \"Yes\" : \"No\"}</span></div>\n                  </div>\n\n                  <div className=\"flex items-center gap-2 pt-1\">\n                    <button onClick={() => openEdit(row)} className=\"btn p-2\">\n                      <Pencil size={14} />\n                    </button>\n                    <button\n                      onClick={() => {\n                        setSelectedId(row._id);\n                        setConfirmOpen(true);\n                      }}\n                      className=\"btn p-2 text-red-500\"\n                    >\n                      <Trash2 size={14} />\n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\r\n      {/* PAGINATION */}\r\n      <Pagination\r\n        page={page}\r\n        totalPages={totalPages}\r\n        limit={limit}\r\n        onPageChange={setPage}\r\n        onLimitChange={(l) => {\r\n          setLimit(l);\r\n          setPage(1);\r\n        }}\r\n      />\r\n\r\n      {/* FORM MODAL */}\r\n      <AnimatePresence>\r\n        {openForm && form && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4\"\n            onClick={() => setOpenForm(false)}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0, y: 20 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.9, opacity: 0, y: 20 }}\n              onClick={(e) => e.stopPropagation()}\n              className=\"card-elevated shadow-none w-full max-w-3xl max-h-[90vh] overflow-y-auto\"\n              style={{ boxShadow: \"none\" }}\n            >\n              <div className=\"flex items-center justify-between p-6 border-b\">\r\n                <h3 className=\"text-xl font-bold\">\r\n                  {form._id ? \"Edit Instrument\" : \"Add Instrument\"}\r\n                </h3>\r\n                <button onClick={() => setOpenForm(false)}>\r\n                  <X size={18} />\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"w-full space-y-1\" ref={symbolBoxRef}>\n                  <label className=\"text-sm font-medium text-[var(--text-muted)] flex items-center gap-2\">\n                    <Hash size={14} className=\"text-[var(--text-muted)]\" />\n                    Code\n                  </label>\n                  <div className=\"relative\">\n                    <div\n                      className={`flex items-center gap-2 rounded-lg border px-3 py-2\n                      bg-[var(--input-bg)]\n                      border-[var(--input-border)]\n                      focus-within:border-[var(--primary)]\n                      focus-within:shadow-[0_0_0_3px_var(--glow)]\n                      transition`}\n                    >\n                      <Hash size={18} className=\"text-[var(--text-muted)] shrink-0\" />\n                      <input\n                        type=\"text\"\n                        value={form.code}\n                        placeholder=\"Search code...\"\n                        onFocus={() => setSymbolOpen(true)}\n                        onChange={(e) =>\n                          setForm({ ...form, code: e.target.value })\n                        }\n                        className=\"w-full bg-transparent outline-none text-sm text-[var(--foreground)]\n                        placeholder:text-[var(--text-muted)]\"\n                      />\n                    </div>\n\n                    {symbolOpen && (\n                      <div className=\"absolute left-0 right-0 top-full mt-1.5 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] max-h-60 overflow-auto z-50\">\n                        {symbolLoading ? (\n                          <div className=\"px-3 py-2 text-xs text-[var(--text-muted)]\">\n                            Searching...\n                          </div>\n                        ) : symbolResults.length === 0 ? (\n                          <div className=\"px-3 py-2 text-xs text-[var(--text-muted)]\">\n                            No results\n                          </div>\n                        ) : (\n                          symbolResults.map((item) => (\n                            <button\n                              key={item._id}\n                              onClick={() => {\n                                setForm((prev) => {\n                                  if (!prev) return prev;\n                                  const nextSegment =\n                                    prev.segment ||\n                                    (item.category === \"FX\"\n                                      ? \"FOREX\"\n                                      : item.category === \"INDEXES\"\n                                      ? \"INDICES\"\n                                      : item.category || \"\");\n                                  return {\n                                    ...prev,\n                                    code: item.code,\n                                    name: prev.name || item.name,\n                                    segment: nextSegment,\n                                  };\n                                });\n                                setSymbolOpen(false);\n                              }}\n                              className=\"w-full text-left px-3 py-2 hover:bg-[var(--hover-bg)] flex items-center justify-between gap-2\"\n                            >\n                              <span className=\"flex flex-col min-w-0\">\n                                <span className=\"text-sm font-semibold\">\n                                  {item.code}\n                                </span>\n                                <span className=\"text-[11px] text-[var(--text-muted)] truncate\">\n                                  {item.name}\n                                </span>\n                              </span>\n                              {item.category && (\n                                <span className=\"text-[10px] text-[var(--text-muted)]\">\n                                  {item.category}\n                                </span>\n                              )}\n                            </button>\n                          ))\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <PremiumInput label=\"Name\" icon={Type} value={form.name} onChange={(v) => setForm({ ...form, name: v })} />\n                <PremiumInput label=\"Segment\" icon={Layers} value={form.segment} onChange={(v) => setForm({ ...form, segment: v })} />\n                <PremiumInput label=\"Lot Size\" icon={Boxes} type=\"number\" value={form.lotSize} onChange={(v) => setForm({ ...form, lotSize: Number(v) })} />\n                <PremiumInput label=\"Min Qty\" icon={ArrowDownToLine} type=\"number\" value={form.minQty} onChange={(v) => setForm({ ...form, minQty: Number(v) })} />\n                <PremiumInput label=\"Max Qty\" icon={ArrowUpToLine} type=\"number\" value={form.maxQty} onChange={(v) => setForm({ ...form, maxQty: Number(v) })} />\n                <PremiumInput\n                  label=\"Qty Precision\"\n                  type=\"number\"\n                  icon={Sigma}\n                  value={form.qtyPrecision}\n                  onChange={(v) => setForm({ ...form, qtyPrecision: Number(v) })}\n                />\n\n                <PremiumInput\n                  label=\"Price Precision\"\n                  type=\"number\"\n                  icon={DollarSign}\n                  value={form.pricePrecision}\n                  onChange={(v) => setForm({ ...form, pricePrecision: Number(v) })}\n                />\n\n                <PremiumInput\n                  label=\"Tick Size\"\n                  type=\"number\"\n                  icon={MoveHorizontal}\n                  value={form.tickSize ?? 0}\n                  onChange={(v) =>\n                    setForm({ ...form, tickSize: v ? Number(v) : null })\n                  }\n                />\n\n                <PremiumInput\n                  label=\"Spread\"\n                  type=\"number\"\n                  icon={MoveHorizontal}\n                  value={form.spread}\n                  onChange={(v) => setForm({ ...form, spread: Number(v) })}\n                />\n\n                <PremiumInput\n                  label=\"Contract Size\"\n                  type=\"number\"\n                  icon={Package}\n                  value={form.contractSize}\n                  onChange={(v) => setForm({ ...form, contractSize: Number(v) })}\n                />\n\n                <PremiumInput\n                  label=\"Swap Long\"\n                  type=\"number\"\n                  icon={ArrowUpRight}\n                  value={form.swapLong}\n                  onChange={(v) => setForm({ ...form, swapLong: Number(v) })}\n                />\n\n                <PremiumInput\n                  label=\"Swap Short\"\n                  type=\"number\"\n                  icon={ArrowDownRight}\n                  value={form.swapShort}\n                  onChange={(v) => setForm({ ...form, swapShort: Number(v) })}\n                />\n\n\n                <Toggle label={<span className=\"inline-flex items-center gap-2\"><ToggleRight size={14} /> Swap Enabled</span>} value={form.swapEnabled} onChange={(v) => setForm({ ...form, swapEnabled: v })} />\n                <Toggle label={<span className=\"inline-flex items-center gap-2\"><BadgeCheck size={14} /> Tradeable</span>} value={form.isTradeable} onChange={(v) => setForm({ ...form, isTradeable: v })} />\n                <Toggle label={<span className=\"inline-flex items-center gap-2\"><Power size={14} /> Active</span>} value={form.isActive} onChange={(v) => setForm({ ...form, isActive: v })} />\n              </div>\r\n\r\n              <div className=\"p-6 border-t flex gap-3 justify-end\">\r\n                <button\r\n                  onClick={() => setOpenForm(false)}\r\n                  className=\"btn btn-ghost\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleSave}\r\n                  className=\"btn btn-primary\"\r\n                >\r\n                  {form._id ? \"Update\" : \"Create\"}\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {confirmOpen && selectedId && (\r\n        <ConfirmModal\r\n          title=\"Delete Instrument\"\r\n          description=\"Are you sure you want to delete this instrument? This action cannot be undone.\"\r\n          loading={deleteMutation.isPending}\r\n          onCancel={() => {\r\n            setConfirmOpen(false);\r\n            setSelectedId(null);\r\n          }}\r\n          onConfirm={async () => {\r\n            await deleteMutation.mutateAsync(selectedId);\r\n            setConfirmOpen(false);\r\n            setSelectedId(null);\r\n          }}\r\n        />\r\n      )}\r\n\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\instruments\\market-settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmModal' is defined but never used.","line":11,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Toggle' is defined but never used.","line":13,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[802,805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[802,805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Pencil, Bitcoin, Landmark, Layers, CandlestickChart } from \"lucide-react\";\n\r\nimport { useMarketSchedule } from \"@/queries/marketSchedule.queries\";\r\nimport { MarketSegment } from \"@/services/marketSchedule.service\";\r\n\r\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\r\nimport ConfirmModal from \"../../components/ui/ConfirmModal\";\r\nimport { Toast } from \"../../components/ui/Toast\";\r\nimport Toggle from \"../../components/ui/Toggle\";\r\nimport MarketScheduleEditModal from \"../../components/market-setting/MarketScheduleEditModal\";\r\n\r\n\r\nconst SEGMENTS: MarketSegment[] = [\"forex\", \"metal\", \"crypto\", \"indexes\"];\n\nconst SEGMENT_META: Record<MarketSegment, { label: string; color: string; Icon: any }> = {\n  forex: { label: \"Forex\", color: \"text-blue-600\", Icon: Landmark },\n  metal: { label: \"Metal\", color: \"text-emerald-600\", Icon: Layers },\n  crypto: { label: \"Crypto\", color: \"text-amber-600\", Icon: Bitcoin },\n  indexes: { label: \"Indices\", color: \"text-purple-600\", Icon: CandlestickChart },\n};\n\r\nexport default function MarketSchedulePage() {\r\n  const [segment, setSegment] = useState<MarketSegment>(\"forex\");\r\n  const [editOpen, setEditOpen] = useState(false);\r\n  const [toast, setToast] = useState(\"\");\r\n\r\n  const scheduleQuery = useMarketSchedule(segment);\r\n  const data = scheduleQuery.data;\r\n\r\n  if (scheduleQuery.isLoading) {\r\n    return <div className=\"py-20 flex justify-center\"><GlobalLoader /></div>;\r\n  }\r\n\r\n  if (!data) {\r\n    return <div className=\"py-10 text-center text-[var(--danger)]\">No schedule found</div>;\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"container-pad max-w-6xl mx-auto space-y-6\"\r\n    >\r\n      {/* HEADER */}\r\n      <div>\n        <h1 className=\"text-[15px] sm:text-3xl font-bold\">Market Schedule</h1>\n        <p className=\"text-[11px] sm:text-base text-[var(--text-muted)]\">\n          Segment wise market configuration\n        </p>\n      </div>\n\n      {/* SEGMENTS */}\n      <div className=\"flex flex-wrap items-center\">\n        {SEGMENTS.map((s, idx) => {\n          const meta = SEGMENT_META[s];\n          return (\n            <button\n              key={s}\n              onClick={() => setSegment(s)}\n              className={`px-3 py-1.5 border text-xs sm:text-sm inline-flex items-center gap-1.5 rounded-none ${\n                idx > 0 ? \"-ml-px\" : \"\"\n              } ${\n              segment === s\n                  ? \"border-[var(--primary)] text-[var(--primary)] bg-[var(--hover-bg)]\"\n                  : \"border-[var(--card-border)] text-[var(--text-muted)]\"\n            }`}\n            >\n              <meta.Icon size={12} className={meta.color} />\n              {meta.label}\n            </button>\n          );\n        })}\n      </div>\n\r\n      {/* SUMMARY CARD */}\r\n      <div className=\"card-elevated space-y-4 shadow-none\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-sm sm:text-lg\">Current Configuration</h3>\n\n          <button\n            onClick={() => setEditOpen(true)}\n            className=\"btn btn-primary\"\n          >\n            <Pencil size={16} />\n            Edit\n          </button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm\">\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Open Time</span>\n            <span className=\"font-medium\">{data.openTime}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Close Time</span>\n            <span className=\"font-medium\">{data.closeTime}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Timezone</span>\n            <span className=\"font-medium\">{data.timezone}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Weekly Off</span>\n            <span className=\"font-medium\">{data.weeklyOff.join(\", \") || \"-\"}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Holidays</span>\n            <span className=\"font-medium\">{data.holidays.join(\", \") || \"-\"}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2\">\n            <span className=\"text-[var(--text-muted)]\">Saturday Close</span>\n            <span className=\"font-medium\">{data.dayOverrides?.SATURDAY?.closeTime || \"-\"}</span>\n          </div>\n          <div className=\"flex justify-between border-b border-[var(--card-border)] py-2 md:col-span-2\">\n            <span className=\"text-[var(--text-muted)]\">Date Overrides</span>\n            <span className=\"font-medium\">\n              {data.dateOverrides ? JSON.stringify(data.dateOverrides) : \"-\"}\n            </span>\n          </div>\n          <div className=\"flex justify-between py-2\">\n            <span className=\"text-[var(--text-muted)]\">Status</span>\n            <span className={data.isEnabled ? \"text-green-700\" : \"text-red-700\"}>\n              {data.isEnabled ? \"Enabled\" : \"Disabled\"}\n            </span>\n          </div>\n        </div>\n      </div>\n\r\n      {/* EDIT MODAL */}\r\n      {editOpen && (\r\n        <MarketScheduleEditModal\r\n          segment={segment}\r\n          data={data}\r\n          onClose={() => setEditOpen(false)}\r\n          onSaved={() => {\r\n            setEditOpen(false);\r\n            setToast(\"Market schedule updated\");\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {toast && <Toast message={toast} />}\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\instruments\\market-watch\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PriceDirection' is defined but never used.","line":28,"column":6,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useState, useEffect, useRef, Fragment } from \"react\";\nimport {\n  Trash2,\n  Search,\n  SlidersHorizontal,\n  ArrowUpRight,\n  ArrowDownRight,\n  Minus,\n} from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useLiveQuotesBySymbols } from \"@/hooks/useLiveQuotesBySymbols\";\nimport { searchInstruments } from \"@/services/instrument.service\";\n\nimport {\n  useDefaultWatchlist,\n  useAddDefaultWatchlist,\n  useRemoveDefaultWatchlist,\n} from \"@/queries/defaultWatchlist.queries\";\n\nimport Pagination from \"../../components/ui/pagination\";\nimport ConfirmModal from \"../../components/ui/ConfirmModal\";\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\nimport { getAccessTokenFromCookie } from \"@/services/marketSocket.service\";\n\n\ntype PriceDirection = \"up\" | \"down\" | \"same\";\n\nfunction splitPrice(price: string) {\n  const [intPart, decimalPart = \"\"] = price.split(\".\");\n\n  if (decimalPart.length <= 2) {\n    return { int: intPart, big: decimalPart.padEnd(2, \"0\") };\n  }\n\n  return {\n    int: intPart,\n    big: decimalPart.slice(0, 2),\n    small: decimalPart.slice(2, 3),\n  };\n}\n\nfunction toNumber(value?: string | number) {\n  if (value === undefined || value === null) return null;\n  if (value === \"--\") return null;\n  const n = Number(value);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction formatSigned(value: number, digits = 2) {\n  const sign = value > 0 ? \"+\" : value < 0 ? \"-\" : \"\";\n  return `${sign}${Math.abs(value).toFixed(digits)}`;\n}\n\nfunction calcSpread(bid?: string, ask?: string) {\n  if (!bid || !ask || bid === \"--\" || ask === \"--\") return \"--\";\n\n  const b = bid.split(\".\")[1] ?? \"0\";\n  const a = ask.split(\".\")[1] ?? \"0\";\n\n  return Math.abs(Number(b) - Number(a)).toString().padStart(2, \"0\");\n}\n\nexport default function MarketWatch() {\n  const token = getAccessTokenFromCookie();\n  const [search, setSearch] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(10);\n\n  const [confirmOpen, setConfirmOpen] = useState(false);\n  const [selectedCode, setSelectedCode] = useState<string | null>(null);\n  const [searchResults, setSearchResults] = useState<\n    { code: string; name: string }[]\n  >([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchOpen, setSearchOpen] = useState(false);\n  const searchBoxRef = useRef<HTMLDivElement | null>(null);\n  const [viewOpen, setViewOpen] = useState(false);\n  const viewBoxRef = useRef<HTMLDivElement | null>(null);\n\n  const [visibleCols, setVisibleCols] = useState({\n    code: true,\n    bid: true,\n    ask: true,\n    open: true,\n    chg: true,\n    lowHigh: true,\n    spread: true,\n    remove: true,\n  });\n\n  const listQuery = useDefaultWatchlist();\n  const addMutation = useAddDefaultWatchlist();\n  const removeMutation = useRemoveDefaultWatchlist();\n\n  const rows = listQuery.data?.data ?? [];\n\n  const totalPages = Math.max(1, Math.ceil(rows.length / limit));\n\n  const paginated = rows.slice((page - 1) * limit, page * limit);\n\n  /* ðŸ”´ LIVE DATA */\n  const symbols = rows.map((r) => r.code);\n  const liveQuotes = useLiveQuotesBySymbols(token, symbols);\n\n  useEffect(() => {\n    let active = true;\n    const handler = setTimeout(async () => {\n      const q = search.trim();\n      if (!q) {\n        setSearchResults([]);\n        setIsSearching(false);\n        return;\n      }\n      setIsSearching(true);\n      try {\n        const data = await searchInstruments({\n          q,\n          limit: 20,\n        });\n        if (active) setSearchResults(data);\n      } finally {\n        if (active) setIsSearching(false);\n      }\n    }, 350);\n\n    return () => {\n      active = false;\n      clearTimeout(handler);\n    };\n  }, [search]);\n\n  useEffect(() => {\n    const onClick = (e: Event) => {\n      const target = e.target as Node;\n      const path = (e as Event & { composedPath?: () => EventTarget[] }).composedPath?.();\n\n      const isInsideSearch =\n        !!searchBoxRef.current &&\n        (searchBoxRef.current.contains(target) ||\n          (path && path.includes(searchBoxRef.current)));\n      const isInsideView =\n        !!viewBoxRef.current &&\n        (viewBoxRef.current.contains(target) ||\n          (path && path.includes(viewBoxRef.current)));\n\n      if (!isInsideSearch) setSearchOpen(false);\n      if (!isInsideView) setViewOpen(false);\n    };\n\n    document.addEventListener(\"mousedown\", onClick, true);\n    document.addEventListener(\"touchstart\", onClick, true);\n    return () => {\n      document.removeEventListener(\"mousedown\", onClick, true);\n      document.removeEventListener(\"touchstart\", onClick, true);\n    };\n  }, []);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"container-pad space-y-4 sm:space-y-5 max-w-6xl mx-0 md:mx-auto\"\n    >\n      {/* HEADER */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-3\">\n        <div>\n          <h1 className=\"text-xs sm:text-lg font-semibold\">Default Watchlist</h1>\n          <p className=\"text-[var(--text-muted)] mt-1 text-[10px] sm:text-sm\">\n            Manage symbols shown for all users\n          </p>\n        </div>\n      </div>\n\n      {/* SEARCH + VIEW */}\n      <div className=\"flex flex-row items-center gap-2\">\n        <div className=\"relative flex-1\" ref={searchBoxRef}>\n          <div className=\"flex items-center\">\n            <input\n              value={search}\n              onFocus={() => setSearchOpen(true)}\n              onChange={(e) => {\n                setSearch(e.target.value);\n                setSearchOpen(true);\n              }}\n              placeholder=\"Search symbol...\"\n              className=\"w-full rounded-xl bg-[var(--card-bg)] px-3 py-2 text-xs sm:text-sm text-[var(--text-main)] placeholder:text-[var(--text-muted)] border border-[var(--card-border)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/20\"\n            />\n          </div>\n\n          {searchOpen && search.trim().length > 0 && (\n            <div className=\"absolute left-0 right-0 top-full mt-1.5 border border-[var(--card-border)] rounded-lg bg-[var(--card-bg)] max-h-52 sm:max-h-64 overflow-auto z-20\">\n              {isSearching ? (\n                <div className=\"px-3 py-2 text-[11px] sm:text-xs text-[var(--text-muted)]\">\n                  Searching...\n                </div>\n              ) : searchResults.length === 0 ? (\n                <div className=\"px-3 py-2 text-[11px] sm:text-xs text-[var(--text-muted)]\">\n                  No results\n                </div>\n              ) : (\n                searchResults.map((item) => {\n                  const alreadyAdded = rows.some((r) => r.code === item.code);\n                  return (\n                    <button\n                      key={item.code}\n                      onClick={async () => {\n                        if (!alreadyAdded) {\n                          await addMutation.mutateAsync(item.code);\n                        }\n                        setSearch(\"\");\n                        setSearchResults([]);\n                        setSearchOpen(false);\n                      }}\n                      className=\"w-full flex items-center justify-between gap-2 px-3 py-1.5 text-left hover:bg-[var(--hover-bg)]\"\n                      aria-disabled={alreadyAdded}\n                    >\n                      <span className=\"flex flex-col min-w-0\">\n                        <span className=\"text-xs sm:text-sm font-semibold\">\n                          {item.code}\n                        </span>\n                        <span className=\"text-[10px] sm:text-xs text-[var(--text-muted)] truncate\">\n                          {item.name}\n                        </span>\n                      </span>\n                      {alreadyAdded ? (\n                        <span className=\"text-[10px] text-[var(--text-muted)]\">\n                          Added\n                        </span>\n                      ) : (\n                        <span className=\"h-5 w-5 rounded-full border border-black/20 text-black text-[12px] leading-[18px] text-center\">\n                          +\n                        </span>\n                      )}\n                    </button>\n                  );\n                })\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"relative\" ref={viewBoxRef}>\n          <button\n            onClick={() => setViewOpen((v) => !v)}\n            className=\"p-2 text-[var(--text-main)] hover:text-[var(--primary)]\"\n            aria-label=\"Toggle columns\"\n          >\n            <SlidersHorizontal size={16} />\n          </button>\n\n          {viewOpen && (\n            <>\n              <button\n                type=\"button\"\n                className=\"fixed inset-0 z-20 cursor-default\"\n                onClick={() => setViewOpen(false)}\n                aria-label=\"Close columns menu\"\n              />\n              <div className=\"absolute right-0 mt-2 w-52 rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] shadow-lg z-30\">\n                <div className=\"px-3 py-2 text-[11px] sm:text-xs text-[var(--text-muted)] border-b border-[var(--card-border)]\">\n                  Toggle columns\n                </div>\n                <div className=\"p-2 space-y-1\">\n                  {[\n                    { key: \"code\", label: \"Code\" },\n                    { key: \"bid\", label: \"Bid\" },\n                    { key: \"ask\", label: \"Ask\" },\n                    { key: \"open\", label: \"Open\" },\n                    { key: \"chg\", label: \"Chg\" },\n                    { key: \"lowHigh\", label: \"Low / High\" },\n                    { key: \"spread\", label: \"Spread\" },\n                    { key: \"remove\", label: \"Remove\" },\n                  ].map((col) => (\n                  <label\n                    key={col.key}\n                    className=\"flex items-center gap-2 px-2 py-1 text-xs sm:text-sm cursor-pointer border-b border-[var(--card-border)] hover:bg-[var(--hover-bg)]\"\n                  >\n                    <input\n                      type=\"checkbox\"\n                      checked={visibleCols[col.key as keyof typeof visibleCols]}\n                      onChange={() =>\n                        setVisibleCols((prev) => ({\n                          ...prev,\n                          [col.key]: !prev[col.key as keyof typeof prev],\n                        }))\n                      }\n                      className=\"h-4 w-4 rounded border border-[var(--card-border)] bg-transparent accent-black\"\n                    />\n                    <span>{col.label}</span>\n                  </label>\n                  ))}\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* TABLE */}\n      <div className=\"card overflow-hidden shadow-none p-0 border-0\">\n        <div className=\"relative overflow-x-auto sm:overflow-visible\">\n          <table className=\"table w-full text-[9px] sm:text-[13px] p-0\">\n            <thead style={{ background: \"transparent\" }}>\n  <tr>\n    {visibleCols.code && (\n      <th className=\"py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Code</th>\n    )}\n    {visibleCols.bid && (\n      <th className=\"text-right py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Bid</th>\n    )}\n    {visibleCols.ask && (\n      <th className=\"text-right py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Ask</th>\n    )}\n    {visibleCols.open && (\n      <th className=\"text-right py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Open</th>\n    )}\n    {visibleCols.chg && (\n      <th className=\"text-right py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Chg</th>\n    )}\n    {visibleCols.lowHigh && (\n      <th className=\"text-center py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Low</th>\n    )}\n    {visibleCols.lowHigh && (\n      <th className=\"text-center py-0.5 px-0.5 text-[9px] sm:text-[12px]\">High</th>\n    )}\n    {visibleCols.spread && (\n      <th className=\"text-center py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Spread</th>\n    )}\n    {visibleCols.remove && (\n      <th className=\"text-center py-0.5 px-0.5 text-[9px] sm:text-[12px]\">Remove</th>\n    )}\n  </tr>\n</thead>\n\n\n           <tbody>\n  <AnimatePresence>\n    {listQuery.isLoading ? (\n      <tr>\n        <td\n          colSpan={Object.values(visibleCols).filter(Boolean).length}\n          className=\"py-12 text-center\"\n        >\n          <GlobalLoader />\n        </td>\n      </tr>\n    ) : paginated.length === 0 ? (\n      <tr>\n        <td\n          colSpan={Object.values(visibleCols).filter(Boolean).length}\n          className=\"py-12 text-center text-muted\"\n        >\n          No symbols found\n        </td>\n      </tr>\n    ) : (\n      paginated.map((row, idx) => {\n        const live = liveQuotes[row.code];\n\n        const bid = splitPrice(live?.bid ?? \"--\");\n        const ask = splitPrice(live?.ask ?? \"--\");\n        const spread = calcSpread(live?.bid, live?.ask);\n        const current = toNumber(live?.bid ?? live?.ask);\n        const open = toNumber(live?.open);\n        const delta = current !== null && open !== null ? current - open : null;\n        const pct =\n          current !== null && open !== null && open !== 0\n            ? ((current - open) / open) * 100\n            : null;\n\n        const bidColor =\n          live?.bidDir === \"up\"\n            ? \"text-blue-600\"\n            : live?.bidDir === \"down\"\n            ? \"text-red-600\"\n            : \"text-[var(--text-main)]\";\n\n        const askColor =\n          live?.askDir === \"up\"\n            ? \"text-blue-600\"\n            : live?.askDir === \"down\"\n            ? \"text-red-600\"\n            : \"text-[var(--text-main)]\";\n\n        return (\n          <Fragment key={row.code}>\n            <motion.tr\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: idx * 0.03 }}\n              className={`hover:bg-[var(--hover-bg)] ${\n                delta === null\n                  ? \"\"\n                  : delta > 0\n                  ? \"bg-gradient-to-r from-emerald-500/10 via-transparent to-transparent\"\n                  : delta < 0\n                  ? \"bg-gradient-to-r from-red-500/10 via-transparent to-transparent\"\n                  : \"\"\n              }`}\n            >\n            {/* CODE + NAME */}\n            {visibleCols.code && (\n              <td className=\"font-mono font-semibold py-0.5 px-0.5\">\n                <div className=\"flex flex-col\">\n                  <span className=\"text-[11px] sm:text-[12px]\">{row.code}</span>\n                  <span className=\"text-[8px] sm:text-[11px] font-normal text-[var(--text-muted)] truncate\">\n                    {row.name}\n                  </span>\n                </div>\n              </td>\n            )}\n\n\n            {/* BID */}\n            {visibleCols.bid && (\n              <td className=\"text-right py-0.5 px-0.5\">\n                <div className={`font-semibold ${bidColor} text-[10px] sm:text-[14px]`}>\n                  {bid.int}.\n                  <span className=\"text-[10px] sm:text-[15px]\">{bid.big}</span>\n                  {bid.small && (\n                    <sup className=\"text-[8px] sm:text-[12px] relative top-[-5px]\">\n                      {bid.small}\n                    </sup>\n                  )}\n                </div>\n                <div className=\"text-[8px] sm:text-[11px] text-muted hidden sm:block\">\n                  {live?.bidVolume ?? \"--\"}\n                </div>\n              </td>\n            )}\n\n            {/* ASK */}\n            {visibleCols.ask && (\n              <td className=\"text-right py-0.5 px-0.5\">\n                <div className={`font-semibold ${askColor} text-[10px] sm:text-[14px]`}>\n                  {ask.int}.\n                  <span className=\"text-[10px] sm:text-[15px]\">{ask.big}</span>\n                  {ask.small && (\n                    <sup className=\"text-[8px] sm:text-[12px] relative top-[-5px]\">\n                      {ask.small}\n                    </sup>\n                  )}\n                </div>\n                <div className=\"text-[8px] sm:text-[11px] text-muted hidden sm:block\">\n                  {live?.askVolume ?? \"--\"}\n                </div>\n              </td>\n            )}\n\n            {/* OPEN */}\n            {visibleCols.open && (\n              <td className=\"text-right py-0.5 px-0.5\">\n                <div className=\"font-semibold text-[10px] sm:text-[14px]\">\n                  {open === null ? \"--\" : open.toFixed(2)}\n                </div>\n              </td>\n            )}\n\n            {/* CHANGE */}\n            {visibleCols.chg && (\n              <td className=\"text-right py-0.5 px-0.5\">\n                <div\n                  className={`font-semibold text-[10px] sm:text-[14px] ${\n                    delta === null\n                      ? \"text-[var(--text-muted)]\"\n                      : delta > 0\n                      ? \"text-blue-600\"\n                      : delta < 0\n                      ? \"text-red-600\"\n                      : \"text-[var(--text-main)]\"\n                  }`}\n                >\n                  {delta === null ? \"--\" : formatSigned(delta, 2)}\n                </div>\n                <div className=\"text-[8px] sm:text-[11px] text-muted flex items-center justify-end gap-1\">\n                  {pct === null ? (\n                    \"--\"\n                  ) : (\n                    <>\n                      {pct > 0 ? (\n                        <ArrowUpRight size={10} className=\"text-emerald-500\" />\n                      ) : pct < 0 ? (\n                        <ArrowDownRight size={10} className=\"text-red-500\" />\n                      ) : (\n                        <Minus size={10} className=\"text-[var(--text-muted)]\" />\n                      )}\n                      <span>{`${formatSigned(pct, 2)}%`}</span>\n                    </>\n                  )}\n                </div>\n              </td>\n            )}\n\n            {/* LOW / HIGH */}\n            {visibleCols.lowHigh && (\n              <td className=\"text-center text-[10px] sm:text-[12px] py-0.5 px-0.5\">\n                <span className=\"inline-flex items-center justify-center rounded-md px-2 py-0.5 text-[10px] sm:text-[12px] font-semibold text-red-600 bg-red-500/10 shadow-[0_0_10px_rgba(239,68,68,0.15)]\">\n                  {live?.low ?? \"--\"}\n                </span>\n              </td>\n            )}\n            {visibleCols.lowHigh && (\n              <td className=\"text-center text-[10px] sm:text-[12px] py-0.5 px-0.5\">\n                <span className=\"inline-flex items-center justify-center rounded-md px-2 py-0.5 text-[10px] sm:text-[12px] font-semibold text-emerald-600 bg-emerald-500/10 shadow-[0_0_10px_rgba(16,185,129,0.15)]\">\n                  {live?.high ?? \"--\"}\n                </span>\n              </td>\n            )}\n\n            {/* SPREAD */}\n            {visibleCols.spread && (\n              <td className=\"text-center font-mono text-[10px] sm:text-[13px] py-0.5 px-0.5\">\n                {spread}\n              </td>\n            )}\n\n            {/* ACTION */}\n            {visibleCols.remove && (\n              <td className=\"text-center py-0.5 px-0.5\">\n                <button\n                  onClick={() => {\n                    setSelectedCode(row.code);\n                    setConfirmOpen(true);\n                  }}\n                  className=\"p-1 text-red-500\"\n                >\n                  <Trash2 size={14} />\n                </button>\n              </td>\n            )}\n            </motion.tr>\n          </Fragment>\n        );\n      })\n    )}\n  </AnimatePresence>\n</tbody>\n\n          </table>\n        </div>\n      </div>\n\n      {/* PAGINATION */}\n      <Pagination\n        page={page}\n        totalPages={totalPages}\n        limit={limit}\n        onPageChange={setPage}\n        onLimitChange={(l) => {\n          setLimit(l);\n          setPage(1);\n        }}\n      />\n\n      {/* CONFIRM DELETE */}\n      {confirmOpen && selectedCode && (\n        <ConfirmModal\n          title=\"Remove Symbol\"\n          description={`Remove ${selectedCode} from default watchlist?`}\n          loading={removeMutation.isPending}\n          onCancel={() => {\n            setConfirmOpen(false);\n            setSelectedCode(null);\n          }}\n          onConfirm={async () => {\n            await removeMutation.mutateAsync(selectedCode);\n            setConfirmOpen(false);\n            setSelectedCode(null);\n          }}\n        />\n      )}\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\layout.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[629,632],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[629,632],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport \"../globals.css\";\r\nimport React, { useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Topbar from \"./components/Topbar\";\r\nimport AdminSidebar from \"./components/Sidebar\";\r\nimport { useAdminMe } from \"@/hooks/useAdmin\";\r\nimport GlobalLoader from \"./components/ui/GlobalLoader\";\r\n\r\nexport default function AdminLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const router = useRouter();\r\n  const { isLoading, isError, error } = useAdminMe();\r\n\r\n  // ðŸ”´ LOGOUT SIDE-EFFECT (SAFE)\r\n  useEffect(() => {\r\n    if (!isError) return;\r\n\r\n    const status = (error as any)?.response?.status;\r\n\r\n    if (status === 401) {\r\n      localStorage.removeItem(\"accessToken\");\r\n      document.cookie = \"accessToken=; path=/; max-age=0\";\r\n\r\n      router.replace(\"/admin/login\");\r\n    }\r\n  }, [isError, error, router]);\r\n\r\n  // â³ loading\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex h-screen items-center justify-center\">\r\n        <GlobalLoader />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // â›” while redirecting â†’ blank screen\r\n  if (isError) {\r\n    return null;\r\n  }\r\n\r\n  // âœ… AUTH OK\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col text-[var(--foreground)] bg-[var(--background)]\">\r\n      <Topbar />\r\n\r\n      <div className=\"flex min-w-0 flex-1\">\n        <AdminSidebar />\n\n        <main\n          className=\"min-w-0 flex-1 overflow-x-hidden p-4 sm:p-6 transition-all duration-300\"\n          style={{\n            marginLeft: \"var(--sidebar-width)\",\n            width: \"calc(100% - var(--sidebar-width))\",\n          }}\n        >\n          <div className=\"min-w-0 w-full max-w-full\">{children}</div>\n        </main>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\notifications\\notification\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BadgeCheck' is defined but never used.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refetch' is assigned a value but never used.","line":35,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'broadcastMutation' is assigned a value but never used.","line":36,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":26},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `data.list`, but the source dependencies were [data?.list]. Inferred different dependency than source.\n\nE:\\Admin-frontend-als\\app\\admin\\notifications\\notification\\page.tsx:38:60\n  36 |   const broadcastMutation = useBroadcastNotification();\n  37 |\n> 38 |   const notifications: TransformedNotification[] = useMemo(() => {\n     |                                                            ^^^^^^^\n> 39 |     if (!data?.list || data.list.length === 0) return [];\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |\n     â€¦\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 57 |     }));\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 58 |   }, [data?.list]);\n     | ^^^^ Could not preserve existing manual memoization\n  59 |\n  60 |   const filteredNotifications: TransformedNotification[] = useMemo(() => {\n  61 |     if (!search.trim()) return notifications;","line":38,"column":60,"nodeType":null,"endLine":58,"endColumn":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useMemo, useState, useCallback } from \"react\";\r\nimport {\r\n  Plus,\r\n  Trash2,\r\n  BadgeCheck,\r\n  XCircle,\r\n  Loader2\r\n} from \"lucide-react\";\r\nimport { useGetAdminNotifications } from \"@/hooks/notification/useGetAdminNotifications\";\r\nimport { useBroadcastNotification } from \"@/hooks/notification/useBroadcastNotification\";\r\nimport Pagination from \"../../components/ui/pagination\";\r\nimport { Notification, NotificationType } from \"@/services/notification/notification.services\";\r\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\r\n\r\ninterface TransformedNotification {\r\n  id: string;\r\n  _id: string;\r\n  title: string;\r\n  message: string;\r\n  type: string;\r\n  isActive: boolean;\r\n  expireAt: string;\r\n  createdAt: string;\r\n  sentBy: string;\r\n}\r\n\r\nexport default function NotificationsPage() {\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [openModal, setOpenModal] = useState(false);\r\n\r\n  const { data, isLoading, refetch } = useGetAdminNotifications({ page, limit });\r\n  const broadcastMutation = useBroadcastNotification();\r\n\r\n  const notifications: TransformedNotification[] = useMemo(() => {\r\n    if (!data?.list || data.list.length === 0) return [];\r\n\r\n    return data.list.map((item: Notification, index: number) => ({\r\n      id: `${item._id}-${index}`,\r\n      _id: item._id,\r\n      title: item.title,\r\n      message: item.message,\r\n      type: item.data.type,\r\n      isActive: item.isActive,\r\n      expireAt: new Date(item.expireAt).toLocaleDateString(),\r\n      createdAt: new Date(item.createdAt).toLocaleString(\"en-IN\", {\r\n        year: \"numeric\",\r\n        month: \"short\",\r\n        day: \"numeric\",\r\n        hour: \"2-digit\",\r\n        minute: \"2-digit\",\r\n      }),\r\n      sentBy: \"Admin\",\r\n    }));\r\n  }, [data?.list]);\r\n\r\n  const filteredNotifications: TransformedNotification[] = useMemo(() => {\r\n    if (!search.trim()) return notifications;\r\n\r\n    return notifications.filter((n: TransformedNotification) =>\r\n      n.title.toLowerCase().includes(search.toLowerCase()) ||\r\n      n.message.toLowerCase().includes(search.toLowerCase()) ||\r\n      n.type.toLowerCase().includes(search.toLowerCase())\r\n    );\r\n  }, [notifications, search]);\r\n\r\n\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"container-pad flex items-center justify-center min-h-[400px]\">\r\n        <GlobalLoader />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container-pad space-y-6 max-w-7xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-[var(--foreground)]\">Notifications</h1>\r\n          <p className=\"text-[var(--text-muted)] mt-1\">Manage broadcast notifications</p>\r\n        </div>\r\n        <button\r\n          onClick={() => setOpenModal(true)}\r\n          className=\"btn btn-primary px-6 py-2.5 inline-flex items-center gap-2 shadow-lg hover:shadow-xl whitespace-nowrap\"\r\n        >\r\n          <Plus size={18} />\r\n          New Notification\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <div className=\"card-elevated max-w-md\">\r\n        <div className=\"relative\">\r\n          <svg className=\"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--text-muted)]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n          </svg>\r\n          <input\r\n            placeholder=\"Search notifications...\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            className=\"input w-full pl-10 pr-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--glow)] rounded-lg\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Responsive Table Card */}\r\n      <div className=\"card-elevated overflow-hidden\">\r\n        <div className=\"overflow-x-auto scrollbar-thin scrollbar-thumb-[var(--text-muted)]/40 scrollbar-track-transparent\">\r\n          <table className=\"table table-fixed min-w-[1100px] w-full\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"w-[200px]\">Title</th>\r\n                <th className=\"w-[300px]\">Message</th>\r\n                <th className=\"w-[100px]\">Type</th>\r\n                <th className=\"w-[120px]\">Status</th>\r\n                <th className=\"w-[140px]\">Expires</th>\r\n                <th className=\"w-[200px]\">Created</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredNotifications.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={6} className=\"text-center py-12\">\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"w-16 h-16 bg-[var(--hover-bg)] rounded-xl flex items-center justify-center mx-auto\">\r\n                        <svg className=\"w-7 h-7 text-[var(--text-muted)]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\r\n                        </svg>\r\n                      </div>\r\n                      <div className=\"text-[var(--text-muted)]\">\r\n                        <p className=\"font-semibold text-[var(--foreground)]\">No notifications found</p>\r\n                        <p className=\"text-sm\">Try adjusting your search or create a new one</p>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                filteredNotifications.map((notification: TransformedNotification) => (\r\n                  <tr key={notification.id} className=\"hover:bg-[var(--hover-bg)]\">\r\n                    <td className=\"font-medium text-[var(--foreground)] truncate\">\r\n                      {notification.title}\r\n                    </td>\r\n                    <td className=\"max-w-[300px]\">\r\n                      <span className=\"text-[var(--text-muted)] block truncate whitespace-nowrap\">\r\n                        {notification.message}\r\n                      </span>\r\n                    </td>\r\n                    <td>\r\n                      <span className=\"pill text-xs font-medium\">\r\n                        {notification.type}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"whitespace-nowrap\">\r\n  <span\r\n    className={`pill text-xs font-medium inline-flex items-center gap-1 ${\r\n      notification.isActive ? \"pill-success\" : \"pill-muted\"\r\n    }`}\r\n  >\r\n    {notification.isActive ? \"Active\" : \"Expired\"}\r\n  </span>\r\n</td>\r\n\r\n\r\n                    <td className=\"text-[var(--text-muted)] text-sm\">\r\n                      {notification.expireAt}\r\n                    </td>\r\n                    <td className=\"text-[var(--text-muted)] whitespace-nowrap text-sm\">\r\n                      {notification.createdAt}\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Mobile Scroll Hint */}\r\n        <div className=\"lg:hidden px-4 py-2 bg-[var(--hover-bg)] text-[var(--text-muted)] text-xs text-center\">\r\n          ðŸ‘ˆ Swipe left to see more columns\r\n        </div>\r\n      </div>\r\n\r\n      {data?.pagination && (\r\n        <div className=\"card pt-0 pb-4 px-0\">\r\n          <Pagination\r\n            page={data.pagination.page}\r\n            totalPages={data.pagination.totalPages}\r\n            limit={data.pagination.limit}\r\n            onPageChange={setPage}\r\n            onLimitChange={setLimit}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {openModal && <SendNotificationModal onClose={() => setOpenModal(false)} />}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Fully Custom Form Modal (same as before)\r\nfunction SendNotificationModal({ onClose }: { onClose: () => void }) {\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    message: \"\",\r\n    type: \"GENERAL\" as NotificationType,\r\n  });\r\n  const [isSending, setIsSending] = useState(false);\r\n\r\n  const broadcastMutation = useBroadcastNotification();\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!formData.title.trim() || !formData.message.trim()) return;\r\n\r\n    setIsSending(true);\r\n    const payload = {\r\n      title: formData.title.trim(),\r\n      message: formData.message.trim(),\r\n      expireAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),\r\n      data: { type: formData.type },\r\n    };\r\n\r\n    try {\r\n      await broadcastMutation.mutateAsync(payload);\r\n      onClose();\r\n      setFormData({ title: \"\", message: \"\", type: \"GENERAL\" });\r\n    } catch (error) {\r\n      console.error(\"Send failed:\", error);\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-6\">\r\n      <div className=\"card-elevated w-full max-w-md max-h-[90vh] overflow-hidden\">\r\n        <div className=\"p-6 pb-4 border-b border-[var(--card-border)]\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-xl font-bold text-[var(--foreground)]\">Send Notification</h2>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"btn btn-ghost p-1.5 hover:bg-[var(--hover-bg)] rounded-lg\"\r\n              disabled={isSending}\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2.5} d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-semibold text-[var(--foreground)] mb-2\">\r\n              Title *\r\n            </label>\r\n            <input\r\n              value={formData.title}\r\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n              placeholder=\"Enter notification title\"\r\n              className=\"input w-full py-2.5 px-3 text-sm focus:ring-2 focus:ring-[var(--glow)]\"\r\n              disabled={isSending}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-semibold text-[var(--foreground)] mb-2\">\r\n              Message *\r\n            </label>\r\n            <textarea\r\n              value={formData.message}\r\n              onChange={(e) => setFormData({ ...formData, message: e.target.value })}\r\n              placeholder=\"Enter notification message\"\r\n              rows={4}\r\n              className=\"input w-full py-2.5 px-3 text-sm resize-vertical focus:ring-2 focus:ring-[var(--glow)]\"\r\n              disabled={isSending}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-semibold text-[var(--foreground)] mb-2\">\r\n              Type\r\n            </label>\r\n            <select\r\n              value={formData.type}\r\n              onChange={(e) => setFormData({ ...formData, type: e.target.value as NotificationType })}\r\n              className=\"input w-full py-2.5 px-3 text-sm focus:ring-2 focus:ring-[var(--glow)]\"\r\n              disabled={isSending}\r\n            >\r\n              <option value=\"GENERAL\">General</option>\r\n              <option value=\"INFORMATION\">Information</option>\r\n              <option value=\"MAINTENANCE\">Maintenance</option>\r\n              <option value=\"HOLIDAY\">Holiday</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex gap-3 pt-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"btn btn-ghost flex-1 py-2.5 font-semibold\"\r\n              disabled={isSending}\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isSending || !formData.title.trim() || !formData.message.trim()}\r\n              className=\"btn btn-primary flex-1 py-2.5 font-semibold relative flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isSending ? (\r\n                <>\r\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                  Sending...\r\n                </>\r\n              ) : (\r\n                \"Send Notification\"\r\n              )}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\active-positions\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":394,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11790,11793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11790,11793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":432,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":432,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12749,12752],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12749,12752],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"ï»¿\"use client\";\n\nimport {\n  useCallback,\n  useMemo,\n  useState,\n  type FormEvent,\n  type ReactNode,\n} from \"react\";\nimport {\n  ArrowDownRight,\n  ArrowUpRight,\n  BarChart3,\n  Calendar,\n  CheckCircle2,\n  ClipboardCopy,\n  Coins,\n  DollarSign,\n  Hash,\n  Pencil,\n  Search,\n  ShieldCheck,\n  SlidersHorizontal,\n  Sparkles,\n  User,\n  Wallet,\n  XCircle,\n} from \"lucide-react\";\nimport GlobalLoader from \"@/app/admin/components/ui/GlobalLoader\";\nimport Modal from \"@/app/admin/components/ui/Modal\";\nimport Pagination from \"@/app/admin/components/ui/pagination\";\nimport { useLiveQuotesBySymbols } from \"@/hooks/useLiveQuotesBySymbols\";\nimport { useTradeAdminOpenTrades } from \"@/hooks/useTradeAdminOpenTrades\";\nimport {\n  useTradeAdminClosePosition,\n  useTradeAdminModifyPosition,\n} from \"@/hooks/useTradeAdminOrderActions\";\nimport { getAccessTokenFromCookie } from \"@/services/marketSocket.service\";\nimport type {\n  TradeAdminOpenTrade,\n  TradeOrderKind,\n  TradeOrderType,\n  TradeSide,\n  TradeSortDir,\n} from \"@/services/tradeAdmin.service\";\n\ntype OpenTradeFilters = {\n  userId: string;\n  accountId: string;\n  symbol: string;\n  positionId: string;\n  side: \"\" | TradeSide;\n  orderType: \"\" | TradeOrderType;\n  orderKind: \"\" | TradeOrderKind;\n  from: string;\n  to: string;\n  timeField: \"openTime\" | \"createdAt\" | \"updatedAt\";\n  sortBy: \"openTime\" | \"createdAt\" | \"updatedAt\";\n  sortDir: TradeSortDir;\n};\n\nfunction getDefaultFromDate() {\n  const date = new Date();\n  date.setDate(date.getDate() - 7);\n  return date.toISOString().slice(0, 10);\n}\n\nfunction getDefaultToDate() {\n  return new Date().toISOString().slice(0, 10);\n}\n\nfunction getDefaultFilters(): OpenTradeFilters {\n  return {\n    userId: \"\",\n    accountId: \"\",\n    symbol: \"\",\n    positionId: \"\",\n    side: \"\",\n    orderType: \"\",\n    orderKind: \"\",\n    from: getDefaultFromDate(),\n    to: getDefaultToDate(),\n    timeField: \"openTime\",\n    sortBy: \"openTime\",\n    sortDir: \"desc\",\n  };\n}\n\nfunction formatDateTime(value?: string) {\n  if (!value) return \"--\";\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return value;\n  return date.toLocaleString(\"en-GB\", {\n    day: \"2-digit\",\n    month: \"short\",\n    year: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: false,\n  });\n}\n\nfunction normalizeDateTime(value: string, kind: \"start\" | \"end\") {\n  if (!value) return value;\n  if (/^\\d{4}-\\d{2}-\\d{2}$/.test(value)) {\n    return kind === \"start\"\n      ? `${value}T00:00:00.000Z`\n      : `${value}T23:59:59.999Z`;\n  }\n  return value;\n}\n\nfunction formatNumber(value?: number, digits = 2) {\n  if (value === undefined || value === null || Number.isNaN(value)) return \"--\";\n  return value.toLocaleString(\"en-IN\", {\n    minimumFractionDigits: digits,\n    maximumFractionDigits: digits,\n  });\n}\n\nfunction formatPrice(value?: number) {\n  if (value === undefined || value === null || Number.isNaN(value)) return \"--\";\n  const digits = Math.abs(value) >= 100 ? 2 : 5;\n  return formatNumber(value, digits);\n}\n\nfunction parseNullableNumber(value: string) {\n  const trimmed = value.trim();\n  if (!trimmed) return null;\n  const num = Number(trimmed);\n  if (!Number.isFinite(num)) return null;\n  return num;\n}\n\nfunction getSideMeta(side?: string) {\n  const normalizedSide = (side ?? \"\").toUpperCase();\n\n  if (normalizedSide === \"BUY\") {\n    return {\n      label: \"BUY\",\n      Icon: ArrowUpRight,\n      className: \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\",\n    };\n  }\n\n  if (normalizedSide === \"SELL\") {\n    return {\n      label: \"SELL\",\n      Icon: ArrowDownRight,\n      className: \"border-rose-500/40 bg-rose-500/10 text-rose-700\",\n    };\n  }\n\n  return {\n    label: normalizedSide || \"--\",\n    Icon: Hash,\n    className: \"border-slate-500/40 bg-slate-500/10 text-slate-700\",\n  };\n}\n\nfunction getOrderTypeClass(orderType?: string) {\n  const normalized = (orderType ?? \"\").toUpperCase();\n  if (normalized === \"MARKET\")\n    return \"border-violet-500/40 bg-violet-500/10 text-violet-700\";\n  if (normalized.includes(\"LIMIT\"))\n    return \"border-sky-500/40 bg-sky-500/10 text-sky-700\";\n  if (normalized.includes(\"STOP\"))\n    return \"border-amber-500/40 bg-amber-500/10 text-amber-700\";\n  return \"border-slate-500/40 bg-slate-500/10 text-slate-700\";\n}\n\nfunction getStatusClass(status?: string) {\n  const normalized = (status ?? \"\").toUpperCase();\n  if (normalized === \"OPEN\")\n    return \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\";\n  if (normalized === \"CLOSE\" || normalized === \"CLOSED\")\n    return \"border-rose-500/40 bg-rose-500/10 text-rose-700\";\n  return \"border-slate-500/40 bg-slate-500/10 text-slate-700\";\n}\n\nfunction getPnlClass(value?: number) {\n  if (value === undefined || value === null || Number.isNaN(value))\n    return \"text-[var(--text-muted)]\";\n  if (value > 0) return \"text-emerald-600\";\n  if (value < 0) return \"text-rose-600\";\n  return \"text-[var(--text-muted)]\";\n}\n\nexport default function ActivePositionsPage() {\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(20);\n  const [copyToast, setCopyToast] = useState(\"\");\n  const [mobileFiltersOpen, setMobileFiltersOpen] = useState(false);\n\n  const [draftFilters, setDraftFilters] = useState<OpenTradeFilters>(\n    getDefaultFilters\n  );\n  const [filters, setFilters] = useState<OpenTradeFilters>(getDefaultFilters);\n\n  const [positionActionOpen, setPositionActionOpen] = useState(false);\n  const [positionAction, setPositionAction] = useState<TradeAdminOpenTrade | null>(\n    null\n  );\n  const [positionActionError, setPositionActionError] = useState(\"\");\n  const [positionForm, setPositionForm] = useState({\n    stopLoss: \"\",\n    takeProfit: \"\",\n  });\n\n  const [closeConfirmOpen, setCloseConfirmOpen] = useState(false);\n  const [closeTarget, setCloseTarget] = useState<TradeAdminOpenTrade | null>(null);\n  const [closeError, setCloseError] = useState(\"\");\n\n  const openTradesQuery = useTradeAdminOpenTrades({\n    page,\n    limit,\n    userId: filters.userId || undefined,\n    accountId: filters.accountId || undefined,\n    symbol: filters.symbol || undefined,\n    positionId: filters.positionId || undefined,\n    side: filters.side || undefined,\n    orderType: filters.orderType || undefined,\n    orderKind: filters.orderType ? undefined : filters.orderKind || undefined,\n    from: filters.from ? normalizeDateTime(filters.from, \"start\") : undefined,\n    to: filters.to ? normalizeDateTime(filters.to, \"end\") : undefined,\n    timeField: filters.timeField || undefined,\n    sortBy: filters.sortBy || filters.timeField || undefined,\n    sortDir: filters.sortDir || undefined,\n  });\n\n  const modifyPositionMutation = useTradeAdminModifyPosition();\n  const closePositionMutation = useTradeAdminClosePosition();\n\n  const rows = useMemo(\n    () => openTradesQuery.data?.data ?? [],\n    [openTradesQuery.data?.data]\n  );\n  const pagination = openTradesQuery.data?.pagination;\n  const total = pagination?.total ?? rows.length;\n  const totalPages =\n    pagination?.totalPages ?? Math.max(1, Math.ceil(total / Math.max(limit, 1)));\n\n  const marketToken = getAccessTokenFromCookie();\n  const symbols = useMemo(() => {\n    const next = new Set<string>();\n    rows.forEach((row) => {\n      const symbol = (row.symbol ?? \"\").trim().toUpperCase();\n      if (symbol) next.add(symbol);\n    });\n    return Array.from(next);\n  }, [rows]);\n  const liveQuotes = useLiveQuotesBySymbols(marketToken, symbols);\n\n  const getLivePrice = useCallback(\n    (trade: TradeAdminOpenTrade) => {\n      const symbol = (trade.symbol ?? \"\").trim().toUpperCase();\n      if (!symbol) return undefined;\n      const quote = liveQuotes[symbol];\n      if (!quote) return undefined;\n      const bid = Number(quote.bid);\n      const ask = Number(quote.ask);\n      const side = (trade.side ?? \"\").toUpperCase();\n      if (side === \"BUY\" && Number.isFinite(bid)) return bid;\n      if (side === \"SELL\" && Number.isFinite(ask)) return ask;\n      if (Number.isFinite(ask)) return ask;\n      if (Number.isFinite(bid)) return bid;\n      return undefined;\n    },\n    [liveQuotes]\n  );\n\n  const getLivePnl = useCallback(\n    (trade: TradeAdminOpenTrade, livePrice?: number) => {\n      const price = livePrice ?? getLivePrice(trade);\n      if (price === undefined || !Number.isFinite(price)) return undefined;\n      const openPrice = Number(trade.openPrice ?? trade.entryPrice);\n      if (!Number.isFinite(openPrice)) return undefined;\n      const volume = Number(trade.volume ?? 0);\n      const contractSize = Number(trade.contractSize ?? 1);\n      if (!Number.isFinite(volume) || !Number.isFinite(contractSize))\n        return undefined;\n      const side = (trade.side ?? \"\").toUpperCase();\n      const diff = side === \"SELL\" ? openPrice - price : price - openPrice;\n      return diff * volume * contractSize;\n    },\n    [getLivePrice]\n  );\n\n  const summary = useMemo(\n    () =>\n      rows.reduce(\n        (acc, row) => ({\n          volume: acc.volume + (row.volume ?? 0),\n          margin: acc.margin + (row.marginUsed ?? 0),\n          grossPnL: acc.grossPnL + (row.grossPnL ?? 0),\n          commission: acc.commission + (row.commission ?? 0),\n          swap: acc.swap + (row.swap ?? 0),\n        }),\n        { volume: 0, margin: 0, grossPnL: 0, commission: 0, swap: 0 }\n      ),\n    [rows]\n  );\n\n  const livePnlTotal = useMemo(\n    () =>\n      rows.reduce((acc, row) => {\n        const livePnl = getLivePnl(row);\n        if (!Number.isFinite(livePnl ?? NaN)) return acc;\n        return acc + (livePnl ?? 0);\n      }, 0),\n    [rows, getLivePnl]\n  );\n\n  const applyFilters = () => {\n    setFilters({\n      ...draftFilters,\n      symbol: draftFilters.symbol.trim().toUpperCase(),\n      userId: draftFilters.userId.trim(),\n      accountId: draftFilters.accountId.trim(),\n      positionId: draftFilters.positionId.trim(),\n    });\n    setPage(1);\n  };\n\n  const resetFilters = () => {\n    const next = getDefaultFilters();\n    setDraftFilters(next);\n    setFilters(next);\n    setPage(1);\n  };\n\n  const handleCopy = async (value: string, label: string) => {\n    if (!value) return;\n    try {\n      await navigator.clipboard.writeText(value);\n      setCopyToast(`${label} copied`);\n      setTimeout(() => setCopyToast(\"\"), 1800);\n    } catch {\n      setCopyToast(\"Copy failed\");\n      setTimeout(() => setCopyToast(\"\"), 1800);\n    }\n  };\n\n  const openPositionAction = (trade: TradeAdminOpenTrade) => {\n    setPositionAction(trade);\n    setPositionForm({\n      stopLoss:\n        trade.stopLoss === null || trade.stopLoss === undefined\n          ? \"\"\n          : String(trade.stopLoss),\n      takeProfit:\n        trade.takeProfit === null || trade.takeProfit === undefined\n          ? \"\"\n          : String(trade.takeProfit),\n    });\n    setPositionActionError(\"\");\n    setPositionActionOpen(true);\n  };\n\n  const closePositionAction = () => {\n    setPositionActionOpen(false);\n    setPositionAction(null);\n    setPositionActionError(\"\");\n  };\n\n  const handlePositionModifySubmit = (event: FormEvent) => {\n    event.preventDefault();\n    if (!positionAction) return;\n\n    const stopLoss = parseNullableNumber(positionForm.stopLoss);\n    const takeProfit = parseNullableNumber(positionForm.takeProfit);\n\n    if (stopLoss === null && takeProfit === null) {\n      setPositionActionError(\"Enter stop loss or take profit.\");\n      return;\n    }\n\n    modifyPositionMutation.mutate(\n      {\n        accountId: positionAction.accountId,\n        positionId: positionAction.positionId,\n        userId: positionAction.userId,\n        stopLoss: stopLoss ?? undefined,\n        takeProfit: takeProfit ?? undefined,\n      },\n      {\n        onSuccess: () => {\n          setCopyToast(\"Position updated.\");\n          setTimeout(() => setCopyToast(\"\"), 1800);\n          closePositionAction();\n          openTradesQuery.refetch();\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            \"Position update failed.\";\n          setPositionActionError(msg);\n        },\n      }\n    );\n  };\n\n  const openCloseConfirm = (trade: TradeAdminOpenTrade) => {\n    setCloseTarget(trade);\n    setCloseError(\"\");\n    setCloseConfirmOpen(true);\n  };\n\n  const closeCloseConfirm = () => {\n    setCloseConfirmOpen(false);\n    setCloseTarget(null);\n    setCloseError(\"\");\n  };\n\n  const handleClosePosition = () => {\n    if (!closeTarget) return;\n    closePositionMutation.mutate(\n      {\n        accountId: closeTarget.accountId,\n        positionId: closeTarget.positionId,\n        userId: closeTarget.userId,\n      },\n      {\n        onSuccess: () => {\n          setCopyToast(\"Position closed.\");\n          setTimeout(() => setCopyToast(\"\"), 1800);\n          closeCloseConfirm();\n          openTradesQuery.refetch();\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message || err?.message || \"Close failed.\";\n          setCloseError(msg);\n        },\n      }\n    );\n  };\n\n  return (\r\n    <div className=\"container-pad max-w-full space-y-4 text-[var(--foreground)] sm:space-y-5\">\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-gradient-to-br from-[var(--card-bg)] via-[var(--card-bg)] to-emerald-500/5 p-4 sm:p-5\">\n        <div className=\"inline-flex items-center gap-2 rounded-full border border-emerald-500/30 bg-emerald-500/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-emerald-700\">\n          <Sparkles size={12} />\n          Live Positions\n        </div>\n        <h1 className=\"mt-2 text-xl font-semibold sm:text-2xl\">\n          Active Positions\n        </h1>\n        <p className=\"mt-1 text-sm text-[var(--text-muted)]\">\n          Monitor open trades with filters and quick actions.\n        </p>\n\n        <button\n          type=\"button\"\n          onClick={() => setMobileFiltersOpen((prev) => !prev)}\n          className=\"mt-4 inline-flex w-full items-center justify-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)] md:hidden\"\n        >\n          <SlidersHorizontal size={14} />\n          {mobileFiltersOpen ? \"Hide Filters\" : \"Show Filters\"}\n        </button>\n\n        <div\n          className={`mt-4 grid grid-cols-1 gap-3 md:grid md:grid-cols-2 xl:grid-cols-4 ${\n            mobileFiltersOpen ? \"grid\" : \"hidden md:grid\"\n          }`}\n        >\n          <InputField\n            icon={<User size={14} />}\n            placeholder=\"User ID\"\n            value={draftFilters.userId}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, userId: value }))\n            }\n          />\n          <InputField\n            icon={<Wallet size={14} />}\n            placeholder=\"Account ID\"\n            value={draftFilters.accountId}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, accountId: value }))\n            }\n          />\n          <InputField\n            icon={<Search size={14} />}\n            placeholder=\"Symbol (e.g. BTCUSD)\"\n            value={draftFilters.symbol}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, symbol: value }))\n            }\n          />\n          <InputField\n            icon={<Hash size={14} />}\n            placeholder=\"Position ID\"\n            value={draftFilters.positionId}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, positionId: value }))\n            }\n          />\n\n          <SelectField\n            icon={<ArrowUpRight size={13} />}\n            value={draftFilters.side}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                side: value as OpenTradeFilters[\"side\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All Side\" },\n              { value: \"BUY\", label: \"BUY\" },\n              { value: \"SELL\", label: \"SELL\" },\n            ]}\n          />\n          <SelectField\n            icon={<BarChart3 size={13} />}\n            value={draftFilters.orderType}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                orderType: value as OpenTradeFilters[\"orderType\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All Order Type\" },\n              { value: \"MARKET\", label: \"MARKET\" },\n              { value: \"BUY_LIMIT\", label: \"BUY_LIMIT\" },\n              { value: \"SELL_LIMIT\", label: \"SELL_LIMIT\" },\n              { value: \"BUY_STOP\", label: \"BUY_STOP\" },\n              { value: \"SELL_STOP\", label: \"SELL_STOP\" },\n            ]}\n          />\n          <SelectField\n            icon={<SlidersHorizontal size={13} />}\n            value={draftFilters.orderKind}\n            disabled={Boolean(draftFilters.orderType)}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                orderKind: value as OpenTradeFilters[\"orderKind\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All Order Kind\" },\n              { value: \"MARKET\", label: \"MARKET\" },\n              { value: \"LIMIT\", label: \"LIMIT\" },\n              { value: \"STOP\", label: \"STOP\" },\n            ]}\n          />\n          <SelectField\n            icon={<Calendar size={13} />}\n            value={draftFilters.timeField}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                timeField: value as OpenTradeFilters[\"timeField\"],\n              }))\n            }\n            options={[\n              { value: \"openTime\", label: \"timeField: openTime\" },\n              { value: \"createdAt\", label: \"timeField: createdAt\" },\n              { value: \"updatedAt\", label: \"timeField: updatedAt\" },\n            ]}\n          />\n\n          <InputField\n            icon={<Calendar size={14} />}\n            type=\"date\"\n            value={draftFilters.from}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, from: value }))\n            }\n          />\n          <InputField\n            icon={<Calendar size={14} />}\n            type=\"date\"\n            value={draftFilters.to}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, to: value }))\n            }\n          />\n          <SelectField\n            icon={<Calendar size={13} />}\n            value={draftFilters.sortBy}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                sortBy: value as OpenTradeFilters[\"sortBy\"],\n              }))\n            }\n            options={[\n              { value: \"openTime\", label: \"sortBy: openTime\" },\n              { value: \"createdAt\", label: \"sortBy: createdAt\" },\n              { value: \"updatedAt\", label: \"sortBy: updatedAt\" },\n            ]}\n          />\n          <SelectField\n            icon={<SlidersHorizontal size={13} />}\n            value={draftFilters.sortDir}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                sortDir: value as OpenTradeFilters[\"sortDir\"],\n              }))\n            }\n            options={[\n              { value: \"desc\", label: \"sortDir: desc\" },\n              { value: \"asc\", label: \"sortDir: asc\" },\n            ]}\n          />\n        </div>\n\n        <div\n          className={`mt-4 grid grid-cols-1 gap-2 sm:flex sm:flex-wrap sm:items-center ${\n            mobileFiltersOpen ? \"grid\" : \"hidden md:flex\"\n          }`}\n        >\n          <button\n            type=\"button\"\n            onClick={applyFilters}\n            className=\"inline-flex w-full items-center justify-center gap-2 rounded-lg bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white shadow-[var(--shadow-1)] hover:bg-[var(--primary-dark)] sm:w-auto\"\n          >\n            <SlidersHorizontal size={14} />\n            Apply Filters\n          </button>\n          <button\n            type=\"button\"\n            onClick={resetFilters}\n            className=\"w-full rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)] sm:w-auto\"\n          >\n            Reset\n          </button>\n        </div>\n      </div>\r\n\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-6\">\n        <MetricCard\n          label=\"Positions\"\n          value={String(total)}\n          icon={<Hash size={13} />}\n          tone=\"slate\"\n        />\n        <MetricCard\n          label=\"Total Volume\"\n          value={formatNumber(summary.volume, 4)}\n          icon={<BarChart3 size={13} />}\n          tone=\"sky\"\n        />\n        <MetricCard\n          label=\"Margin Used\"\n          value={formatNumber(summary.margin, 4)}\n          icon={<ShieldCheck size={13} />}\n          tone=\"amber\"\n        />\n        <MetricCard\n          label=\"Live PnL\"\n          value={formatNumber(livePnlTotal, 4)}\n          icon={<DollarSign size={13} />}\n          tone={livePnlTotal >= 0 ? \"emerald\" : \"rose\"}\n          valueClassName={\n            livePnlTotal >= 0 ? \"text-emerald-600\" : \"text-rose-600\"\n          }\n        />\n        <MetricCard\n          label=\"Commission\"\n          value={formatNumber(summary.commission, 4)}\n          icon={<Coins size={13} />}\n          tone=\"violet\"\n        />\n        <MetricCard\n          label=\"Swap\"\n          value={formatNumber(summary.swap, 4)}\n          icon={<Coins size={13} />}\n          tone=\"amber\"\n        />\n      </div>\n\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4 sm:p-5\">\n        {openTradesQuery.isLoading ? (\n          <div className=\"py-8\">\n            <GlobalLoader />\n          </div>\n        ) : openTradesQuery.isError ? (\n          <div className=\"rounded-xl border border-red-200 bg-red-50 px-4 py-6 text-center text-sm text-red-700\">\n            Failed to load active positions.\n            <button\n              type=\"button\"\n              onClick={() => openTradesQuery.refetch()}\n              className=\"ml-3 rounded-md border border-red-300 bg-white px-3 py-1 text-xs font-semibold hover:bg-red-100\"\n            >\n              Retry\n            </button>\n          </div>\n        ) : rows.length === 0 ? (\n          <div className=\"rounded-xl border border-dashed border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-10 text-center text-sm text-[var(--text-muted)]\">\n            No open positions found for selected filters.\n          </div>\n        ) : (\n          <>\n            <div className=\"hidden overflow-x-auto md:block\">\n              <table className=\"min-w-[1700px] w-full text-left text-sm\">\n                <thead className=\"bg-[var(--input-bg)] text-xs uppercase text-[var(--text-muted)]\">\n                  <tr>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <BarChart3 size={12} /> Symbol\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <ArrowUpRight size={12} /> Side\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <SlidersHorizontal size={12} /> Order Type\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Hash size={12} /> Volume\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <DollarSign size={12} /> Open Price\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <DollarSign size={12} /> Live Price\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">SL</th>\n                    <th className=\"px-4 py-3\">TP</th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <DollarSign size={12} /> Live PnL\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <ShieldCheck size={12} /> Margin\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Calendar size={12} /> Open Time\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <User size={12} /> User ID\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Wallet size={12} /> Account ID\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">\n                      <span className=\"inline-flex items-center gap-1\">\n                        <Hash size={12} /> Position ID\n                      </span>\n                    </th>\n                    <th className=\"px-4 py-3\">Status</th>\n                    <th className=\"px-4 py-3 text-right\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\r\n                  {rows.map((trade) => {\n                    const livePrice = getLivePrice(trade);\n                    const livePnl = getLivePnl(trade, livePrice);\n\n                    return (\n                      <tr\n                        key={trade._id}\n                        className=\"border-t border-[var(--card-border)] hover:bg-[var(--hover-bg)]/60\"\n                      >\n                        <td className=\"whitespace-nowrap px-4 py-3 font-semibold\">\n                          {trade.symbol || \"--\"}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <SideBadge side={trade.side} />\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <OrderTypeBadge orderType={trade.orderType} />\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatNumber(trade.volume, 4)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatPrice(trade.openPrice)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatPrice(livePrice)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatPrice(trade.stopLoss ?? undefined)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatPrice(trade.takeProfit ?? undefined)}\n                        </td>\n                        <td\n                          className={`whitespace-nowrap px-4 py-3 font-semibold ${getPnlClass(\n                            livePnl\n                          )}`}\n                        >\n                          {formatNumber(livePnl, 4)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3\">\n                          {formatNumber(trade.marginUsed, 4)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3 text-xs\">\n                          {formatDateTime(trade.openTime)}\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3 font-mono text-xs\">\n                          <div className=\"inline-flex items-center gap-1.5\">\n                            {trade.userId}\n                            <CopyBtn\n                              onClick={() => handleCopy(trade.userId, \"User ID\")}\n                            />\n                          </div>\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3 font-mono text-xs\">\n                          <div className=\"inline-flex items-center gap-1.5\">\n                            {trade.accountId}\n                            <CopyBtn\n                              onClick={() =>\n                                handleCopy(trade.accountId, \"Account ID\")\n                              }\n                            />\n                          </div>\n                        </td>\n                        <td className=\"whitespace-nowrap px-4 py-3 font-mono text-xs\">\n                          <div className=\"inline-flex items-center gap-1.5\">\n                            {trade.positionId}\n                            <CopyBtn\n                              onClick={() =>\n                                handleCopy(trade.positionId, \"Position ID\")\n                              }\n                            />\n                          </div>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getStatusClass(\n                              trade.status\n                            )}`}\n                          >\n                            <CheckCircle2 size={11} />\n                            {trade.status || \"OPEN\"}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <div className=\"flex items-center justify-end gap-2\">\n                            <button\n                              type=\"button\"\n                              onClick={() => openPositionAction(trade)}\n                              className=\"inline-flex items-center gap-1 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2.5 py-1 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n                            >\n                              <Pencil size={12} />\n                              Modify\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => openCloseConfirm(trade)}\n                              className=\"inline-flex items-center gap-1 rounded-md border border-rose-200 bg-rose-50 px-2.5 py-1 text-xs font-semibold text-rose-700 hover:bg-rose-100\"\n                            >\n                              <XCircle size={12} />\n                              Close\n                            </button>\n                          </div>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n\n            <div className=\"space-y-3 md:hidden\">\n              {rows.map((trade) => {\n                const livePrice = getLivePrice(trade);\n                const livePnl = getLivePnl(trade, livePrice);\n\n                return (\n                  <MobileTradeCard\n                    key={`mobile-${trade._id}`}\n                    trade={trade}\n                    livePrice={livePrice}\n                    livePnl={livePnl}\n                    onCopy={handleCopy}\n                    onModify={openPositionAction}\n                    onClose={openCloseConfirm}\n                  />\n                );\n              })}\n            </div>\n          </>\n        )}\n      </div>\r\n\n      <Pagination\n        page={page}\n        totalPages={totalPages}\n        limit={limit}\n        onPageChange={setPage}\n        onLimitChange={(nextLimit) => {\n          setLimit(nextLimit);\n          setPage(1);\n        }}\n      />\n\n      {copyToast ? (\n        <div className=\"fixed bottom-5 right-5 z-50 rounded-md bg-[var(--foreground)] px-3 py-1.5 text-xs font-semibold text-white shadow-lg\">\n          {copyToast}\n        </div>\n      ) : null}\n\n      <Modal\n        title=\"Modify Position\"\n        open={positionActionOpen}\n        onClose={closePositionAction}\n        size=\"sm\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closePositionAction}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              form=\"position-action-form\"\n              disabled={modifyPositionMutation.isPending || !positionAction}\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\n            >\n              {modifyPositionMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n            </button>\n          </div>\n        }\n      >\n        <form\n          id=\"position-action-form\"\n          onSubmit={handlePositionModifySubmit}\n          className=\"space-y-4\"\n        >\n          {positionActionError ? (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {positionActionError}\n            </div>\n          ) : null}\n\n          {!positionAction ? (\n            <p className=\"text-sm text-[var(--text-muted)]\">\n              No position selected.\n            </p>\n          ) : (\n            <>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3 text-sm\">\n                <p className=\"font-mono font-semibold\">\n                  {positionAction.positionId}\n                </p>\n                <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n                  Account: {positionAction.accountId}\n                </p>\n              </div>\n\n              <div className=\"grid gap-3 sm:grid-cols-2\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Stop Loss\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={positionForm.stopLoss}\n                      onChange={(event) =>\n                        setPositionForm((prev) => ({\n                          ...prev,\n                          stopLoss: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Take Profit\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={positionForm.takeProfit}\n                      onChange={(event) =>\n                        setPositionForm((prev) => ({\n                          ...prev,\n                          takeProfit: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n              </div>\n            </>\n          )}\n        </form>\n      </Modal>\r\n      <Modal\n        title=\"Close Position\"\n        open={closeConfirmOpen}\n        onClose={closeCloseConfirm}\n        size=\"sm\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closeCloseConfirm}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleClosePosition}\n              disabled={closePositionMutation.isPending || !closeTarget}\n              className=\"rounded-md bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60\"\n            >\n              {closePositionMutation.isPending ? \"Closing...\" : \"Confirm Close\"}\n            </button>\n          </div>\n        }\n      >\n        <div className=\"space-y-4\">\n          {closeError ? (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {closeError}\n            </div>\n          ) : null}\n          {!closeTarget ? (\n            <p className=\"text-sm text-[var(--text-muted)]\">\n              No position selected.\n            </p>\n          ) : (\n            <>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3 text-sm\">\n                <p className=\"font-semibold\">\n                  {closeTarget.symbol} Â· {closeTarget.side}\n                </p>\n                <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n                  Position: {closeTarget.positionId}\n                </p>\n                <p className=\"text-xs text-[var(--text-muted)]\">\n                  Account: {closeTarget.accountId}\n                </p>\n              </div>\n              <p className=\"text-sm text-[var(--text-muted)]\">\n                This will close the position at market price. Continue?\n              </p>\n            </>\n          )}\n        </div>\n      </Modal>\n    </div>\n  );\n}\r\n\nfunction InputField({\n  value,\n  onChange,\n  placeholder = \"\",\n  type = \"text\",\n  icon,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  type?: \"text\" | \"date\";\n  icon?: ReactNode;\n}) {\n  return (\n    <div className=\"relative\">\n      {icon ? (\n        <span className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\">\n          {icon}\n        </span>\n      ) : null}\n      <input\n        type={type}\n        value={value}\n        onChange={(event) => onChange(event.target.value)}\n        placeholder={placeholder}\n        className={`w-full rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] py-2 pr-3 text-[13px] outline-none focus:ring-2 focus:ring-[var(--primary)]/20 sm:text-sm ${\n          icon ? \"pl-9\" : \"pl-3\"\n        }`}\n      />\n    </div>\n  );\n}\n\nfunction SelectField({\n  value,\n  onChange,\n  options,\n  disabled = false,\n  icon,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  options: Array<{ value: string; label: string }>;\n  disabled?: boolean;\n  icon?: ReactNode;\n}) {\n  return (\n    <div className=\"relative\">\n      {icon ? (\n        <span className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\">\n          {icon}\n        </span>\n      ) : null}\n      <select\n        value={value}\n        disabled={disabled}\n        onChange={(event) => onChange(event.target.value)}\n        className={`w-full rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] py-2 pr-3 text-[13px] outline-none focus:ring-2 focus:ring-[var(--primary)]/20 disabled:cursor-not-allowed disabled:opacity-60 sm:text-sm ${\n          icon ? \"pl-9\" : \"pl-3\"\n        }`}\n      >\n        {options.map((option) => (\n          <option key={option.value || option.label} value={option.value}>\n            {option.label}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nfunction MetricCard({\n  label,\n  value,\n  icon,\n  tone,\n  valueClassName = \"\",\n}: {\n  label: string;\n  value: string;\n  icon: ReactNode;\n  tone: \"slate\" | \"sky\" | \"violet\" | \"amber\" | \"emerald\" | \"rose\";\n  valueClassName?: string;\n}) {\n  const toneClasses: Record<typeof tone, string> = {\n    slate: \"border-slate-400/30 bg-slate-500/[0.04]\",\n    sky: \"border-sky-400/30 bg-sky-500/[0.05]\",\n    violet: \"border-violet-400/30 bg-violet-500/[0.05]\",\n    amber: \"border-amber-400/30 bg-amber-500/[0.05]\",\n    emerald: \"border-emerald-400/30 bg-emerald-500/[0.05]\",\n    rose: \"border-rose-400/30 bg-rose-500/[0.05]\",\n  };\n\n  return (\n    <div className={`rounded-xl border p-3 ${toneClasses[tone]}`}>\n      <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n        {label}\n      </p>\n      <div className=\"mt-1 inline-flex h-6 w-6 items-center justify-center rounded-md bg-[var(--card-bg)] text-[var(--text-muted)]\">\n        {icon}\n      </div>\n      <p className={`mt-1 text-lg font-semibold text-[var(--foreground)] ${valueClassName}`}>\n        {value}\n      </p>\n    </div>\n  );\n}\n\nfunction SideBadge({ side }: { side?: string }) {\n  const meta = getSideMeta(side);\n  const Icon = meta.Icon;\n\n  return (\n    <span\n      className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${meta.className}`}\n    >\n      <Icon size={11} />\n      {meta.label}\n    </span>\n  );\n}\n\nfunction OrderTypeBadge({ orderType }: { orderType?: string }) {\n  return (\n    <span\n      className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getOrderTypeClass(\n        orderType\n      )}`}\n    >\n      {orderType || \"--\"}\n    </span>\n  );\n}\n\nfunction CopyBtn({ onClick }: { onClick: () => void }) {\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      className=\"inline-flex h-5 w-5 items-center justify-center rounded border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)] hover:text-[var(--foreground)]\"\n      aria-label=\"Copy value\"\n      title=\"Copy\"\n    >\n      <ClipboardCopy size={10} />\n    </button>\n  );\n}\r\n\nfunction FieldControl({\n  icon: Icon,\n  children,\n}: {\n  icon: typeof Hash;\n  children: ReactNode;\n}) {\n  return (\n    <div className=\"flex items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n      <Icon size={14} className=\"text-[var(--text-muted)]\" />\n      {children}\n    </div>\n  );\n}\n\nfunction MobileTradeCard({\n  trade,\n  livePrice,\n  livePnl,\n  onCopy,\n  onModify,\n  onClose,\n}: {\n  trade: TradeAdminOpenTrade;\n  livePrice?: number;\n  livePnl?: number;\n  onCopy: (value: string, label: string) => void;\n  onModify: (trade: TradeAdminOpenTrade) => void;\n  onClose: (trade: TradeAdminOpenTrade) => void;\n}) {\n  return (\n    <div className=\"rounded-xl border border-[var(--card-border)] bg-gradient-to-br from-[var(--input-bg)] via-[var(--input-bg)] to-emerald-500/[0.05] p-3\">\n      <div className=\"flex items-center justify-between gap-2\">\n        <p className=\"inline-flex items-center gap-1 text-sm font-semibold\">\n          <BarChart3 size={14} className=\"text-emerald-600\" />\n          {trade.symbol || \"--\"}\n        </p>\n        <SideBadge side={trade.side} />\n      </div>\n\n      <div className=\"mt-2 grid grid-cols-1 gap-2 text-xs sm:grid-cols-2\">\n        <SmallField label=\"Order\" value={trade.orderType || \"--\"} />\n        <SmallField label=\"Volume\" value={formatNumber(trade.volume, 4)} />\n        <SmallField label=\"Open Price\" value={formatPrice(trade.openPrice)} />\n        <SmallField label=\"Live Price\" value={formatPrice(livePrice)} />\n        <SmallField label=\"SL\" value={formatPrice(trade.stopLoss ?? undefined)} />\n        <SmallField label=\"TP\" value={formatPrice(trade.takeProfit ?? undefined)} />\n        <SmallField\n          label=\"PnL\"\n          value={formatNumber(livePnl, 4)}\n          valueClassName={getPnlClass(livePnl)}\n        />\n        <SmallField label=\"Margin\" value={formatNumber(trade.marginUsed, 4)} />\n      </div>\n\n      <div className=\"mt-2 flex items-center justify-between text-xs\">\n        <span className=\"text-[var(--text-muted)]\">Live PnL</span>\n        <span className={`font-semibold ${getPnlClass(livePnl)}`}>\n          {formatNumber(livePnl, 4)}\n        </span>\n      </div>\n\n      <p className=\"mt-2 flex items-start gap-1 text-[11px] text-[var(--text-muted)]\">\n        <span className=\"break-all\">User: {trade.userId}</span>\n        <CopyBtn onClick={() => onCopy(trade.userId, \"User ID\")} />\n      </p>\n      <p className=\"flex items-start gap-1 text-[11px] text-[var(--text-muted)]\">\n        <span className=\"break-all\">Account: {trade.accountId}</span>\n        <CopyBtn onClick={() => onCopy(trade.accountId, \"Account ID\")} />\n      </p>\n      <p className=\"flex items-start gap-1 text-[11px] text-[var(--text-muted)]\">\n        <span className=\"break-all\">Position: {trade.positionId}</span>\n        <CopyBtn onClick={() => onCopy(trade.positionId, \"Position ID\")} />\n      </p>\n      <p className=\"mt-1 text-[11px] text-[var(--text-muted)]\">\n        <span className=\"inline-flex items-center gap-1\">\n          <Calendar size={11} />\n          Open: {formatDateTime(trade.openTime)}\n        </span>\n      </p>\n      <div className=\"mt-3 flex items-center gap-2\">\n        <button\n          type=\"button\"\n          onClick={() => onModify(trade)}\n          className=\"inline-flex flex-1 items-center justify-center gap-1 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2 py-1.5 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n        >\n          <Pencil size={12} />\n          Modify\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => onClose(trade)}\n          className=\"inline-flex flex-1 items-center justify-center gap-1 rounded-md border border-rose-200 bg-rose-50 px-2 py-1.5 text-xs font-semibold text-rose-700 hover:bg-rose-100\"\n        >\n          <XCircle size={12} />\n          Close\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction SmallField({\n  label,\n  value,\n  valueClassName = \"\",\n}: {\n  label: string;\n  value: string;\n  valueClassName?: string;\n}) {\n  return (\n    <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-2 py-1.5\">\n      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n        {label}\n      </p>\n      <p\n        className={`mt-0.5 text-xs font-semibold text-[var(--foreground)] ${valueClassName}`}\n      >\n        {value}\n      </p>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\brokerage-commission\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\close-positions\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\close-trades\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\live\\create\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'accountOptions' logical expression could make the dependencies of useMemo Hook (at line 143) change on every render. To fix this, wrap the initialization of 'accountOptions' in its own useMemo() Hook.","line":138,"column":9,"nodeType":"VariableDeclarator","endLine":138,"endColumn":56},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":293,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":293,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8564,8567],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8564,8567],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":345,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10101,10104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10101,10104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":394,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11632,11635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11632,11635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  ArrowLeft,\n  ArrowUpDown,\n  AlertTriangle,\n  CheckCircle2,\n  Hash,\n  Layers,\n  Search,\n  Tag,\n  Target,\n  User,\n  Wallet,\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport Modal from \"@/app/admin/components/ui/Modal\";\nimport { Toast } from \"@/app/admin/components/ui/Toast\";\nimport { useLiveQuotesBySymbols } from \"@/hooks/useLiveQuotesBySymbols\";\nimport { getAccessTokenFromCookie } from \"@/services/marketSocket.service\";\nimport { useAdminUsers } from \"@/hooks/useAdminUsers\";\nimport { useAdminUserAccounts } from \"@/hooks/useAdminUserAccounts\";\nimport {\n  useTradeAdminPlaceMarketOrder,\n  useTradeAdminPlacePendingOrder,\n} from \"@/hooks/useTradeAdminOrderActions\";\nimport {\n  searchInstruments,\n  type InstrumentSearchItem,\n} from \"@/services/instrument.service\";\nimport type { AdminUser } from \"@/types/user\";\nimport type { AdminAccount } from \"@/types/account\";\nimport type { TradeOrderType, TradeSide } from \"@/services/tradeAdmin.service\";\n\nconst SEGMENTS = [\"CRYPTO\", \"FOREX\", \"COMEX\", \"US Stocks\", \"US Indices\"];\nconst MIN_VOLUME = 0.01;\n\nconst PENDING_ORDER_TYPES: Array<Exclude<TradeOrderType, \"MARKET\">> = [\n  \"BUY_LIMIT\",\n  \"SELL_LIMIT\",\n  \"BUY_STOP\",\n  \"SELL_STOP\",\n];\n\nfunction getSideFromOrderType(orderType: string): TradeSide {\n  return orderType.startsWith(\"SELL\") ? \"SELL\" : \"BUY\";\n}\n\nfunction parseNumber(value: string) {\n  const trimmed = value.trim();\n  if (!trimmed) return null;\n  const num = Number(trimmed);\n  if (!Number.isFinite(num)) return null;\n  return num;\n}\n\nexport default function CreateTradePage() {\n  const router = useRouter();\n  const [toast, setToast] = useState(\"\");\n  const [mode, setMode] = useState<\"MARKET\" | \"PENDING\">(\"MARKET\");\n  const [segment, setSegment] = useState(\"\");\n\n  const [instrumentQuery, setInstrumentQuery] = useState(\"\");\n  const [instrumentOpen, setInstrumentOpen] = useState(false);\n  const [instrumentResults, setInstrumentResults] = useState<\n    InstrumentSearchItem[]\n  >([]);\n  const [instrumentLoading, setInstrumentLoading] = useState(false);\n  const [selectedInstrument, setSelectedInstrument] = useState<\n    InstrumentSearchItem | null\n  >(null);\n  const [symbol, setSymbol] = useState(\"\");\n\n  const [userQuery, setUserQuery] = useState(\"\");\n  const [userOpen, setUserOpen] = useState(false);\n  const [selectedUser, setSelectedUser] = useState<AdminUser | null>(null);\n\n  const [accountId, setAccountId] = useState(\"\");\n\n  const [side, setSide] = useState<TradeSide>(\"BUY\");\n  const [pendingOrderType, setPendingOrderType] = useState<\n    Exclude<TradeOrderType, \"MARKET\">\n  >(\"BUY_LIMIT\");\n  const [volume, setVolume] = useState(\"\");\n  const [price, setPrice] = useState(\"\");\n  const [stopLoss, setStopLoss] = useState(\"\");\n  const [takeProfit, setTakeProfit] = useState(\"\");\n  const [formError, setFormError] = useState(\"\");\n  const [receipt, setReceipt] = useState<{\n    title: string;\n    message?: string;\n    referenceId?: string;\n    userId: string;\n    accountId: string;\n    symbol: string;\n    side: TradeSide;\n    mode: \"MARKET\" | \"PENDING\";\n    orderType?: string;\n    volume: number;\n    price?: number;\n    stopLoss?: number | null;\n    takeProfit?: number | null;\n    createdAt: string;\n    raw?: unknown;\n  } | null>(null);\n\n  const instrumentRef = useRef<HTMLDivElement | null>(null);\n  const userRef = useRef<HTMLDivElement | null>(null);\n  const token = getAccessTokenFromCookie();\n  const symbolUpper = symbol.trim().toUpperCase();\n  const liveQuotes = useLiveQuotesBySymbols(\n    token,\n    symbolUpper ? [symbolUpper] : []\n  );\n  const liveQuote = symbolUpper ? liveQuotes[symbolUpper] : undefined;\n  const effectiveSide =\n    mode === \"MARKET\" ? side : getSideFromOrderType(pendingOrderType);\n\n  const usersQuery = useAdminUsers({\n    q: userQuery.trim() ? userQuery.trim() : undefined,\n    page: 1,\n    limit: 8,\n  });\n\n  const accountsQuery = useAdminUserAccounts({\n    userId: selectedUser?._id,\n    page: 1,\n    limit: 50,\n  });\n\n  const marketMutation = useTradeAdminPlaceMarketOrder();\n  const pendingMutation = useTradeAdminPlacePendingOrder();\n\n  const isSubmitting = marketMutation.isPending || pendingMutation.isPending;\n\n  const userOptions = usersQuery.data?.data ?? [];\n  const accountOptions = accountsQuery.data?.data ?? [];\n\n  const selectedAccount = useMemo<AdminAccount | null>(() => {\n    if (!accountId) return null;\n    return accountOptions.find((acc) => acc._id === accountId) ?? null;\n  }, [accountId, accountOptions]);\n\n  useEffect(() => {\n    if (!toast) return;\n    const t = setTimeout(() => setToast(\"\"), 2500);\n    return () => clearTimeout(t);\n  }, [toast]);\n\n  const handleCloseReceipt = () => setReceipt(null);\n\n  const formatQuoteValue = (value?: string) => {\n    if (!value || value === \"--\") return \"--\";\n    const num = Number(value);\n    if (!Number.isFinite(num)) return value;\n    const digits = Math.abs(num) >= 100 ? 2 : 5;\n    return num.toLocaleString(\"en-IN\", {\n      minimumFractionDigits: digits,\n      maximumFractionDigits: digits,\n    });\n  };\n\n  const liveBid = formatQuoteValue(liveQuote?.bid);\n  const liveAsk = formatQuoteValue(liveQuote?.ask);\n  const liveBest =\n    effectiveSide === \"BUY\"\n      ? liveAsk\n      : effectiveSide === \"SELL\"\n      ? liveBid\n      : \"--\";\n\n  useEffect(() => {\n    const handler = (event: MouseEvent) => {\n      if (instrumentRef.current && !instrumentRef.current.contains(event.target as Node)) {\n        setInstrumentOpen(false);\n      }\n      if (userRef.current && !userRef.current.contains(event.target as Node)) {\n        setUserOpen(false);\n      }\n    };\n    document.addEventListener(\"mousedown\", handler, true);\n    return () => document.removeEventListener(\"mousedown\", handler, true);\n  }, []);\n\n  useEffect(() => {\n    if (!selectedUser) {\n      setAccountId(\"\");\n      return;\n    }\n    const list = accountsQuery.data?.data ?? [];\n    if (!list.length) {\n      setAccountId(\"\");\n      return;\n    }\n    if (!accountId || !list.some((acc) => acc._id === accountId)) {\n      setAccountId(list[0]._id);\n    }\n  }, [selectedUser, accountsQuery.data, accountId]);\n\n  useEffect(() => {\n    if (!instrumentQuery.trim()) {\n      setInstrumentResults([]);\n      setInstrumentLoading(false);\n      return;\n    }\n\n    const handle = setTimeout(async () => {\n      try {\n        setInstrumentLoading(true);\n        const results = await searchInstruments({\n          q: instrumentQuery.trim(),\n          segment: segment || undefined,\n          limit: 8,\n        });\n        setInstrumentResults(results);\n      } catch {\n        setInstrumentResults([]);\n      } finally {\n        setInstrumentLoading(false);\n      }\n    }, 350);\n\n    return () => clearTimeout(handle);\n  }, [instrumentQuery, segment]);\n\n  const handleSelectUser = (user: AdminUser) => {\n    setSelectedUser(user);\n    setUserQuery(`${user.name ?? \"--\"} (${user.email ?? \"--\"})`);\n    setUserOpen(false);\n  };\n\n  const handleUserChange = (value: string) => {\n    setUserQuery(value);\n    setSelectedUser(null);\n    setAccountId(\"\");\n    setUserOpen(true);\n  };\n\n  const handleSelectInstrument = (item: InstrumentSearchItem) => {\n    setSelectedInstrument(item);\n    setSymbol(item.code);\n    setInstrumentQuery(`${item.code} - ${item.name}`);\n    setInstrumentOpen(false);\n  };\n\n  const handleInstrumentChange = (value: string) => {\n    setInstrumentQuery(value);\n    setSelectedInstrument(null);\n    setSymbol(value.trim().toUpperCase());\n    setInstrumentOpen(true);\n  };\n\n  const handleSubmit = () => {\n    setFormError(\"\");\n    setReceipt(null);\n\n    if (!selectedUser) {\n      setFormError(\"Select a user first.\");\n      return;\n    }\n    if (!accountId) {\n      setFormError(\"Select an account.\");\n      return;\n    }\n    if (!symbol) {\n      setFormError(\"Select a symbol/instrument.\");\n      return;\n    }\n\n    const volumeValue = parseNumber(volume);\n    if (!volumeValue || volumeValue <= 0) {\n      setFormError(\"Enter a valid volume.\");\n      return;\n    }\n\n    if (volumeValue < MIN_VOLUME) {\n      setFormError(`Minimum volume is ${MIN_VOLUME}.`);\n      return;\n    }\n\n    const stopLossValue = parseNumber(stopLoss);\n    const takeProfitValue = parseNumber(takeProfit);\n    if (stopLossValue !== null && stopLossValue <= 0) {\n      setFormError(\"Stop Loss must be greater than 0.\");\n      return;\n    }\n    if (takeProfitValue !== null && takeProfitValue <= 0) {\n      setFormError(\"Take Profit must be greater than 0.\");\n      return;\n    }\n\n    const buildReferenceId = (resp: any) => {\n      const direct =\n        resp?.orderId ||\n        resp?.positionId ||\n        resp?.tradeId ||\n        resp?.id ||\n        resp?._id;\n      if (direct) return String(direct);\n      const nested = resp?.data;\n      if (nested && typeof nested === \"object\") {\n        return (\n          nested.orderId ||\n          nested.positionId ||\n          nested.tradeId ||\n          nested.id ||\n          nested._id\n        )?.toString();\n      }\n      return undefined;\n    };\n\n    if (mode === \"MARKET\") {\n      marketMutation.mutate(\n        {\n          accountId,\n          userId: selectedUser._id,\n          symbol: symbol.toUpperCase(),\n          side,\n          volume: volumeValue,\n          stopLoss: stopLossValue ?? null,\n          takeProfit: takeProfitValue ?? null,\n        },\n        {\n          onSuccess: (resp) => {\n            setToast(resp?.message || \"Market order placed.\");\n            setPrice(\"\");\n            setReceipt({\n              title: \"Market Order Receipt\",\n              message: resp?.message,\n              referenceId: buildReferenceId(resp?.data ?? resp),\n              userId: selectedUser._id,\n              accountId,\n              symbol: symbol.toUpperCase(),\n              side,\n              mode: \"MARKET\",\n              volume: volumeValue,\n              stopLoss: stopLossValue ?? null,\n              takeProfit: takeProfitValue ?? null,\n              createdAt: new Date().toISOString(),\n              raw: resp?.data ?? resp,\n            });\n          },\n          onError: (err: any) => {\n            const msg =\n              err?.response?.data?.message || err?.message || \"Market order failed.\";\n            setFormError(msg);\n          },\n        }\n      );\n      return;\n    }\n\n    const priceValue = parseNumber(price);\n    if (!priceValue || priceValue <= 0) {\n      setFormError(\"Enter a valid price for pending order.\");\n      return;\n    }\n\n    pendingMutation.mutate(\n      {\n        accountId,\n        userId: selectedUser._id,\n        symbol: symbol.toUpperCase(),\n        side: getSideFromOrderType(pendingOrderType),\n        orderType: pendingOrderType,\n        price: priceValue,\n        volume: volumeValue,\n        stopLoss: stopLossValue ?? null,\n        takeProfit: takeProfitValue ?? null,\n      },\n      {\n        onSuccess: (resp) => {\n          setToast(resp?.message || \"Pending order placed.\");\n          setReceipt({\n            title: \"Pending Order Receipt\",\n            message: resp?.message,\n            referenceId: buildReferenceId(resp?.data ?? resp),\n            userId: selectedUser._id,\n            accountId,\n            symbol: symbol.toUpperCase(),\n            side: getSideFromOrderType(pendingOrderType),\n            mode: \"PENDING\",\n            orderType: pendingOrderType,\n            volume: volumeValue,\n            price: priceValue,\n            stopLoss: stopLossValue ?? null,\n            takeProfit: takeProfitValue ?? null,\n            createdAt: new Date().toISOString(),\n            raw: resp?.data ?? resp,\n          });\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message || err?.message || \"Pending order failed.\";\n          setFormError(msg);\n        },\n      }\n    );\n  };\n\n  return (\n    <div className=\"p-4 sm:p-6 lg:p-8 space-y-6 max-w-6xl mx-auto\">\n      <button\n        onClick={() => router.back()}\n        className=\"inline-flex items-center gap-2 rounded-full border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold text-[var(--foreground)] shadow-sm hover:bg-[var(--hover-bg)]\"\n      >\n        <ArrowLeft size={16} /> Back\n      </button>\n\n      <div className=\"rounded-3xl border border-[var(--card-border)] bg-gradient-to-r from-[var(--card-bg)] via-[var(--card-bg)] to-sky-500/10 px-6 py-5\">\n        <h1 className=\"text-2xl font-semibold text-[var(--foreground)]\">Create Trade</h1>\n        <p className=\"mt-1 text-sm text-[var(--text-muted)]\">\n          Place market or pending trades for any user account. Editing is disabled here.\n        </p>\n      </div>\n\n      <div className=\"bg-[var(--card-bg)] border border-[var(--card-border)] rounded-3xl p-5 sm:p-6 space-y-6 shadow-sm\">\n        <div className=\"flex flex-wrap gap-3 rounded-full bg-[var(--input-bg)] border border-[var(--card-border)] p-1\">\n          {[\n            { key: \"MARKET\", label: \"Market Order\" },\n            { key: \"PENDING\", label: \"Pending Order\" },\n          ].map((tab) => (\n            <button\n              key={tab.key}\n              type=\"button\"\n              onClick={() => setMode(tab.key as \"MARKET\" | \"PENDING\")}\n              className={`flex-1 min-w-[160px] rounded-full px-4 py-2 text-sm font-semibold transition ${\n                mode === tab.key\n                  ? \"bg-[var(--primary)] text-white shadow-sm ring-1 ring-[var(--primary)]/40\"\n                  : \"text-[var(--foreground)]/80 hover:text-[var(--foreground)] hover:bg-[var(--card-bg)]\"\n              }`}\n            >\n              {tab.label}\n            </button>\n          ))}\n        </div>\n\n        <div className=\"grid gap-4 sm:gap-6 sm:grid-cols-2 lg:grid-cols-3 items-start\">\n          <div>\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <Layers size={14} className=\"text-[var(--primary)]\" />\n              Segment\n            </label>\n            <select\n              value={segment}\n              onChange={(event) => setSegment(event.target.value)}\n              className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n            >\n              <option value=\"\">All segments</option>\n              {SEGMENTS.map((seg) => (\n                <option key={seg} value={seg}>\n                  {seg}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div ref={instrumentRef} className=\"relative\">\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <Tag size={14} className=\"text-[var(--primary)]\" />\n              Search instrument\n            </label>\n            <div className=\"flex items-center gap-2 w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-xl p-3 mt-1 transition focus-within:ring-2 focus-within:ring-[var(--primary)]/20\">\n              <Search size={16} className=\"text-[var(--text-muted)]\" />\n              <input\n                value={instrumentQuery}\n                onChange={(event) => handleInstrumentChange(event.target.value)}\n                onFocus={() => setInstrumentOpen(true)}\n                placeholder=\"Type symbol or name\"\n                className=\"w-full bg-transparent outline-none text-[var(--foreground)]\"\n              />\n            </div>\n            {instrumentOpen && (instrumentQuery.trim().length > 0 || instrumentLoading) && (\n              <div className=\"absolute z-20 mt-2 w-full rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] shadow-xl\">\n                {instrumentLoading ? (\n                  <div className=\"px-3 py-2 text-sm text-[var(--text-muted)]\">Searching...</div>\n                ) : instrumentResults.length ? (\n                  instrumentResults.map((item) => (\n                    <button\n                      key={item._id}\n                      type=\"button\"\n                      onClick={() => handleSelectInstrument(item)}\n                      className=\"w-full px-3 py-2 text-left text-sm hover:bg-[var(--hover-bg)]\"\n                    >\n                      <div className=\"font-semibold\">{item.code}</div>\n                      <div className=\"text-xs text-[var(--text-muted)]\">{item.name}</div>\n                    </button>\n                  ))\n                ) : (\n                  <div className=\"px-3 py-2 text-sm text-[var(--text-muted)]\">\n                    No instruments found.\n                  </div>\n                )}\n              </div>\n            )}\n            {selectedInstrument ? (\n              <p className=\"mt-2 text-xs text-[var(--text-muted)]\">\n                Selected: {selectedInstrument.code} ({selectedInstrument.segment || \"segment\"})\n              </p>\n            ) : null}\n          </div>\n\n          <div ref={userRef} className=\"relative\">\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <User size={14} className=\"text-[var(--primary)]\" />\n              Search user\n            </label>\n            <div className=\"flex items-center gap-2 w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-xl p-3 mt-1 transition focus-within:ring-2 focus-within:ring-[var(--primary)]/20\">\n              <Search size={16} className=\"text-[var(--text-muted)]\" />\n              <input\n                value={userQuery}\n                onChange={(event) => handleUserChange(event.target.value)}\n                onFocus={() => setUserOpen(true)}\n                placeholder=\"Search by name or email\"\n                className=\"w-full bg-transparent outline-none text-[var(--foreground)]\"\n              />\n            </div>\n            {userOpen && userQuery.trim().length > 0 && (\n              <div className=\"absolute z-20 mt-2 w-full rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] shadow-xl\">\n                {usersQuery.isLoading ? (\n                  <div className=\"px-3 py-2 text-sm text-[var(--text-muted)]\">Searching...</div>\n                ) : userOptions.length ? (\n                  userOptions.map((user) => (\n                    <button\n                      key={user._id}\n                      type=\"button\"\n                      onClick={() => handleSelectUser(user)}\n                      className=\"w-full px-3 py-2 text-left text-sm hover:bg-[var(--hover-bg)]\"\n                    >\n                      <div className=\"font-semibold\">{user.name || \"--\"}</div>\n                      <div className=\"text-xs text-[var(--text-muted)]\">{user.email}</div>\n                    </button>\n                  ))\n                ) : (\n                  <div className=\"px-3 py-2 text-sm text-[var(--text-muted)]\">\n                    No users found.\n                  </div>\n                )}\n              </div>\n            )}\n            {selectedUser ? (\n              <p className=\"mt-2 text-xs text-[var(--text-muted)]\">\n                Selected user: {selectedUser._id}\n              </p>\n            ) : null}\n          </div>\n\n          <div>\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <Wallet size={14} className=\"text-[var(--primary)]\" />\n              Account\n            </label>\n            <select\n              value={accountId}\n              onChange={(event) => setAccountId(event.target.value)}\n              className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n              disabled={!selectedUser || accountsQuery.isLoading}\n            >\n              <option value=\"\">{selectedUser ? \"Select account\" : \"Select user first\"}</option>\n              {accountOptions.map((acc) => (\n                <option key={acc._id} value={acc._id}>\n                  {acc.account_number || acc._id}\n                </option>\n              ))}\n            </select>\n            {selectedAccount ? (\n              <p className=\"mt-2 text-xs text-[var(--text-muted)]\">\n                Type: {selectedAccount.account_type || \"--\"} | Plan: {selectedAccount.plan_name || \"--\"}\n              </p>\n            ) : null}\n          </div>\n\n          {mode === \"MARKET\" ? (\n            <div>\n              <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n                <ArrowUpDown size={14} className=\"text-[var(--primary)]\" />\n                Side\n              </label>\n              <select\n                value={side}\n                onChange={(event) => setSide(event.target.value as TradeSide)}\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n              >\n                <option value=\"BUY\">BUY</option>\n                <option value=\"SELL\">SELL</option>\n              </select>\n            </div>\n          ) : (\n            <div>\n              <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n                <ArrowUpDown size={14} className=\"text-[var(--primary)]\" />\n                Order Type\n              </label>\n              <select\n                value={pendingOrderType}\n                onChange={(event) =>\n                  setPendingOrderType(\n                    event.target.value as Exclude<TradeOrderType, \"MARKET\">\n                  )\n                }\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n              >\n                {PENDING_ORDER_TYPES.map((orderType) => (\n                  <option key={orderType} value={orderType}>\n                    {orderType.replace(\"_\", \" \")}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n\n          <div>\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <Hash size={14} className=\"text-[var(--primary)]\" />\n              Volume\n            </label>\n            <input\n              value={volume}\n              onChange={(event) => setVolume(event.target.value)}\n              placeholder=\"Min 0.01\"\n              type=\"number\"\n              min={MIN_VOLUME}\n              step=\"0.01\"\n              className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n            />\n            <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n              Minimum volume: {MIN_VOLUME}\n            </p>\n          </div>\n\n          {mode === \"PENDING\" ? (\n            <div>\n              <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n                <Tag size={14} className=\"text-[var(--primary)]\" />\n                Price\n              </label>\n              <input\n                value={price}\n                onChange={(event) => setPrice(event.target.value)}\n                placeholder=\"Enter pending price\"\n                type=\"number\"\n                min=\"0\"\n                step=\"0.0001\"\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n              />\n              <div className=\"mt-2 flex flex-wrap gap-2 text-[11px] font-semibold uppercase tracking-wide\">\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-emerald-500/30 bg-emerald-500/10 px-2 py-0.5 text-emerald-700\">\n                  Bid\n                  <span className=\"font-semibold text-emerald-900\">\n                    {liveBid}\n                  </span>\n                </span>\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-amber-500/30 bg-amber-500/10 px-2 py-0.5 text-amber-700\">\n                  Ask\n                  <span className=\"font-semibold text-amber-900\">\n                    {liveAsk}\n                  </span>\n                </span>\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-sky-500/30 bg-sky-500/10 px-2 py-0.5 text-sky-700\">\n                  Best {effectiveSide}\n                  <span className=\"font-semibold text-sky-900\">\n                    {liveBest}\n                  </span>\n                </span>\n              </div>\n            </div>\n          ) : (\n            <div>\n              <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n                <Tag size={14} className=\"text-[var(--primary)]\" />\n                Price\n              </label>\n              <div className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--text-muted)]\">\n                Market price (auto)\n              </div>\n              <div className=\"mt-2 flex flex-wrap gap-2 text-[11px] font-semibold uppercase tracking-wide\">\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-emerald-500/30 bg-emerald-500/10 px-2 py-0.5 text-emerald-700\">\n                  Bid\n                  <span className=\"font-semibold text-emerald-900\">\n                    {liveBid}\n                  </span>\n                </span>\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-amber-500/30 bg-amber-500/10 px-2 py-0.5 text-amber-700\">\n                  Ask\n                  <span className=\"font-semibold text-amber-900\">\n                    {liveAsk}\n                  </span>\n                </span>\n                <span className=\"inline-flex items-center gap-1 rounded-full border border-sky-500/30 bg-sky-500/10 px-2 py-0.5 text-sky-700\">\n                  Best {effectiveSide}\n                  <span className=\"font-semibold text-sky-900\">\n                    {liveBest}\n                  </span>\n                </span>\n              </div>\n            </div>\n          )}\n\n          <div>\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <AlertTriangle size={14} className=\"text-rose-500\" />\n              Stop Loss (optional)\n            </label>\n            <input\n              value={stopLoss}\n              onChange={(event) => setStopLoss(event.target.value)}\n              placeholder=\"Stop loss\"\n              type=\"number\"\n              min=\"0\"\n              step=\"0.0001\"\n              className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n            />\n          </div>\n\n          <div>\n            <label className=\"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n              <Target size={14} className=\"text-emerald-500\" />\n              Take Profit (optional)\n            </label>\n            <input\n              value={takeProfit}\n              onChange={(event) => setTakeProfit(event.target.value)}\n              placeholder=\"Take profit\"\n              type=\"number\"\n              min=\"0\"\n              step=\"0.0001\"\n              className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-md p-3 mt-1 text-[var(--foreground)]\"\n            />\n          </div>\n        </div>\n\n        {formError ? (\n          <div className=\"rounded-md border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-sm text-rose-700\">\n            {formError}\n          </div>\n        ) : null}\n\n        <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-3 text-xs text-[var(--text-muted)]\">\n          <p className=\"text-[11px] font-semibold uppercase tracking-wide text-[var(--text-muted)]\">\n            Validation Rules\n          </p>\n          <ul className=\"mt-2 list-disc pl-4 space-y-1\">\n            <li>User, Account, and Symbol are required.</li>\n            <li>Volume must be at least {MIN_VOLUME}.</li>\n            <li>Stop Loss and Take Profit are optional but must be &gt; 0 if provided.</li>\n            {mode === \"PENDING\" ? (\n              <li>Pending price is required and must be &gt; 0.</li>\n            ) : (\n              <li>Market orders use current market price (no price input).</li>\n            )}\n            <li>\n              Order-type price rules (checked server-side): BUY_LIMIT below market, BUY_STOP above market, SELL_LIMIT above market, SELL_STOP below market.\n            </li>\n          </ul>\n        </div>\n\n        <div className=\"flex justify-end\">\n          <button\n            onClick={handleSubmit}\n            disabled={isSubmitting}\n            className=\"w-full sm:w-auto bg-[var(--primary)] text-black px-8 py-2 rounded-full font-semibold hover:opacity-90 transition disabled:opacity-60\"\n          >\n            {isSubmitting ? \"Submitting...\" : \"Submit\"}\n          </button>\n        </div>\n      </div>\n\n      <Modal\n        title=\"Trade Receipt\"\n        open={Boolean(receipt)}\n        onClose={handleCloseReceipt}\n        size=\"lg\"\n        footer={\n          receipt ? (\n            <div className=\"flex flex-wrap items-center justify-between gap-3\">\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                Confirm to continue.\n              </p>\n              <div className=\"flex items-center gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleCloseReceipt}\n                  className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n                >\n                  Close\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() =>\n                    router.push(\n                      `/admin/users/users/view/${receipt.userId}?tab=active-trades`\n                    )\n                  }\n                  className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-xs font-semibold text-black hover:opacity-90\"\n                >\n                  OK, Continue\n                </button>\n              </div>\n            </div>\n          ) : null\n        }\n      >\n        {receipt ? (\n          <div className=\"rounded-2xl border border-[var(--card-border)] bg-gradient-to-br from-[var(--card-bg)] via-[var(--card-bg)] to-emerald-500/10 p-5\">\n            <div className=\"flex flex-wrap items-start justify-between gap-4\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-500/10 text-emerald-600\">\n                  <CheckCircle2 size={18} />\n                </div>\n                <div>\n                  <p className=\"text-xs uppercase tracking-wide text-[var(--text-muted)]\">\n                    Receipt\n                  </p>\n                  <h2 className=\"text-lg font-semibold text-[var(--foreground)]\">\n                    {receipt.title}\n                  </h2>\n                  {receipt.message ? (\n                    <p className=\"text-sm text-[var(--text-muted)]\">\n                      {receipt.message}\n                    </p>\n                  ) : null}\n                  <div className=\"mt-2 flex flex-wrap gap-2 text-[11px] font-semibold uppercase tracking-wide\">\n                    <span className=\"rounded-full border border-sky-500/30 bg-sky-500/10 px-2 py-0.5 text-sky-700\">\n                      {receipt.mode === \"PENDING\" ? \"Pending\" : \"Market\"}\n                    </span>\n                    <span\n                      className={`rounded-full border px-2 py-0.5 ${\n                        receipt.side === \"SELL\"\n                          ? \"border-rose-500/40 bg-rose-500/10 text-rose-700\"\n                          : \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n                      }`}\n                    >\n                      {receipt.side}\n                    </span>\n                    <span className=\"rounded-full border border-[var(--card-border)] bg-[var(--input-bg)] px-2 py-0.5 text-[var(--text-muted)]\">\n                      {receipt.orderType ?? \"MARKET\"}\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <div className=\"text-xs text-[var(--text-muted)]\">\n                {new Date(receipt.createdAt).toLocaleString()}\n              </div>\n            </div>\n\n            <div className=\"mt-4 grid gap-3 text-sm sm:grid-cols-2\">\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Symbol</p>\n                <p className=\"mt-1 text-lg font-semibold\">{receipt.symbol}</p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Volume</p>\n                <p className=\"mt-1 text-lg font-semibold\">{receipt.volume}</p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Price</p>\n                <p className=\"mt-1 text-lg font-semibold\">\n                  {receipt.price ?? \"Market\"}\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Reference ID</p>\n                <p className=\"mt-1 font-mono text-xs text-[var(--foreground)]\">\n                  {receipt.referenceId ?? \"--\"}\n                </p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Stop Loss</p>\n                <p className=\"mt-1 font-semibold\">{receipt.stopLoss ?? \"--\"}</p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-4\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Take Profit</p>\n                <p className=\"mt-1 font-semibold\">{receipt.takeProfit ?? \"--\"}</p>\n              </div>\n              <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-4 sm:col-span-2\">\n                <p className=\"text-xs text-[var(--text-muted)]\">Account</p>\n                <p className=\"mt-1 font-mono text-xs text-[var(--foreground)]\">\n                  {receipt.accountId}\n                </p>\n                <p className=\"mt-2 text-xs text-[var(--text-muted)]\">\n                  User: {receipt.userId}\n                </p>\n              </div>\n            </div>\n          </div>\n        ) : null}\n      </Modal>\n\n      {toast && <Toast message={toast} />}\n    </div>\n  );\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\pending-orders\\create\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\trades\\pending-orders\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\transactions\\all-deposit\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":537,"column":23,"nodeType":"JSXOpeningElement","endLine":541,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useCallback } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  Search,\n  Eye,\n  AlertCircle,\n  X,\n  DollarSign,\n  Plus,\n  FileText,\n  User,\n  Wallet,\n  UserCheck,\n  Pencil,\n  Check,\n  Bitcoin,\n  Banknote,\n  Smartphone,\n  HandCoins,\n} from \"lucide-react\";\nimport { useAdminDeposits } from \"@/hooks/deposit/useAdminDeposits\";\r\nimport { useApproveDeposit, useRejectDeposit } from \"@/hooks/deposit/useDepositActions\";\r\nimport Pagination from \"../../components/ui/pagination\";\nimport { useEditDepositAmount } from \"@/hooks/deposit/useEditDepositAmount\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport toast from \"react-hot-toast\";\n\ntype DepositRow = {\n  _id: string;\n  amount?: number;\n  method?: string;\n  status?: \"PENDING\" | \"APPROVED\" | \"REJECTED\" | string;\n  user?: {\n    _id?: string;\n    id?: string;\n    name?: string;\n    email?: string;\n  };\n  account?: {\n    account_number?: string;\n    plan_name?: string;\n  };\n  proof?: {\n    image_url?: string;\n  };\n};\n\nconst getErrorMessage = (error: unknown, fallback: string) => {\n  if (typeof error !== \"object\" || error === null) return fallback;\n\n  const responseMessage = (error as {\n    response?: { data?: { message?: string; error?: string } };\n  }).response?.data;\n\n  if (typeof responseMessage?.message === \"string\" && responseMessage.message.trim()) {\n    return responseMessage.message;\n  }\n\n  if (typeof responseMessage?.error === \"string\" && responseMessage.error.trim()) {\n    return responseMessage.error;\n  }\n\n  const baseMessage = (error as { message?: string }).message;\n  if (typeof baseMessage === \"string\" && baseMessage.trim()) {\n    return baseMessage;\n  }\n\n  return fallback;\n};\n\nexport default function AllDeposit() {\n  const router = useRouter();\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(10);\r\n  const [status, setStatus] = useState<\"PENDING\" | \"APPROVED\" | \"REJECTED\" | undefined>();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [selected, setSelected] = useState<DepositRow | null>(null);\n  const [rejectReason, setRejectReason] = useState(\"\");\r\n  const [editOpen, setEditOpen] = useState(false);\r\n  const [editAmount, setEditAmount] = useState<number>(0);\r\n  const editMutation = useEditDepositAmount();\r\n  const { data, isLoading, refetch } = useAdminDeposits({\r\n    page,\r\n    limit,\r\n    status,\r\n    // search,\r\n  });\r\n\r\n  const approve = useApproveDeposit();\r\n  const reject = useRejectDeposit();\r\n\r\n  const deposits: DepositRow[] = data?.data ?? [];\n  const totalPages = Math.ceil((data?.total || 0) / limit);\r\n\r\n  const handleStatusFilter = useCallback((newStatus: typeof status) => {\r\n    setStatus(newStatus);\r\n    setPage(1);\r\n  }, []);\r\n\r\n  const handlePageChange = useCallback((newPage: number) => {\r\n    setPage(newPage);\r\n  }, []);\r\n\r\n  const handleLimitChange = useCallback((newLimit: number) => {\r\n    setLimit(newLimit);\r\n    setPage(1);\r\n  }, []);\r\n\r\n  const handleApprove = useCallback(async () => {\n    if (!selected) return;\n\n    try {\n      await approve.mutateAsync(selected._id);\n      toast.success(\"Deposit approved successfully\");\n      setSelected(null);\n      refetch();\n    } catch (error: unknown) {\n      toast.error(getErrorMessage(error, \"Unable to approve deposit\"));\n    }\n  }, [selected, approve, refetch]);\n\n  const handleReject = useCallback(async () => {\n    if (!selected || !rejectReason.trim()) return;\n\n    try {\n      await reject.mutateAsync({\n        id: selected._id,\n        reason: rejectReason,\n      });\n      toast.success(\"Deposit rejected successfully\");\n      setSelected(null);\n      setRejectReason(\"\");\n      refetch();\n    } catch (error: unknown) {\n      toast.error(getErrorMessage(error, \"Unable to reject deposit\"));\n    }\n  }, [selected, rejectReason, reject, refetch]);\n\r\n  const closeModal = useCallback(() => {\n    setSelected(null);\n    setRejectReason(\"\");\n  }, []);\n\n  const getUserId = useCallback((deposit: DepositRow) => {\n    return deposit.user?._id ?? deposit.user?.id ?? \"\";\n  }, []);\n\n  const goToUserView = useCallback((deposit: DepositRow) => {\n    const userId = getUserId(deposit);\n    if (!userId) return;\n\n    const params = new URLSearchParams({\n      name: deposit.user?.name ?? \"\",\n      email: deposit.user?.email ?? \"\",\n    });\n\n    router.push(`/admin/users/users/view/${userId}?${params.toString()}`);\n  }, [getUserId, router]);\n\n  const getMethodIcon = useCallback((method?: string) => {\n    const normalizedMethod = (method ?? \"\").toUpperCase();\n\n    if (normalizedMethod === \"CRYPTO\") return <Bitcoin size={12} />;\n    if (normalizedMethod === \"BANK\") return <Banknote size={12} />;\n    if (normalizedMethod === \"UPI\") return <Smartphone size={12} />;\n    if (normalizedMethod === \"MANUAL\") return <HandCoins size={12} />;\n\n    return <FileText size={12} />;\n  }, []);\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"container-pad space-y-8 min-h-screen no-shadow\"\r\n    >\r\n      {/* HEADER */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-3\">\r\n        <div className=\"min-w-0\">\r\n          <h1 className=\"inline-flex items-center gap-2 text-base sm:text-3xl font-bold bg-gradient-to-r from-[var(--primary)] to-[var(--primary-dark)] bg-clip-text text-transparent\">\r\n            <DollarSign size={18} className=\"sm:h-7 sm:w-7 text-[var(--primary)]\" />\r\n            Deposits Management\r\n          </h1>\r\n          <p className=\"text-[10px] sm:text-base text-[var(--text-muted)] mt-1\">\r\n            Manage and review all deposit requests\r\n          </p>\r\n        </div>\r\n        <Link\r\n          href=\"/admin/users/users-funds/create\"\r\n          className=\"inline-flex w-fit self-start shrink-0 items-center justify-center rounded-lg px-2.5 py-1.5 sm:px-4 sm:py-2 text-[10px] sm:text-sm font-semibold text-white whitespace-nowrap bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700\"\r\n        >\r\n          <Plus size={14} />\r\n          Deposit\r\n        </Link>\r\n      </div>\r\n\r\n      {/* FILTERS & SEARCH */}\r\n      <div className=\"card-elevated shadow-none flex flex-col lg:flex-row gap-4 !p-0 sm:!p-6\">\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center gap-3 flex-1\">\r\n          <div className=\"relative flex-1 w-full sm:max-w-md\">\r\n            <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)] w-4 h-4\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search deposits...\"\r\n              value={search}\r\n              onChange={(e) => setSearch(e.target.value)}\r\n              className=\"input w-full pl-10 pr-4\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center flex-nowrap justify-between gap-1 w-full rounded-full bg-[var(--hover-bg)] p-0.5 sm:w-auto sm:flex-wrap sm:justify-start sm:gap-2 sm:p-1.5\">\r\n          <button\n            onClick={() => handleStatusFilter(undefined)}\n            aria-label=\"All deposits\"\n            className={`whitespace-nowrap px-2.5 py-1 text-[10px] font-semibold rounded-lg transition-all sm:px-4 sm:py-2 sm:text-sm ${\n              !status\n                ? \"bg-[var(--primary)] text-white shadow-none\"\n                : \"text-[var(--text-muted)] hover:bg-white/70\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-1.5\">\n              <FileText size={12} />\n              <span className=\"hidden sm:inline\">All</span>\n            </span>\n          </button>\n          <button\n            onClick={() => handleStatusFilter(\"PENDING\")}\n            aria-label=\"Pending deposits\"\n            className={`whitespace-nowrap px-2.5 py-1 text-[10px] font-semibold rounded-lg transition-all sm:px-4 sm:py-2 sm:text-sm ${\n              status === \"PENDING\"\n                ? \"bg-[var(--accent)]/20 text-[var(--accent)] border border-[color-mix(in_srgb,var(--accent)_40%,transparent)]\"\n                : \"text-[var(--text-muted)] hover:bg-white/70\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-1.5\">\n              <AlertCircle size={12} />\n              <span className=\"hidden sm:inline\">Pending</span>\n            </span>\n          </button>\n          <button\n            onClick={() => handleStatusFilter(\"APPROVED\")}\n            aria-label=\"Approved deposits\"\n            className={`whitespace-nowrap px-2.5 py-1 text-[10px] font-semibold rounded-lg transition-all sm:px-4 sm:py-2 sm:text-sm ${\n              status === \"APPROVED\"\n                ? \"bg-[var(--success)]/15 text-[var(--success)] border border-[color-mix(in_srgb,var(--success)_35%,transparent)]\"\n                : \"text-[var(--text-muted)] hover:bg-white/70\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-1.5\">\n              <UserCheck size={12} />\n              <span className=\"hidden sm:inline\">Approved</span>\n            </span>\n          </button>\n          <button\n            onClick={() => handleStatusFilter(\"REJECTED\")}\n            aria-label=\"Rejected deposits\"\n            className={`whitespace-nowrap px-2.5 py-1 text-[10px] font-semibold rounded-lg transition-all sm:px-4 sm:py-2 sm:text-sm ${\n              status === \"REJECTED\"\n                ? \"bg-[var(--danger)]/15 text-[var(--danger)] border border-[color-mix(in_srgb,var(--danger)_35%,transparent)]\"\n                : \"text-[var(--text-muted)] hover:bg-white/70\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-1.5\">\n              <X size={12} />\n              <span className=\"hidden sm:inline\">Rejected</span>\n            </span>\n          </button>\n        </div>\r\n      </div>\r\n\r\n      {/* MAIN TABLE */}\r\n      <div className=\"card-elevated shadow-none\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"table w-full text-[11px] sm:text-[13px]\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"font-semibold text-[var(--foreground)]\">\r\n                  <span className=\"inline-flex items-center gap-1.5\">\r\n                    <User size={13} />\r\n                    User\r\n                  </span>\r\n                </th>\r\n                <th className=\"font-semibold text-[var(--foreground)]\">\r\n                  <span className=\"inline-flex items-center gap-1.5\">\r\n                    <Wallet size={13} />\r\n                    Account\r\n                  </span>\r\n                </th>\r\n                <th className=\"font-semibold text-[var(--foreground)]\">\r\n                  <span className=\"inline-flex items-center gap-1.5\">\r\n                    <DollarSign size={13} />\r\n                    Amount\r\n                  </span>\r\n                </th>\r\n                <th className=\"font-semibold text-[var(--foreground)] method-status-head\">\n                  <span className=\"inline-flex items-center gap-1.5\">\n                    <FileText size={13} />\n                    Method\n                  </span>\n                </th>\n                <th className=\"font-semibold text-[var(--foreground)] method-status-head\">\n                  <span className=\"inline-flex items-center gap-1.5\">\n                    <UserCheck size={13} />\n                    Status\n                  </span>\n                </th>\n                <th className=\"font-semibold text-[var(--foreground)]\">\n                  <span className=\"inline-flex items-center gap-1.5\">\r\n                    <Pencil size={13} />\r\n                    Actions\r\n                  </span>\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <AnimatePresence>\r\n                {isLoading ? (\r\n                  <tr>\r\n                    <td colSpan={6} className=\"py-12 text-center\">\r\n                      <div className=\"flex items-center justify-center gap-2 text-[var(--text-muted)]\">\r\n                        <div className=\"w-5 h-5 border-2 border-[var(--primary)] border-t-transparent rounded-full animate-spin\" />\r\n                        Loading deposits...\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ) : deposits.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={6} className=\"py-16 text-center\">\r\n                      <div className=\"text-[var(--text-muted)] space-y-2\">\r\n                        <Search className=\"w-12 h-12 mx-auto opacity-50\" />\r\n                        <p>No deposits found</p>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ) : (\n                  deposits.map((d: DepositRow, index: number) => {\n                    const hasUser = Boolean(getUserId(d));\n\n                    return (\n                    <motion.tr\n                      key={d._id}\n                      initial={{ opacity: 0, x: 20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: index * 0.05 }}\n                      className={`group transition-colors duration-200 ${\n                        hasUser ? \"cursor-pointer hover:!bg-[var(--hover-bg)]\" : \"\"\n                      }`}\n                      onClick={() => hasUser && goToUserView(d)}\n                    >\n                      {/* USER */}\n                      <td>\n                        <div className=\"font-medium text-[var(--foreground)] group-hover:text-[var(--primary)]\">\r\n                          {d.user?.name ?? \"--\"}\r\n                        </div>\r\n\r\n                        <div className=\"text-[10px] sm:text-xs text-[var(--text-muted)]\">\n                          {d.user?.email ?? \"--\"}\n                        </div>\n\r\n                      </td>\r\n\r\n                      {/* ACCOUNT */}\r\n                      <td>\r\n                        <div className=\"font-mono text-[11px] sm:text-sm bg-[var(--input-bg)] px-2 py-1 rounded\">\r\n                          {d.account?.account_number ?? \"--\"}\r\n                        </div>\r\n\r\n                        <div className=\"text-[10px] sm:text-xs text-[var(--text-muted)] mt-1 capitalize\">\r\n                          {d.account?.plan_name ?? \"--\"}\r\n                        </div>\r\n\r\n                      </td>\r\n\r\n                      {/* AMOUNT */}\r\n                      <td>\r\n                        <div className=\"font-bold bg-gradient-to-r from-green-500 to-emerald-600 bg-clip-text text-transparent\">\r\n                          ${d.amount?.toLocaleString()}\r\n                        </div>\r\n                      </td>\r\n\r\n                      {/* METHOD */}\n                      <td>\n                        <span className=\"pill method-status-pill bg-gradient-to-r from-blue-500/10 to-blue-600/10 text-blue-700 dark:text-blue-400 border-blue-200/50 dark:border-blue-800/50\">\n                          <span className=\"inline-flex items-center gap-1.5\">\n                            {getMethodIcon(d.method)}\n                            {d.method ?? \"--\"}\n                          </span>\n                        </span>\n                      </td>\n\r\n                      {/* STATUS */}\r\n                      <td>\r\n                        <span\n                          className={`pill method-status-pill !rounded-md font-semibold ${d.status === \"APPROVED\"\n                            ? \"pill-success\"\n                            : d.status === \"REJECTED\"\n                              ? \"pill-danger\"\n                              : \"pill-accent\"\n                            }`}\n                        >\r\n                          {d.status}\r\n                        </span>\r\n                      </td>\r\n\r\n                      {/* ACTIONS */}\n                      <td className=\"text-left\">\n                        <div className=\"flex items-center justify-start gap-2\">\n                        <button\n                          type=\"button\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setSelected(d);\n                          }}\n                          className=\"btn p-2\"\n                        >\n                          <Eye size={16} />\n                        </button>\n\n                        {d.status === \"PENDING\" && (\n                          <button\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setSelected(d);\n                              setEditAmount(d.amount ?? 0);\n                              setEditOpen(true);\n                            }}\n                            className=\"p-2 text-[var(--primary)]\"\n                          >\r\n                            <Pencil size={14} />\r\n                          </button>\r\n                        )}\n                        </div>\n                      </td>\n                    </motion.tr>\n                    );\n                  })\n                )}\n              </AnimatePresence>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ADVANCED PAGINATION */}\r\n      <Pagination\r\n        page={page}\r\n        totalPages={totalPages}\r\n        limit={limit}\r\n        onPageChange={handlePageChange}\r\n        onLimitChange={handleLimitChange}\r\n      />\r\n\r\n      {/* MODAL */}\r\n      <AnimatePresence>\n        {selected && !editOpen && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 z-50 overflow-y-auto bg-black/60 backdrop-blur-sm p-3 sm:p-6\"\n            onClick={closeModal}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0, y: 20 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.9, opacity: 0, y: 20 }}\n              className=\"card-elevated shadow-none !p-0 w-full max-w-2xl mx-auto my-3 sm:my-6 overflow-hidden\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <div className=\"max-h-[calc(100vh-1.5rem)] sm:max-h-[88vh] overflow-y-auto\">\n                {/* MODAL HEADER */}\n                <div className=\"sticky top-0 z-10 flex items-center justify-between px-4 py-3 sm:px-6 sm:py-4 border-b border-[var(--card-border)] bg-[var(--card-bg)]/95 backdrop-blur\">\n                  <h3 className=\"inline-flex items-center gap-2 text-base sm:text-xl font-bold text-[var(--foreground)]\">\n                    <DollarSign size={18} />\n                    Deposit Details\n                  </h3>\n                  <motion.button\n                    whileHover={{ scale: 1.08 }}\n                    whileTap={{ scale: 0.95 }}\n                    onClick={closeModal}\n                    className=\"p-1.5 rounded-lg hover:bg-[var(--hover-bg)]\"\n                  >\n                    <X size={18} />\n                  </motion.button>\n                </div>\n\n                <div className=\"p-4 sm:p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n                      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">User</p>\n                      <p className=\"text-sm font-semibold text-[var(--foreground)]\">{selected.user?.name ?? \"--\"}</p>\n                      <p className=\"text-xs text-[var(--text-muted)]\">{selected.user?.email ?? \"--\"}</p>\n                    </div>\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n                      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">Account</p>\n                      <p className=\"text-sm font-semibold text-[var(--foreground)]\">{selected.account?.account_number ?? \"--\"}</p>\n                      <p className=\"text-xs text-[var(--text-muted)] capitalize\">{selected.account?.plan_name ?? \"--\"}</p>\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n                      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">Amount</p>\n                      <p className=\"text-base font-bold text-emerald-600\">${selected.amount?.toLocaleString() ?? \"--\"}</p>\n                    </div>\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n                      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">Method</p>\n                      <span className=\"pill method-status-pill mt-1 inline-flex items-center gap-1.5 bg-gradient-to-r from-blue-500/10 to-blue-600/10 text-blue-700 dark:text-blue-400 border-blue-200/50 dark:border-blue-800/50\">\n                        {getMethodIcon(selected.method)}\n                        {selected.method ?? \"--\"}\n                      </span>\n                    </div>\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2\">\n                      <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">Status</p>\n                      <span\n                        className={`pill method-status-pill !rounded-md mt-1 inline-flex items-center font-semibold ${selected.status === \"APPROVED\"\n                          ? \"pill-success\"\n                          : selected.status === \"REJECTED\"\n                            ? \"pill-danger\"\n                            : \"pill-accent\"\n                          }`}\n                      >\n                        {selected.status ?? \"--\"}\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* IMAGE PROOF */}\n                  {selected.proof?.image_url && (\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n                      <p className=\"text-xs font-medium text-[var(--text-muted)] mb-2\">Proof</p>\n                      <img\n                        src={selected.proof.image_url}\n                        alt=\"Deposit proof\"\n                        className=\"w-full h-64 object-contain rounded-xl bg-[var(--card-bg)]\"\n                      />\n                    </div>\n                  )}\n\n                  {/* ACTIONS */}\n                  {selected.status === \"PENDING\" && (\n                    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--input-bg)] p-3 sm:p-4 space-y-3\">\n                      <motion.button\n                        whileHover={{ scale: 1.01 }}\n                        whileTap={{ scale: 0.99 }}\n                        onClick={handleApprove}\n                        disabled={approve.isPending}\n                        className=\"btn btn-primary w-full h-11 text-sm sm:text-base\"\n                      >\n                        {approve.isPending ? (\n                          <>\n                            <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2\" />\n                            Approving...\n                          </>\n                        ) : (\n                          <>\n                            <Check size={16} />\n                            Approve Deposit\n                          </>\n                        )}\n                      </motion.button>\n\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-[var(--foreground)] block\">\n                          Reject Reason (Required)\n                        </label>\n                        <div className=\"relative\">\n                          <textarea\n                            placeholder=\"Enter reason for rejection...\"\n                            value={rejectReason}\n                            onChange={(e) => setRejectReason(e.target.value)}\n                            className=\"input resize-none w-full h-24 pr-10\"\n                            rows={4}\n                          />\n                          {rejectReason.trim().length === 0 && (\n                            <AlertCircle className=\"absolute right-3 top-1/2 -translate-y-1/2 text-orange-500 w-4 h-4\" />\n                          )}\n                        </div>\n                      </div>\n\n                      <motion.button\n                        whileHover={{ scale: 1.01 }}\n                        whileTap={{ scale: 0.99 }}\n                        onClick={handleReject}\n                        disabled={rejectReason.trim().length === 0 || reject.isPending}\n                        className=\"btn w-full h-11 text-sm sm:text-base bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {reject.isPending ? (\n                          <>\n                            <div className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2\" />\n                            Rejecting...\n                          </>\n                        ) : (\n                          <>\n                            <X size={16} />\n                            Reject Deposit\n                          </>\n                        )}\n                      </motion.button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      {/* EDIT MODAL */}\r\n      {editOpen && selected && (\r\n        <motion.div\r\n          className=\"fixed inset-0 z-[60] flex items-center justify-center bg-black/60\"\r\n          onClick={() => setEditOpen(false)}\r\n        >\r\n          <motion.div\r\n            className=\"card-elevated shadow-none w-full max-w-md !p-0\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <h3 className=\"inline-flex items-center gap-2 text-lg font-semibold mb-4\">\r\n              <Pencil size={18} />\r\n              Edit Deposit Amount\r\n            </h3>\r\n\r\n            <input\r\n              type=\"number\"\r\n              value={editAmount}\r\n              onChange={(e) => setEditAmount(Number(e.target.value))}\r\n              placeholder=\"Enter new deposit amount\"\r\n              className=\"input w-full mb-6\"\r\n            />\r\n\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={() => setEditOpen(false)}\r\n                className=\"btn btn-ghost flex-1\"\r\n              >\r\n                <X size={16} />\r\n                Cancel\r\n              </button>\r\n\r\n              <button\r\n                onClick={async () => {\r\n                  await editMutation.mutateAsync({\r\n                    id: selected._id,\r\n                    newAmount: editAmount,\r\n                  });\r\n                  setEditOpen(false);\r\n                  setSelected(null);\r\n\r\n                  refetch();\r\n                }}\r\n                className=\"btn btn-primary flex-1\"\r\n              >\r\n                <Check size={16} />\r\n                Save\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        </motion.div>\r\n      )}\n      <style jsx>{`\n        @media (max-width: 640px) {\n          .method-status-head {\n            font-size: 9px !important;\n          }\n          .method-status-pill {\n            font-size: 8px !important;\n            padding: 4px 7px !important;\n            line-height: 1 !important;\n          }\n        }\n      `}</style>\n    </motion.div>\n  );\n}\n\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\transactions\\bank-details\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\transactions\\withdraw-request\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\users\\users-funds\\create\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\users\\users-funds\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'rows' logical expression could make the dependencies of useMemo Hook (at line 136) change on every render. To fix this, wrap the initialization of 'rows' in its own useMemo() Hook.","line":109,"column":9,"nodeType":"VariableDeclarator","endLine":109,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"ï»¿\"use client\";\n\nimport { useMemo, useState, type ReactNode } from \"react\";\nimport {\n  Download,\n  Plus,\n  SlidersHorizontal,\n  User,\n  Wallet,\n  Hash,\n  Coins,\n  ShieldCheck,\n  MailCheck,\n  Users,\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport GlobalLoader from \"@/app/admin/components/ui/GlobalLoader\";\nimport Pagination from \"@/app/admin/components/ui/pagination\";\nimport { useAdminUserFunds } from \"@/hooks/useAdminUserFunds\";\nimport type { TradeAdminUserFundsItem } from \"@/services/userFunds.service\";\n\ntype FundsFilters = {\n  q: string;\n  userId: string;\n  userType: \"\" | \"USER\" | \"ADMIN\";\n  isMailVerified: \"\" | \"true\" | \"false\";\n  kycStatus: \"\" | \"NOT_STARTED\" | \"PENDING\" | \"VERIFIED\" | \"REJECTED\";\n  accountType: \"\" | \"demo\" | \"live\";\n  accountStatus: \"\" | \"active\" | \"disabled\";\n  currency: string;\n  sortBy: \"\" | \"createdAt\" | \"updatedAt\" | \"name\" | \"email\";\n  sortDir: \"asc\" | \"desc\";\n};\n\ntype FundsSummary = {\n  accounts: number;\n  balance: number;\n  holdBalance: number;\n  freeBalance: number;\n  equity: number;\n};\n\nfunction getDefaultFilters(): FundsFilters {\n  return {\n    q: \"\",\n    userId: \"\",\n    userType: \"\",\n    isMailVerified: \"\",\n    kycStatus: \"\",\n    accountType: \"\",\n    accountStatus: \"\",\n    currency: \"\",\n    sortBy: \"createdAt\",\n    sortDir: \"desc\",\n  };\n}\n\nfunction formatNumber(value?: number, digits = 2) {\n  if (value === undefined || value === null || Number.isNaN(value)) return \"--\";\n  return value.toLocaleString(\"en-IN\", {\n    minimumFractionDigits: digits,\n    maximumFractionDigits: digits,\n  });\n}\n\nfunction getFundsValue(\n  row: TradeAdminUserFundsItem,\n  key:\n    | \"accountsCount\"\n    | \"totalBalance\"\n    | \"totalHoldBalance\"\n    | \"totalFreeBalance\"\n    | \"totalEquity\"\n) {\n  const nested = row.funds?.[key];\n  if (nested !== undefined && nested !== null) return nested;\n  const flat = (row as Record<string, unknown>)[key];\n  if (typeof flat === \"number\") return flat;\n  return undefined;\n}\n\nexport default function UserFundsPage() {\n  const router = useRouter();\n\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(20);\n\n  const [draftFilters, setDraftFilters] = useState<FundsFilters>(\n    getDefaultFilters\n  );\n  const [filters, setFilters] = useState<FundsFilters>(getDefaultFilters);\n\n  const fundsQuery = useAdminUserFunds({\n    page,\n    limit,\n    q: filters.q || undefined,\n    userId: filters.userId || undefined,\n    userType: filters.userType || undefined,\n    isMailVerified: filters.isMailVerified || undefined,\n    kycStatus: filters.kycStatus || undefined,\n    accountType: filters.accountType || undefined,\n    accountStatus: filters.accountStatus || undefined,\n    currency: filters.currency || undefined,\n    sortBy: filters.sortBy || undefined,\n    sortDir: filters.sortDir || undefined,\n  });\n\n  const apiData = fundsQuery.data;\n  const rows = apiData?.data ?? [];\n  const rowsForCsv = rows;\n  const pagination = apiData?.pagination;\n  const total = pagination?.total ?? rows.length;\n  const totalPages =\n    pagination?.totalPages ?? Math.max(1, Math.ceil(total / Math.max(limit, 1)));\n\n  const summary = useMemo(\n    () =>\n      rows.reduce<FundsSummary>(\n        (acc, row) => ({\n          accounts: acc.accounts + (Number(getFundsValue(row, \"accountsCount\")) || 0),\n          balance: acc.balance + (Number(getFundsValue(row, \"totalBalance\")) || 0),\n          holdBalance:\n            acc.holdBalance + (Number(getFundsValue(row, \"totalHoldBalance\")) || 0),\n          freeBalance:\n            acc.freeBalance + (Number(getFundsValue(row, \"totalFreeBalance\")) || 0),\n          equity: acc.equity + (Number(getFundsValue(row, \"totalEquity\")) || 0),\n        }),\n        {\n          accounts: 0,\n          balance: 0,\n          holdBalance: 0,\n          freeBalance: 0,\n          equity: 0,\n        }\n      ),\n    [rows]\n  );\n\n  const metrics = useMemo(\n    () => [\n      { label: \"Users\", value: String(total) },\n      { label: \"Accounts\", value: formatNumber(summary.accounts, 0) },\n      { label: \"Total Balance\", value: formatNumber(summary.balance) },\n      { label: \"Hold Balance\", value: formatNumber(summary.holdBalance) },\n      { label: \"Free Balance\", value: formatNumber(summary.freeBalance) },\n      { label: \"Total Equity\", value: formatNumber(summary.equity) },\n    ],\n    [summary, total]\n  );\n\n  const applyFilters = () => {\n    setFilters({\n      ...draftFilters,\n      q: draftFilters.q.trim(),\n      userId: draftFilters.userId.trim(),\n      currency: draftFilters.currency.trim().toUpperCase(),\n    });\n    setPage(1);\n  };\n\n  const resetFilters = () => {\n    const next = getDefaultFilters();\n    setDraftFilters(next);\n    setFilters(next);\n    setPage(1);\n  };\n\n  const downloadCSV = () => {\n    const header = [\n      \"User\",\n      \"Email\",\n      \"User ID\",\n      \"User Type\",\n      \"Mail Verified\",\n      \"KYC Status\",\n      \"Accounts\",\n      \"Total Balance\",\n      \"Hold Balance\",\n      \"Free Balance\",\n      \"Total Equity\",\n    ];\n\n    const rows = rowsForCsv.map((row) => [\n      row.name ?? row.fullName ?? \"--\",\n      row.email ?? \"--\",\n      row.userId ?? row._id ?? \"--\",\n      row.userType ?? \"--\",\n      row.isMailVerified === true\n        ? \"true\"\n        : row.isMailVerified === false\n        ? \"false\"\n        : \"--\",\n      row.kycStatus ?? \"--\",\n      getFundsValue(row, \"accountsCount\") ?? \"--\",\n      getFundsValue(row, \"totalBalance\") ?? \"--\",\n      getFundsValue(row, \"totalHoldBalance\") ?? \"--\",\n      getFundsValue(row, \"totalFreeBalance\") ?? \"--\",\n      getFundsValue(row, \"totalEquity\") ?? \"--\",\n    ]);\n\n    const csvContent =\n      \"data:text/csv;charset=utf-8,\" +\n      [header, ...rows].map((e) => e.join(\",\")).join(\"\\n\");\n\n    const link = document.createElement(\"a\");\n    link.href = encodeURI(csvContent);\n    link.download = \"User_Funds.csv\";\n    link.click();\n  };\n\n  return (\n    <div className=\"container-pad max-w-full space-y-4 text-[var(--foreground)] sm:space-y-5\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div>\n          <h2 className=\"text-xl font-semibold\">User Funds</h2>\n          <p className=\"text-sm text-[var(--text-muted)]\">\n            Aggregated balances per user with account-level filters.\n          </p>\n        </div>\n\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <button\n            onClick={downloadCSV}\n            disabled={!rows.length}\n            className=\"inline-flex items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)] disabled:opacity-60\"\n          >\n            <Download size={16} /> Download\n          </button>\n          <button\n            onClick={() => router.push(\"/admin/users/users-funds/create\")}\n            className=\"inline-flex items-center gap-2 rounded-lg bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)]\"\n          >\n            <Plus size={16} /> Add Trader Fund\n          </button>\n        </div>\n      </div>\n\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4 sm:p-5\">\n        <div className=\"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4\">\n          <InputField\n            icon={<Users size={14} />}\n            placeholder=\"Search name/email\"\n            value={draftFilters.q}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, q: value }))\n            }\n          />\n          <InputField\n            icon={<User size={14} />}\n            placeholder=\"User ID\"\n            value={draftFilters.userId}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, userId: value }))\n            }\n          />\n          <SelectField\n            icon={<Users size={14} />}\n            value={draftFilters.userType}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                userType: value as FundsFilters[\"userType\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All User Type\" },\n              { value: \"USER\", label: \"USER\" },\n              { value: \"ADMIN\", label: \"ADMIN\" },\n            ]}\n          />\n          <SelectField\n            icon={<MailCheck size={14} />}\n            value={draftFilters.isMailVerified}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                isMailVerified: value as FundsFilters[\"isMailVerified\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"Mail Verified: All\" },\n              { value: \"true\", label: \"Mail Verified: true\" },\n              { value: \"false\", label: \"Mail Verified: false\" },\n            ]}\n          />\n          <SelectField\n            icon={<ShieldCheck size={14} />}\n            value={draftFilters.kycStatus}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                kycStatus: value as FundsFilters[\"kycStatus\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"KYC: All\" },\n              { value: \"NOT_STARTED\", label: \"KYC: NOT_STARTED\" },\n              { value: \"PENDING\", label: \"KYC: PENDING\" },\n              { value: \"VERIFIED\", label: \"KYC: VERIFIED\" },\n              { value: \"REJECTED\", label: \"KYC: REJECTED\" },\n            ]}\n          />\n          <SelectField\n            icon={<Wallet size={14} />}\n            value={draftFilters.accountType}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                accountType: value as FundsFilters[\"accountType\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All Account Type\" },\n              { value: \"demo\", label: \"demo\" },\n              { value: \"live\", label: \"live\" },\n            ]}\n          />\n          <SelectField\n            icon={<Hash size={14} />}\n            value={draftFilters.accountStatus}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                accountStatus: value as FundsFilters[\"accountStatus\"],\n              }))\n            }\n            options={[\n              { value: \"\", label: \"All Status\" },\n              { value: \"active\", label: \"active\" },\n              { value: \"disabled\", label: \"disabled\" },\n            ]}\n          />\n          <InputField\n            icon={<Coins size={14} />}\n            placeholder=\"Currency (e.g. USD)\"\n            value={draftFilters.currency}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({ ...prev, currency: value }))\n            }\n          />\n          <SelectField\n            icon={<SlidersHorizontal size={14} />}\n            value={draftFilters.sortBy}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                sortBy: value as FundsFilters[\"sortBy\"],\n              }))\n            }\n            options={[\n              { value: \"createdAt\", label: \"sortBy: createdAt\" },\n              { value: \"updatedAt\", label: \"sortBy: updatedAt\" },\n              { value: \"name\", label: \"sortBy: name\" },\n              { value: \"email\", label: \"sortBy: email\" },\n            ]}\n          />\n          <SelectField\n            icon={<SlidersHorizontal size={14} />}\n            value={draftFilters.sortDir}\n            onChange={(value) =>\n              setDraftFilters((prev) => ({\n                ...prev,\n                sortDir: value as FundsFilters[\"sortDir\"],\n              }))\n            }\n            options={[\n              { value: \"desc\", label: \"sortDir: desc\" },\n              { value: \"asc\", label: \"sortDir: asc\" },\n            ]}\n          />\n        </div>\n\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <button\n            type=\"button\"\n            onClick={applyFilters}\n            className=\"inline-flex items-center gap-2 rounded-lg bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)]\"\n          >\n            Apply Filters\n          </button>\n          <button\n            type=\"button\"\n            onClick={resetFilters}\n            className=\"inline-flex items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n          >\n            Reset\n          </button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6\">\n        {metrics.map((metric) => (\n          <MetricCard key={metric.label} label={metric.label} value={metric.value} />\n        ))}\n      </div>\n\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4 sm:p-5\">\n        {fundsQuery.isLoading ? (\n          <div className=\"py-8\">\n            <GlobalLoader />\n          </div>\n        ) : fundsQuery.isError || apiData?.success === false ? (\n          <div className=\"rounded-xl border border-red-200 bg-red-50 px-4 py-6 text-center text-sm text-red-700\">\n            {apiData?.message || \"Failed to load user funds.\"}\n            <button\n              type=\"button\"\n              onClick={() => fundsQuery.refetch()}\n              className=\"ml-3 rounded-md border border-red-300 bg-white px-3 py-1 text-xs font-semibold hover:bg-red-100\"\n            >\n              Retry\n            </button>\n          </div>\n        ) : rows.length === 0 ? (\n          <div className=\"rounded-xl border border-dashed border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-10 text-center text-sm text-[var(--text-muted)]\">\n            No users found for selected filters.\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-[1200px] w-full text-left text-sm\">\n              <thead className=\"bg-[var(--input-bg)] text-xs uppercase text-[var(--text-muted)]\">\n                <tr>\n                  <th className=\"px-4 py-3\">User</th>\n                  <th className=\"px-4 py-3\">User ID</th>\n                  <th className=\"px-4 py-3\">Type</th>\n                  <th className=\"px-4 py-3\">Mail</th>\n                  <th className=\"px-4 py-3\">KYC</th>\n                  <th className=\"px-4 py-3\">Accounts</th>\n                  <th className=\"px-4 py-3\">Balance</th>\n                  <th className=\"px-4 py-3\">Hold Balance</th>\n                  <th className=\"px-4 py-3\">Free Balance</th>\n                  <th className=\"px-4 py-3\">Equity</th>\n                </tr>\n              </thead>\n              <tbody>\n                {rows.map((row, index) => (\n                  <UserFundsRow key={row.userId ?? row._id ?? index} row={row} />\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n\n      <Pagination\n        page={page}\n        totalPages={totalPages}\n        limit={limit}\n        onPageChange={setPage}\n        onLimitChange={(nextLimit) => {\n          setLimit(nextLimit);\n          setPage(1);\n        }}\n      />\n    </div>\n  );\n}\n\nfunction InputField({\n  value,\n  onChange,\n  placeholder = \"\",\n  icon,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  icon?: ReactNode;\n}) {\n  return (\n    <div className=\"relative\">\n      {icon ? (\n        <span className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\">\n          {icon}\n        </span>\n      ) : null}\n      <input\n        value={value}\n        onChange={(event) => onChange(event.target.value)}\n        placeholder={placeholder}\n        className={`w-full rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] py-2 pr-3 text-[13px] outline-none focus:ring-2 focus:ring-[var(--primary)]/20 sm:text-sm ${\n          icon ? \"pl-9\" : \"pl-3\"\n        }`}\n      />\n    </div>\n  );\n}\n\nfunction SelectField({\n  value,\n  onChange,\n  options,\n  icon,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n  options: Array<{ value: string; label: string }>;\n  icon?: ReactNode;\n}) {\n  return (\n    <div className=\"relative\">\n      {icon ? (\n        <span className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\">\n          {icon}\n        </span>\n      ) : null}\n      <select\n        value={value}\n        onChange={(event) => onChange(event.target.value)}\n        className={`w-full rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] py-2 pr-3 text-[13px] outline-none focus:ring-2 focus:ring-[var(--primary)]/20 sm:text-sm ${\n          icon ? \"pl-9\" : \"pl-3\"\n        }`}\n      >\n        {options.map((option) => (\n          <option key={option.value || option.label} value={option.value}>\n            {option.label}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nfunction MetricCard({ label, value }: { label: string; value: string }) {\n  return (\n    <div className=\"rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n      <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n        {label}\n      </p>\n      <p className=\"mt-1 text-lg font-semibold text-[var(--foreground)]\">{value}</p>\n    </div>\n  );\n}\n\nfunction UserFundsRow({ row }: { row: TradeAdminUserFundsItem }) {\n  const userId = row.userId ?? (row._id as string | undefined) ?? \"--\";\n  const userName = row.name ?? row.fullName ?? \"--\";\n  const email = row.email ?? \"--\";\n  const userType = row.userType ?? \"--\";\n  const mailVerified =\n    row.isMailVerified === true\n      ? \"verified\"\n      : row.isMailVerified === false\n      ? \"unverified\"\n      : \"--\";\n  const kycStatus = row.kycStatus ?? \"--\";\n\n  return (\n    <tr className=\"border-t border-[var(--card-border)] hover:bg-[var(--hover-bg)]/60\">\n      <td className=\"px-4 py-3\">\n        <p className=\"font-semibold\">{userName}</p>\n        <p className=\"text-xs text-[var(--text-muted)]\">{email}</p>\n      </td>\n      <td className=\"px-4 py-3 font-mono text-xs\">{userId}</td>\n      <td className=\"px-4 py-3\">{userType}</td>\n      <td className=\"px-4 py-3\">\n        <span\n          className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${\n            row.isMailVerified === true\n              ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n              : row.isMailVerified === false\n              ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n              : \"border-slate-500/40 bg-slate-500/10 text-slate-700\"\n          }`}\n        >\n          {mailVerified}\n        </span>\n      </td>\n      <td className=\"px-4 py-3\">\n        <span\n          className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${\n            kycStatus === \"VERIFIED\"\n              ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n              : kycStatus === \"PENDING\"\n              ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n              : kycStatus === \"REJECTED\"\n              ? \"border-rose-500/40 bg-rose-500/10 text-rose-700\"\n              : \"border-slate-500/40 bg-slate-500/10 text-slate-700\"\n          }`}\n        >\n          {kycStatus}\n        </span>\n      </td>\n      <td className=\"px-4 py-3\">{row.accountsCount ?? \"--\"}</td>\n      <td className=\"px-4 py-3\">{formatNumber(Number(row.totalBalance))}</td>\n      <td className=\"px-4 py-3\">{formatNumber(Number(row.totalHoldBalance))}</td>\n      <td className=\"px-4 py-3\">{formatNumber(Number(row.totalFreeBalance))}</td>\n      <td className=\"px-4 py-3\">{formatNumber(Number(row.totalEquity))}</td>\n    </tr>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\users\\users\\clients\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'notifyLossPercent' is assigned a value but never used.","line":45,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setNotifyLossPercent' is assigned a value but never used.","line":45,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":49}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { ArrowLeft, Eye, EyeOff } from \"lucide-react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function CreateTradingClient() {\r\n  const router = useRouter();\r\n  const [showPass, setShowPass] = useState(false);\r\n\r\n  const tabs = [\r\n    \"Personal Details\",\r\n    \"Configuration\",\r\n    \"Equity Futures\",\r\n    \"Options Config\",\r\n    \"Options Shortselling Configuration\",\r\n    \"MCX Futures\",\r\n    \"Comex Config\",\r\n    \"Forex Config\",\r\n    \"Crypto Config\",\r\n    \"US Stocks & Indices Config\",\r\n  ];\r\n\r\n  const [activeTab, setActiveTab] = useState(0);\r\n\r\n  // STATES\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [mobile, setMobile] = useState(\"\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [initialBalance, setInitialBalance] = useState(\"\");\r\n  const [city, setCity] = useState(\"\");\r\n\r\n  const [demoAccount, setDemoAccount] = useState(false);\r\n  const [allowHighLow, setAllowHighLow] = useState(true);\r\n  const [accountStatus, setAccountStatus] = useState(true);\r\n  const [allowFreshEntryAboveBelow, setAllowFreshEntryAboveBelow] = useState(true);\r\n  const [tradeEquityAsUnits, setTradeEquityAsUnits] = useState(false);\r\n  const [autoCloseTradesIfConditionMet, setAutoCloseTradesIfConditionMet] = useState(true);\r\n\r\n  const [autoCloseLossPercent, setAutoCloseLossPercent] = useState(\"90\");\r\n  const [minTimeToBookProfitSeconds, setMinTimeToBookProfitSeconds] = useState(\"120\");\r\n  const [notifyLossPercent, setNotifyLossPercent] = useState(\"70\");\r\n\r\n  const handleCreate = () => {\r\n    alert(\"Create User Triggered!\");\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* BACK BUTTON */}\r\n      <button\r\n        onClick={() => router.back()}\r\n        className=\"flex items-center gap-2 mb-6 text-[var(--text-muted)] hover:text-[var(--foreground)]\"\r\n      >\r\n        <ArrowLeft size={20} /> Back\r\n      </button>\r\n\r\n      {/* TITLE */}\r\n      <h1 className=\"text-3xl font-bold mb-6\">Create Trading Users</h1>\r\n\r\n      {/* MAIN CARD */}\r\n      <div className=\"bg-[var(--card-bg)] border border-[var(--card-border)] rounded-lg p-6 w-full overflow-x-hidden\">\r\n\r\n        {/* TABS */}\r\n        <div className=\"flex flex-wrap gap-2 pb-3 border-b border-[var(--card-border)]\">\r\n          {tabs.map((tab, index) => (\r\n            <button\r\n              key={index}\r\n              onClick={() => setActiveTab(index)}\r\n              className={`px-4 py-2 rounded-md text-sm ${\r\n                activeTab === index\r\n                  ? \"bg-[var(--input-bg)] text-[var(--foreground)]\"\r\n                  : \"text-[var(--text-muted)] hover:bg-[var(--hover-bg)]\"\r\n              }`}\r\n            >\r\n              {tab}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* -------------------- PERSONAL DETAILS TAB -------------------- */}\r\n        {activeTab === 0 && (\r\n          <div className=\"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n\r\n            <div>\r\n              <label>First Name</label>\r\n              <input\r\n                value={firstName}\r\n                onChange={(e) => setFirstName(e.target.value)}\r\n                placeholder=\"Enter first name\"\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Last Name</label>\r\n              <input\r\n                value={lastName}\r\n                onChange={(e) => setLastName(e.target.value)}\r\n                placeholder=\"Enter last name\"\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Email</label>\r\n              <input\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                placeholder=\"Enter email\"\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Mobile</label>\r\n              <input\r\n                value={mobile}\r\n                onChange={(e) => setMobile(e.target.value)}\r\n                placeholder=\"Enter phone\"\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Username</label>\r\n              <input\r\n                value={username}\r\n                onChange={(e) => setUsername(e.target.value)}\r\n                placeholder=\"Enter username\"\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>Password</label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={showPass ? \"text\" : \"password\"}\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n                />\r\n                <button\r\n                  onClick={() => setShowPass(!showPass)}\r\n                  className=\"absolute right-3 top-3 text-[var(--text-muted)]\"\r\n                >\r\n                  {showPass ? <EyeOff size={18} /> : <Eye size={18} />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label>Initial Balance</label>\r\n              <input\r\n                type=\"number\"\r\n                value={initialBalance}\r\n                onChange={(e) => setInitialBalance(e.target.value)}\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label>City</label>\r\n              <input\r\n                value={city}\r\n                onChange={(e) => setCity(e.target.value)}\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n\r\n        {/* ---------------------- CONFIGURATION TAB ---------------------- */}\r\n        {activeTab === 1 && (\r\n          <div className=\"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n\r\n            {/* LEFT SETTINGS */}\r\n            <div>\r\n              {[\r\n                { label: \"Demo Account?\", val: demoAccount, setter: setDemoAccount },\r\n                { label: \"Allow orders between High - Low?\", val: allowHighLow, setter: setAllowHighLow },\r\n                { label: \"Account Status\", val: accountStatus, setter: setAccountStatus }\r\n              ].map((item, i) => (\r\n                <div key={i} className=\"flex items-center gap-3 mb-4\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={item.val}\r\n                    onChange={() => item.setter(!item.val)}\r\n                    className=\"w-4 h-4 accent-[var(--primary)]\"\r\n                  />\r\n                  <label>{item.label}</label>\r\n                </div>\r\n              ))}\r\n\r\n              <label>Auto Close Loss %</label>\r\n              <input\r\n                type=\"number\"\r\n                value={autoCloseLossPercent}\r\n                onChange={(e) => setAutoCloseLossPercent(e.target.value)}\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n            {/* RIGHT SETTINGS */}\r\n            <div>\r\n              {[\r\n                { label: \"Allow fresh entry above/below?\", val: allowFreshEntryAboveBelow, setter: setAllowFreshEntryAboveBelow },\r\n                { label: \"Trade equity as units?\", val: tradeEquityAsUnits, setter: setTradeEquityAsUnits },\r\n                { label: \"Auto close trades if condition met\", val: autoCloseTradesIfConditionMet, setter: setAutoCloseTradesIfConditionMet }\r\n              ].map((item, i) => (\r\n                <div key={i} className=\"flex items-center gap-3 mb-4\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={item.val}\r\n                    onChange={() => item.setter(!item.val)}\r\n                    className=\"w-4 h-4 accent-[var(--primary)]\"\r\n                  />\r\n                  <label>{item.label}</label>\r\n                </div>\r\n              ))}\r\n\r\n              <label>Min Time to Book Profit (sec)</label>\r\n              <input\r\n                value={minTimeToBookProfitSeconds}\r\n                onChange={(e) => setMinTimeToBookProfitSeconds(e.target.value)}\r\n                className=\"w-full bg-[var(--input-bg)] border border-[var(--input-border)] px-4 py-2 rounded-md\"\r\n              />\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n\r\n        {/* ------------------------- OTHER TABS ------------------------- */}\r\n        {activeTab >= 2 && (\r\n          <div className=\"mt-6 p-6 bg-[var(--input-bg)] border border-[var(--card-border)] rounded-lg w-full\">\r\n            <p className=\"text-lg font-medium\">{tabs[activeTab]}</p>\r\n            <p className=\"text-[var(--text-muted)]\">This section will be added when you request it.</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* CREATE BUTTON */}\r\n      <div className=\"fixed bottom-6 right-6\">\r\n        <button\r\n          onClick={handleCreate}\r\n          className=\"px-6 py-3 rounded-lg bg-[var(--primary)] hover:bg-[var(--primary-dark)] text-white shadow-lg\"\r\n        >\r\n          Create\r\n        </button>\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\users\\users\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'users' logical expression could make the dependencies of useMemo Hook (at line 129) change on every render. To fix this, wrap the initialization of 'users' in its own useMemo() Hook.","line":101,"column":9,"nodeType":"VariableDeclarator","endLine":101,"endColumn":43}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport { useEffect, useMemo, useState, type ReactNode } from \"react\";\nimport {\n  Plus,\n  Search,\n  ShieldCheck,\n  Mail,\n  ChevronDown,\n  Sparkles,\n  Users,\n  Clock3,\n  XCircle,\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport Pagination from \"../../components/ui/pagination\";\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\nimport { useAdminUsers } from \"@/hooks/useAdminUsers\";\nimport type { AdminUser } from \"@/types/user\";\n\ntype KycFilter = \"ALL\" | \"NOT_STARTED\" | \"PENDING\" | \"VERIFIED\" | \"REJECTED\";\ntype MailFilter = \"ALL\" | \"true\" | \"false\";\ntype FilterKey = \"kyc\" | \"mail\";\n\nconst kycStyles: Record<string, string> = {\n  VERIFIED: \"border-emerald-500/40 bg-emerald-500/5 text-emerald-600\",\n  PENDING: \"border-amber-500/40 bg-amber-500/5 text-amber-600\",\n  NOT_STARTED: \"border-slate-400/40 bg-slate-400/5 text-slate-600\",\n  REJECTED: \"border-red-500/40 bg-red-500/5 text-red-600\",\n};\n\nfunction formatDate(value?: string) {\n  if (!value) return \"--\";\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return value;\n  return date.toLocaleDateString(\"en-GB\", {\n    day: \"2-digit\",\n    month: \"short\",\n    year: \"numeric\",\n  });\n}\n\nexport default function UsersPage() {\n  const router = useRouter();\n\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [query, setQuery] = useState(\"\");\n  const [kycStatus, setKycStatus] = useState<KycFilter>(\"ALL\");\n  const [mailVerified, setMailVerified] = useState<MailFilter>(\"ALL\");\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(20);\n  const [openFilter, setOpenFilter] = useState<FilterKey | null>(null);\n\n  const kycOptions: Array<{ value: KycFilter; label: string; dot: string }> = [\n    { value: \"ALL\", label: \"All KYC\", dot: \"bg-slate-300\" },\n    { value: \"NOT_STARTED\", label: \"Not Started\", dot: \"bg-slate-400\" },\n    { value: \"PENDING\", label: \"Pending\", dot: \"bg-amber-500\" },\n    { value: \"VERIFIED\", label: \"Verified\", dot: \"bg-emerald-500\" },\n    { value: \"REJECTED\", label: \"Rejected\", dot: \"bg-red-500\" },\n  ];\n\n  const mailOptions: Array<{ value: MailFilter; label: string; dot: string }> = [\n    { value: \"ALL\", label: \"All Mail\", dot: \"bg-slate-300\" },\n    { value: \"true\", label: \"Mail Verified\", dot: \"bg-emerald-500\" },\n    { value: \"false\", label: \"Mail Unverified\", dot: \"bg-amber-500\" },\n  ];\n\n  useEffect(() => {\n    const t = setTimeout(() => {\n      setQuery(searchInput.trim());\n      setPage(1);\n    }, 400);\n\n    return () => clearTimeout(t);\n  }, [searchInput]);\n\n  useEffect(() => {\n    const onClick = (event: Event) => {\n      const target = event.target as HTMLElement | null;\n      if (target?.closest(\"[data-filter]\")) return;\n      setOpenFilter(null);\n    };\n\n    document.addEventListener(\"mousedown\", onClick, true);\n    document.addEventListener(\"touchstart\", onClick, true);\n    return () => {\n      document.removeEventListener(\"mousedown\", onClick, true);\n      document.removeEventListener(\"touchstart\", onClick, true);\n    };\n  }, []);\n\n  const listQuery = useAdminUsers({\n    q: query || undefined,\n    kycStatus: kycStatus === \"ALL\" ? undefined : kycStatus,\n    isMailVerified:\n      mailVerified === \"ALL\" ? undefined : mailVerified === \"true\",\n    page,\n    limit,\n  });\n\n  const users = listQuery.data?.data ?? [];\n  const pagination = listQuery.data?.pagination;\n  const totalPages = pagination?.totalPages ?? 1;\n  const total = pagination?.total ?? users.length;\n  const isInitialLoading = listQuery.isLoading && !listQuery.data;\n  const isUpdating = listQuery.isFetching && !isInitialLoading;\n\n  const summary = useMemo(\n    () =>\n      users.reduce(\n        (acc, user) => {\n          if (user.kycStatus === \"VERIFIED\") acc.kycVerified += 1;\n          else if (user.kycStatus === \"PENDING\") acc.kycPending += 1;\n          else if (user.kycStatus === \"REJECTED\") acc.kycRejected += 1;\n          else if (user.kycStatus === \"NOT_STARTED\") acc.kycNotStarted += 1;\n          if (user.isMailVerified) acc.mailVerified += 1;\n          else acc.mailUnverified += 1;\n          return acc;\n        },\n        {\n          kycVerified: 0,\n          kycPending: 0,\n          kycRejected: 0,\n          kycNotStarted: 0,\n          mailVerified: 0,\n          mailUnverified: 0,\n        }\n      ),\n    [users]\n  );\n\n  const navigateToUser = (user: AdminUser) => {\n    const params = new URLSearchParams({\n      name: user.name ?? \"\",\n      email: user.email ?? \"\",\n      phone: user.phone ?? \"\",\n      kycStatus: user.kycStatus ?? \"\",\n      isMailVerified: String(Boolean(user.isMailVerified)),\n    });\n    router.push(`/admin/users/users/view/${user._id}?${params.toString()}`);\n  };\n\n  return (\n    <div className=\"container-pad space-y-4 max-w-full text-[var(--foreground)] sm:space-y-5\">\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-gradient-to-br from-[var(--card-bg)] via-[var(--card-bg)] to-sky-500/5 p-4 sm:p-5\">\n        <div className=\"inline-flex items-center gap-2 rounded-full border border-sky-500/30 bg-sky-500/10 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-sky-700\">\n          <Sparkles size={12} />\n          User Directory\n        </div>\n\n        <div className=\"mt-2 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n          <div>\n            <h1 className=\"text-lg sm:text-2xl font-semibold\">Users</h1>\n            <p className=\"text-xs sm:text-sm text-[var(--text-muted)]\">\n              Manage users, verification, and KYC status\n            </p>\n          </div>\n\n          <button\n            onClick={() => router.push(\"/admin/users/users/clients\")}\n            className=\"inline-flex items-center justify-center gap-2 rounded-lg border border-[var(--card-border)]\n                       bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold text-[var(--text-main)]\n                       hover:bg-[var(--hover-bg)] w-full sm:w-auto\"\n          >\n            <Plus size={16} /> Create User\n          </button>\n        </div>\n\n        <div className=\"mt-4 flex flex-col lg:flex-row lg:items-center gap-2\">\n          <div className=\"flex-1 relative\">\n            <Search\n              size={16}\n              className=\"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\"\n            />\n            <input\n              placeholder=\"Search by name, email or phone...\"\n              value={searchInput}\n              onChange={(e) => setSearchInput(e.target.value)}\n              className=\"w-full rounded-lg bg-[var(--input-bg)] border border-[var(--input-border)]\n                         pl-9 pr-3 py-2 text-sm text-[var(--foreground)]\n                         focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/30\"\n            />\n          </div>\n\n          <div className=\"relative w-full sm:w-[200px]\" data-filter>\n          <button\n            type=\"button\"\n            onClick={() =>\n              setOpenFilter((prev) => (prev === \"kyc\" ? null : \"kyc\"))\n            }\n            className={`w-full rounded-lg border px-3 py-2 text-sm font-medium flex items-center justify-between ${\n              kycStatus === \"VERIFIED\"\n                ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n                : kycStatus === \"PENDING\"\n                ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n                : kycStatus === \"NOT_STARTED\"\n                ? \"border-slate-400/40 bg-slate-100 text-slate-700\"\n                : kycStatus === \"REJECTED\"\n                ? \"border-red-500/40 bg-red-500/10 text-red-700\"\n                : \"border-[var(--input-border)] bg-[var(--input-bg)] text-[var(--foreground)]\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-2\">\n              <ShieldCheck size={16} className=\"text-emerald-600\" />\n              {kycOptions.find((opt) => opt.value === kycStatus)?.label}\n            </span>\n            <ChevronDown\n              size={14}\n              className={`text-[var(--text-muted)] transition-transform ${\n                openFilter === \"kyc\" ? \"rotate-180\" : \"\"\n              }`}\n            />\n          </button>\n\n          {openFilter === \"kyc\" && (\n            <div className=\"absolute z-20 mt-2 w-full rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] shadow-lg\">\n              {kycOptions.map((opt) => (\n                <button\n                  key={opt.value}\n                  type=\"button\"\n                  className={`w-full flex items-center justify-between px-3 py-2 text-sm hover:bg-[var(--hover-bg)] ${\n                    opt.value === kycStatus ? \"bg-[var(--hover-bg)]\" : \"\"\n                  }`}\n                  onClick={() => {\n                    setKycStatus(opt.value);\n                    setPage(1);\n                    setOpenFilter(null);\n                  }}\n                >\n                  <span className=\"inline-flex items-center gap-2\">\n                    <span className={`h-2.5 w-2.5 rounded-full ${opt.dot}`} />\n                    {opt.label}\n                  </span>\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n\n          <div className=\"relative w-full sm:w-[200px]\" data-filter>\n          <button\n            type=\"button\"\n            onClick={() =>\n              setOpenFilter((prev) => (prev === \"mail\" ? null : \"mail\"))\n            }\n            className={`w-full rounded-lg border px-3 py-2 text-sm font-medium flex items-center justify-between ${\n              mailVerified === \"true\"\n                ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n                : mailVerified === \"false\"\n                ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n                : \"border-[var(--input-border)] bg-[var(--input-bg)] text-[var(--foreground)]\"\n            }`}\n          >\n            <span className=\"inline-flex items-center gap-2\">\n              <Mail size={16} className=\"text-sky-600\" />\n              {mailOptions.find((opt) => opt.value === mailVerified)?.label}\n            </span>\n            <ChevronDown\n              size={14}\n              className={`text-[var(--text-muted)] transition-transform ${\n                openFilter === \"mail\" ? \"rotate-180\" : \"\"\n              }`}\n            />\n          </button>\n\n          {openFilter === \"mail\" && (\n            <div className=\"absolute z-20 mt-2 w-full rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] shadow-lg\">\n              {mailOptions.map((opt) => (\n                <button\n                  key={opt.value}\n                  type=\"button\"\n                  className={`w-full flex items-center justify-between px-3 py-2 text-sm hover:bg-[var(--hover-bg)] ${\n                    opt.value === mailVerified ? \"bg-[var(--hover-bg)]\" : \"\"\n                  }`}\n                  onClick={() => {\n                    setMailVerified(opt.value);\n                    setPage(1);\n                    setOpenFilter(null);\n                  }}\n                >\n                  <span className=\"inline-flex items-center gap-2\">\n                    <span className={`h-2.5 w-2.5 rounded-full ${opt.dot}`} />\n                    {opt.label}\n                  </span>\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n        </div>\n      </div>\n\n      <div className=\"flex items-center justify-between text-xs text-[var(--text-muted)]\">\n        <span>Counts based on current page results</span>\n        <span>Total users: {total}</span>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-6\">\n        <MetricCard\n          label=\"Total Users\"\n          value={String(total)}\n          icon={<Users size={13} />}\n          tone=\"slate\"\n        />\n        <MetricCard\n          label=\"KYC Verified\"\n          value={String(summary.kycVerified)}\n          icon={<ShieldCheck size={13} />}\n          tone=\"emerald\"\n        />\n        <MetricCard\n          label=\"KYC Pending\"\n          value={String(summary.kycPending)}\n          icon={<Clock3 size={13} />}\n          tone=\"amber\"\n        />\n        <MetricCard\n          label=\"KYC Rejected\"\n          value={String(summary.kycRejected)}\n          icon={<XCircle size={13} />}\n          tone=\"rose\"\n        />\n        <MetricCard\n          label=\"Mail Verified\"\n          value={String(summary.mailVerified)}\n          icon={<Mail size={13} />}\n          tone=\"sky\"\n        />\n        <MetricCard\n          label=\"Mail Unverified\"\n          value={String(summary.mailUnverified)}\n          icon={<Mail size={13} />}\n          tone=\"violet\"\n        />\n      </div>\n\n      {/* TABLE */}\n      <div className=\"overflow-hidden rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)]\">\n        <div className=\"flex items-center justify-between border-b border-[var(--card-border)] px-4 py-3 text-xs text-[var(--text-muted)]\">\n          <span className=\"flex items-center gap-2\">\n            Total: {total}\n            {isUpdating && (\n              <span className=\"inline-flex items-center gap-1 text-[10px] text-[var(--text-muted)]\">\n                <span className=\"h-1.5 w-1.5 rounded-full bg-[var(--primary)] animate-pulse\" />\n                Updating\n              </span>\n            )}\n          </span>\n          <span>Page {page} of {totalPages}</span>\n        </div>\n\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full min-w-[900px] text-left text-sm\">\n            <thead className=\"bg-[var(--input-bg)] text-[var(--text-muted)] text-xs uppercase\">\n              <tr>\n                <th className=\"px-4 py-3\">#</th>\n                <th className=\"px-4 py-3\">Name</th>\n                <th className=\"px-4 py-3\">Email</th>\n                <th className=\"px-4 py-3\">Phone</th>\n                <th className=\"px-4 py-3\">User Type</th>\n                <th className=\"px-4 py-3\">Mail</th>\n                <th className=\"px-4 py-3\">KYC</th>\n                <th className=\"px-4 py-3\">Created</th>\n              </tr>\n            </thead>\n            <tbody>\n              {isInitialLoading ? (\n                <tr>\n                  <td colSpan={8} className=\"py-10 text-center\">\n                    <GlobalLoader />\n                  </td>\n                </tr>\n              ) : listQuery.isError ? (\n                <tr>\n                  <td colSpan={8} className=\"py-10 text-center text-sm text-[var(--danger)]\">\n                    Failed to load users. Please try again.\n                  </td>\n                </tr>\n              ) : users.length === 0 ? (\n                <tr>\n                  <td colSpan={8} className=\"py-10 text-center text-sm text-[var(--text-muted)]\">\n                    No users found.\n                  </td>\n                </tr>\n              ) : (\n                users.map((u: AdminUser, idx: number) => (\n                  <tr\n                    key={u._id}\n                    className=\"border-t border-[var(--card-border)] hover:bg-[var(--hover-bg)] duration-150 cursor-pointer\"\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => navigateToUser(u)}\n                    onKeyDown={(event) => {\n                      if (event.key === \"Enter\" || event.key === \" \") {\n                        event.preventDefault();\n                        navigateToUser(u);\n                      }\n                    }}\n                  >\n                    <td className=\"px-4 py-3 text-[var(--text-muted)]\">\n                      {(page - 1) * limit + idx + 1}\n                    </td>\n                    <td className=\"px-4 py-3\">\n                      <div className=\"flex flex-col\">\n                        <span className=\"font-semibold\">{u.name || \"--\"}</span>\n                        <span className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n                          ID: {u._id.slice(0, 8)}...\n                        </span>\n                      </div>\n                    </td>\n                    <td className=\"px-4 py-3\">{u.email || \"--\"}</td>\n                    <td className=\"px-4 py-3\">{u.phone || \"--\"}</td>\n                    <td className=\"px-4 py-3\">{u.userType || \"--\"}</td>\n                    <td className=\"px-4 py-3\">\n                      <span\n                        className={`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium ${\n                          u.isMailVerified\n                            ? \"border-emerald-500/40 bg-emerald-500/5 text-emerald-600\"\n                            : \"border-amber-500/40 bg-amber-500/5 text-amber-600\"\n                        }`}\n                      >\n                        {u.isMailVerified ? \"Verified\" : \"Unverified\"}\n                      </span>\n                    </td>\n                    <td className=\"px-4 py-3\">\n                      <span\n                        className={`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium ${\n                          kycStyles[u.kycStatus] ||\n                          \"border-[var(--border-subtle)] bg-[var(--chip-bg)] text-[var(--text-muted)]\"\n                        }`}\n                      >\n                        {u.kycStatus || \"UNKNOWN\"}\n                      </span>\n                    </td>\n                    <td className=\"px-4 py-3\">{formatDate(u.createdAt)}</td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* PAGINATION */}\n      <Pagination\n        page={page}\n        totalPages={totalPages}\n        limit={limit}\n        onPageChange={setPage}\n        onLimitChange={(l) => {\n          setLimit(l);\n          setPage(1);\n        }}\n      />\n    </div>\n  );\n}\n\nfunction MetricCard({\n  label,\n  value,\n  icon,\n  tone,\n}: {\n  label: string;\n  value: string;\n  icon: ReactNode;\n  tone: \"slate\" | \"sky\" | \"violet\" | \"amber\" | \"emerald\" | \"rose\";\n}) {\n  const toneClasses: Record<typeof tone, string> = {\n    slate: \"border-slate-400/30 bg-slate-500/[0.04]\",\n    sky: \"border-sky-400/30 bg-sky-500/[0.05]\",\n    violet: \"border-violet-400/30 bg-violet-500/[0.05]\",\n    amber: \"border-amber-400/30 bg-amber-500/[0.05]\",\n    emerald: \"border-emerald-400/30 bg-emerald-500/[0.05]\",\n    rose: \"border-rose-400/30 bg-rose-500/[0.05]\",\n  };\n\n  return (\n    <div className={`rounded-xl border p-3 ${toneClasses[tone]}`}>\n      <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n        {label}\n      </p>\n      <div className=\"mt-1 inline-flex h-6 w-6 items-center justify-center rounded-md bg-[var(--card-bg)] text-[var(--text-muted)]\">\n        {icon}\n      </div>\n      <p className=\"mt-1 text-lg font-semibold text-[var(--foreground)]\">\n        {value}\n      </p>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\users\\users\\view\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":4},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nE:\\Admin-frontend-als\\app\\admin\\users\\users\\view\\[id]\\page.tsx:497:7\n  495 |       normalized === \"positions\"\n  496 |     ) {\n> 497 |       setActiveTab(\"Active Trades\");\n      |       ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  498 |     }\n  499 |   }, [tabFromParams]);\n  500 |","line":497,"column":7,"nodeType":null,"endLine":497,"endColumn":19},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nE:\\Admin-frontend-als\\app\\admin\\users\\users\\view\\[id]\\page.tsx:851:7\n  849 |         wsRef.current = null;\n  850 |       }\n> 851 |       setLiveStatus(\"idle\");\n      |       ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  852 |       return;\n  853 |     }\n  854 |","line":851,"column":7,"nodeType":null,"endLine":851,"endColumn":20},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nE:\\Admin-frontend-als\\app\\admin\\users\\users\\view\\[id]\\page.tsx:1031:5\n  1029 |     const source = profile ?? profileFromParams;\n  1030 |\n> 1031 |     setLocalProfile({\n       |     ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  1032 |       name: source.name ?? \"\",\n  1033 |       email: source.email ?? \"\",\n  1034 |       phone: source.phone ?? \"\",","line":1031,"column":5,"nodeType":null,"endLine":1031,"endColumn":20},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nE:\\Admin-frontend-als\\app\\admin\\users\\users\\view\\[id]\\page.tsx:1067:5\n  1065 |   useEffect(() => {\n  1066 |     if (!resetPasswordOpen) return;\n> 1067 |     setAccountPassword(\"\");\n       |     ^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  1068 |     setAccountPasswordConfirm(\"\");\n  1069 |     setAccountPasswordError(\"\");\n  1070 |     setShowAccountPassword(false);","line":1067,"column":5,"nodeType":null,"endLine":1067,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1126,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1126,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37682,37685],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37682,37685],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1142,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1142,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38302,38305],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38302,38305],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1233,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1233,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[40835,40838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[40835,40838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1271,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1271,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[41973,41976],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[41973,41976],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1298,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1298,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[42796,42799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[42796,42799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1321,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1321,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[43376,43379],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[43376,43379],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1419,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1419,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46312,46315],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46312,46315],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1428,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1428,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[46624,46627],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[46624,46627],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1484,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1484,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[48245,48248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[48245,48248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\";\r\n\r\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  type ChangeEvent,\n  type FormEvent,\n  type ReactNode,\n} from \"react\";\nimport { useParams, useRouter, useSearchParams } from \"next/navigation\";\r\nimport {\n  Calendar,\n  ChevronLeft,\n  ChevronDown,\n  Download,\n  Eye,\n  EyeOff,\n  FlaskConical,\n  Globe,\n  KeyRound,\n  Copy,\n  MapPin,\n  Mail,\n  Pencil,\n  Phone,\n  Rocket,\n  ShieldCheck,\n  User,\n  Users,\n  Hash,\n  Building2,\n  XCircle,\n  X,\n} from \"lucide-react\";\nimport type { LucideIcon } from \"lucide-react\";\r\nimport Modal from \"@/app/admin/components/ui/Modal\";\r\nimport GlobalLoader from \"@/app/admin/components/ui/GlobalLoader\";\r\nimport { Toast } from \"@/app/admin/components/ui/Toast\";\r\nimport Pagination from \"@/app/admin/components/ui/pagination\";\nimport { useAdminUser } from \"@/hooks/useAdminUser\";\nimport { useAdminUserAccounts } from \"@/hooks/useAdminUserAccounts\";\nimport { useAdminUserTransactions } from \"@/hooks/useAdminUserTransactions\";\nimport { useTradeAdminClosedTrades } from \"@/hooks/useTradeAdminClosedTrades\";\nimport { useTradeAdminPendingOpenOrders } from \"@/hooks/useTradeAdminPendingOpenOrders\";\nimport { useLiveQuotesBySymbols } from \"@/hooks/useLiveQuotesBySymbols\";\nimport { getAccessTokenFromCookie } from \"@/services/marketSocket.service\";\nimport { useUpdateAdminUser } from \"@/hooks/useUpdateAdminUser\";\nimport { useChangeAdminUserPassword } from \"@/hooks/useChangeAdminUserPassword\";\nimport { useUpdateAdminUserAccount } from \"@/hooks/useUpdateAdminUserAccount\";\nimport {\n  useResetAccountTradePassword,\n  useResetAccountWatchPassword,\n} from \"@/hooks/useResetAccountPasswords\";\nimport {\n  useTradeAdminModifyPendingOrder,\n  useTradeAdminCancelPendingOrder,\n  useTradeAdminModifyPosition,\n  useTradeAdminClosePosition,\n} from \"@/hooks/useTradeAdminOrderActions\";\nimport type { AdminAccount, AdminAccountUpdatePayload } from \"@/types/account\";\nimport type { AdminUserUpdatePayload } from \"@/types/user\";\nimport type { AdminTransaction } from \"@/types/transaction\";\nimport type { TradeAdminPendingOrder } from \"@/services/tradeAdmin.service\";\n\r\nconst kycStyles: Record<string, string> = {\r\n  VERIFIED: \"border-emerald-500/40 bg-emerald-500/5 text-emerald-600\",\r\n  PENDING: \"border-amber-500/40 bg-amber-500/5 text-amber-600\",\r\n  NOT_STARTED: \"border-slate-400/40 bg-slate-400/5 text-slate-600\",\r\n  REJECTED: \"border-red-500/40 bg-red-500/5 text-red-600\",\r\n};\r\n\r\nconst txStatusStyles: Record<string, string> = {\r\n  SUCCESS: \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\",\r\n  PENDING: \"border-amber-500/40 bg-amber-500/10 text-amber-700\",\r\n  FAILED: \"border-rose-500/40 bg-rose-500/10 text-rose-700\",\r\n  REJECTED: \"border-slate-500/40 bg-slate-500/10 text-slate-700\",\r\n};\r\n\r\nconst txTypeStyles: Record<string, string> = {\n  DEPOSIT: \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\",\n  WITHDRAW: \"border-rose-500/40 bg-rose-500/10 text-rose-700\",\n  TRADE_PROFIT: \"border-sky-500/40 bg-sky-500/10 text-sky-700\",\n  TRADE_LOSS: \"border-amber-500/40 bg-amber-500/10 text-amber-700\",\r\n  BONUS: \"border-purple-500/40 bg-purple-500/10 text-purple-700\",\r\n  ADJUSTMENT: \"border-slate-500/40 bg-slate-500/10 text-slate-700\",\n};\n\nconst getAccountTypeMeta = (accountType?: string) => {\n  const normalizedType = (accountType ?? \"\").toLowerCase();\n\n  if (normalizedType === \"demo\") {\n    return {\n      label: \"DEMO\",\n      icon: FlaskConical,\n      className: \"border-slate-500/40 bg-slate-500/10 text-slate-700\",\n      cardClassName: \"border-slate-400/60 bg-slate-500/[0.04]\",\n    };\n  }\n\n  if (normalizedType === \"live\") {\n    return {\n      label: \"LIVE\",\n      icon: Rocket,\n      className: \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\",\n      cardClassName: \"border-emerald-500/30 bg-emerald-500/[0.04]\",\n    };\n  }\n\n  if (normalizedType) {\n    return {\n      label: normalizedType.toUpperCase(),\n      icon: Globe,\n      className: \"border-sky-500/40 bg-sky-500/10 text-sky-700\",\n      cardClassName: \"border-sky-400/40 bg-sky-500/[0.04]\",\n    };\n  }\n\n  return {\n    label: \"--\",\n    icon: Hash,\n    className: \"border-[var(--card-border)] bg-[var(--chip-bg)] text-[var(--text-muted)]\",\n    cardClassName: \"border-[var(--card-border)] bg-[var(--input-bg)]\",\n  };\n};\n\ntype AccountEditForm = {\n  leverage: string;\n  spread_enabled: \"true\" | \"false\";\n  spread_pips: string;\n  commission_per_lot: string;\n  swap_enabled: \"true\" | \"false\";\n  swap_charge: string;\n  status: \"active\" | \"disabled\";\n};\n\nconst buildAccountEditForm = (account: AdminAccount): AccountEditForm => ({\n  leverage: String(account.leverage ?? 0),\n  spread_enabled: account.spread_enabled === false ? \"false\" : \"true\",\n  spread_pips: String(account.spread_pips ?? 0),\n  commission_per_lot: String(account.commission_per_lot ?? 0),\n  swap_enabled: account.swap_enabled === false ? \"false\" : \"true\",\n  swap_charge: String(account.swap_charge ?? 0),\n  status:\n    (account.status ?? \"active\").toLowerCase() === \"disabled\"\n      ? \"disabled\"\n      : \"active\",\n});\n\ntype LivePositionSnapshot = {\n  positionId: string;\n  accountId: string;\n  symbol?: string;\n  side?: string;\n  volume?: number;\n  openPrice?: number;\n  currentPrice?: number;\n  floatingPnL?: number;\n  stopLoss?: number | null;\n  takeProfit?: number | null;\n  openTime?: number;\n  updatedAt: string;\n};\n\nfunction normalizeWebSocketUrl(url: string) {\n  if (url.startsWith(\"ws://\") || url.startsWith(\"wss://\")) return url;\n  if (url.startsWith(\"http://\")) return `ws://${url.slice(\"http://\".length)}`;\n  if (url.startsWith(\"https://\")) return `wss://${url.slice(\"https://\".length)}`;\n  if (url.startsWith(\"//\")) {\n    const protocol =\n      typeof window !== \"undefined\" && window.location.protocol === \"https:\"\n        ? \"wss:\"\n        : \"ws:\";\n    return `${protocol}${url}`;\n  }\n  return url;\n}\n\nfunction resolveAccountSocketUrl() {\n  const direct = process.env.NEXT_PUBLIC_ACCOUNT_SOCKET_URL;\n  if (direct) return normalizeWebSocketUrl(direct);\n\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL;\n  if (!apiUrl) return \"\";\n  const trimmed = apiUrl.replace(/\\/$/, \"\");\n  const derived = /\\/api\\/v\\d+$/i.test(trimmed)\n    ? trimmed.replace(/\\/api\\/v\\d+$/i, \"/ws/account\")\n    : `${trimmed}/ws/account`;\n  return normalizeWebSocketUrl(derived);\n}\n\nfunction parseSocketMessages(raw: string) {\n  const trimmed = raw.trim();\n  if (!trimmed) return [];\n  try {\n    const parsed = JSON.parse(trimmed);\n    return Array.isArray(parsed) ? parsed : [parsed];\n  } catch {\n    return trimmed\n      .split(/\\r?\\n/)\n      .map((line) => line.trim())\n      .filter(Boolean)\n      .map((line) => {\n        try {\n          return JSON.parse(line);\n        } catch {\n          return null;\n        }\n      })\n      .filter(Boolean);\n  }\n}\n\r\nconst FieldControl = ({\r\n  icon: Icon,\r\n  children,\r\n  trailing,\r\n  className = \"\",\r\n}: {\r\n  icon: LucideIcon;\r\n  children: ReactNode;\r\n  trailing?: ReactNode;\r\n  className?: string;\r\n}) => (\r\n  <div\r\n    className={`flex items-center gap-2 rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] px-3 py-2 ${className}`}\r\n  >\r\n    <span className=\"flex h-8 w-8 items-center justify-center rounded-md bg-[var(--primary)]/10 text-[var(--primary)]\">\r\n      <Icon size={16} />\r\n    </span>\r\n    <div className=\"min-w-0 flex-1\">{children}</div>\r\n    {trailing ? (\r\n      <span className=\"ml-2 text-[var(--text-muted)]\">{trailing}</span>\r\n    ) : null}\r\n  </div>\r\n);\r\n\r\ntype SelectOption = {\r\n  value: string;\r\n  label: string;\r\n  dotClass?: string;\r\n};\r\n\r\nfunction CustomSelect({\r\n  value,\r\n  onChange,\r\n  options,\r\n  placeholder,\r\n  toneClass = \"border-[var(--card-border)] bg-[var(--card-bg)]\",\r\n  buttonClassName = \"\",\r\n  menuClassName = \"\",\r\n}: {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  options: SelectOption[];\r\n  placeholder: string;\r\n  toneClass?: string;\r\n  buttonClassName?: string;\r\n  menuClassName?: string;\r\n}) {\r\n  const [open, setOpen] = useState(false);\r\n  const ref = useRef<HTMLDivElement | null>(null);\r\n  const selected = options.find((opt) => opt.value === value);\r\n\r\n  useEffect(() => {\r\n    const onClick = (event: MouseEvent | TouchEvent) => {\r\n      const target = event.target as HTMLElement | null;\r\n      if (!ref.current?.contains(target)) {\r\n        setOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", onClick, true);\r\n    document.addEventListener(\"touchstart\", onClick, true);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", onClick, true);\r\n      document.removeEventListener(\"touchstart\", onClick, true);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={ref} className=\"relative\">\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => setOpen((prev) => !prev)}\r\n        aria-expanded={open}\r\n        className={`mt-1 h-10 w-full rounded-xl border px-3 py-2 text-sm font-semibold text-[var(--text-main)] ${toneClass} bg-[var(--card-bg)] ${buttonClassName} flex items-center justify-between transition focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/20 ${\r\n          open ? \"border-[var(--primary)]/40 bg-[var(--primary)]/5\" : \"\"\r\n        }`}\r\n      >\r\n        <span className=\"inline-flex min-w-0 flex-1 items-center gap-2\">\r\n          {selected?.dotClass && (\r\n            <span className={`h-2.5 w-2.5 rounded-full ${selected.dotClass}`} />\r\n          )}\r\n          <span className=\"truncate\">{selected?.label ?? placeholder}</span>\r\n        </span>\r\n        <ChevronDown\r\n          size={16}\r\n          className={`text-[var(--text-muted)] transition-transform ${\r\n            open ? \"rotate-180\" : \"\"\r\n          }`}\r\n        />\r\n      </button>\r\n\r\n      {open && (\r\n        <div\r\n          className={`absolute z-40 mt-2 w-full rounded-xl border border-[var(--card-border)] bg-[var(--card-bg)] overflow-hidden ${menuClassName}`}\r\n        >\r\n          <div className=\"max-h-64 overflow-auto\">\r\n            {options.map((opt) => {\r\n              const active = opt.value === value;\r\n              return (\r\n                <button\r\n                  key={opt.value || opt.label}\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    onChange(opt.value);\r\n                    setOpen(false);\r\n                  }}\r\n                  className={`w-full flex items-center gap-2 px-3 py-2.5 text-sm text-left transition hover:bg-[var(--hover-bg)] ${\r\n                    active\r\n                      ? \"bg-[var(--primary)]/10 text-[var(--primary)] font-semibold\"\r\n                      : \"\"\r\n                  }`}\r\n                >\r\n                  {opt.dotClass && (\r\n                    <span className={`h-2.5 w-2.5 rounded-full ${opt.dotClass}`} />\r\n                  )}\r\n                  {opt.label}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function UserViewPage() {\r\n  const router = useRouter();\r\n  const params = useParams();\r\n  const searchParams = useSearchParams();\r\n  const rawId = params?.id as string | string[] | undefined;\r\n  const userId = Array.isArray(rawId) ? rawId[0] : rawId;\r\n\r\n  const userQuery = useAdminUser(userId);\n  const updateMutation = useUpdateAdminUser();\n  const changePasswordMutation = useChangeAdminUserPassword();\n  const updateAccountMutation = useUpdateAdminUserAccount();\n  const resetTradePasswordMutation = useResetAccountTradePassword();\n  const resetWatchPasswordMutation = useResetAccountWatchPassword();\n  const modifyPendingMutation = useTradeAdminModifyPendingOrder();\n  const cancelPendingMutation = useTradeAdminCancelPendingOrder();\n  const modifyPositionMutation = useTradeAdminModifyPosition();\n  const closePositionMutation = useTradeAdminClosePosition();\n\n  const [editOpen, setEditOpen] = useState(false);\n  const [viewOpen, setViewOpen] = useState(false);\n  const [passwordOpen, setPasswordOpen] = useState(false);\n  const [accountViewOpen, setAccountViewOpen] = useState(false);\n  const [accountEditOpen, setAccountEditOpen] = useState(false);\n  const [selectedAccount, setSelectedAccount] = useState<AdminAccount | null>(null);\n  const [accountFormError, setAccountFormError] = useState(\"\");\n  const [accountForm, setAccountForm] = useState<AccountEditForm>({\n    leverage: \"0\",\n    spread_enabled: \"true\",\n    spread_pips: \"0\",\n    commission_per_lot: \"0\",\n    swap_enabled: \"true\",\n    swap_charge: \"0\",\n    status: \"active\",\n  });\n  const [toast, setToast] = useState(\"\");\n  const [touched, setTouched] = useState<Partial<Record<keyof AdminUserUpdatePayload, boolean>>>({});\n  const [activeTab, setActiveTab] = useState<\n    \"Fund History\" | \"Accounts\" | \"Active Trades\" | \"Closed Trades\" | \"Pending Trades\"\n  >(\"Fund History\");\n  const [positionActionOpen, setPositionActionOpen] = useState(false);\n  const [positionAction, setPositionAction] = useState<LivePositionSnapshot | null>(null);\n  const [positionForm, setPositionForm] = useState({\n    stopLoss: \"\",\n    takeProfit: \"\",\n  });\n  const [positionActionError, setPositionActionError] = useState(\"\");\n  const [pendingActionOpen, setPendingActionOpen] = useState(false);\n  const [pendingAction, setPendingAction] = useState<TradeAdminPendingOrder | null>(\n    null\n  );\n  const [pendingEditForm, setPendingEditForm] = useState({\n    price: \"\",\n    stopLoss: \"\",\n    takeProfit: \"\",\n  });\n  const [pendingActionError, setPendingActionError] = useState(\"\");\n  const [liveStatus, setLiveStatus] = useState<\n    \"idle\" | \"connecting\" | \"connected\" | \"error\"\n  >(\"idle\");\n  const [livePositions, setLivePositions] = useState<LivePositionSnapshot[]>([]);\n  const [liveAccountFilter, setLiveAccountFilter] = useState(\"\");\n  const livePositionsRef = useRef<Map<string, LivePositionSnapshot>>(new Map());\n  const closedPositionsRef = useRef<Map<string, number>>(new Map());\n  const wsRef = useRef<WebSocket | null>(null);\n  const [closedPage, setClosedPage] = useState(1);\n  const [closedLimit, setClosedLimit] = useState(20);\n  const [closedAccountFilter, setClosedAccountFilter] = useState(\"\");\n  const [pendingPage, setPendingPage] = useState(1);\n  const [pendingLimit, setPendingLimit] = useState(20);\n  const [pendingAccountFilter, setPendingAccountFilter] = useState(\"\");\n  const [localProfile, setLocalProfile] = useState<{\r\n    name: string;\r\n    email: string;\r\n    phone: string;\r\n    isMailVerified: boolean;\r\n    kycStatus: string;\r\n  }>({\r\n    name: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    isMailVerified: false,\r\n    kycStatus: \"NOT_STARTED\",\r\n  });\r\n  const [txPage, setTxPage] = useState(1);\r\n  const [txLimit, setTxLimit] = useState(20);\r\n  const [txAccountId, setTxAccountId] = useState(\"\");\r\n  const [txType, setTxType] = useState(\"\");\r\n  const [txStatus, setTxStatus] = useState(\"\");\r\n  const [txReferenceId, setTxReferenceId] = useState(\"\");\r\n  const [txSortBy, setTxSortBy] = useState(\"createdAt\");\r\n  const [txSortDir, setTxSortDir] = useState(\"desc\");\r\n  const [fromDate, setFromDate] = useState<string>(() => {\r\n    const year = new Date().getFullYear();\r\n    return `${year}-01-01`;\r\n  });\r\n  const [toDate, setToDate] = useState<string>(() => new Date().toISOString().slice(0, 10));\r\n  const [draftFromDate, setDraftFromDate] = useState<string>(() => {\r\n    const year = new Date().getFullYear();\r\n    return `${year}-01-01`;\r\n  });\r\n  const [draftToDate, setDraftToDate] = useState<string>(() => new Date().toISOString().slice(0, 10));\r\n  const [form, setForm] = useState<AdminUserUpdatePayload>({\r\n    name: \"\",\r\n    phone: \"\",\r\n    isMailVerified: false,\r\n    kycStatus: \"NOT_STARTED\",\r\n    date_of_birth: \"\",\r\n    gender: \"\",\r\n    address_line_1: \"\",\r\n    address_line_2: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    country: \"\",\r\n    pincode: \"\",\r\n  });\r\n  const [passwordForm, setPasswordForm] = useState({\n    newPassword: \"\",\n    confirmPassword: \"\",\n  });\n  const [passwordError, setPasswordError] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [resetPasswordOpen, setResetPasswordOpen] = useState(false);\n  const [resetPasswordType, setResetPasswordType] = useState<\"trade\" | \"watch\">(\n    \"trade\"\n  );\n  const [resetPasswordAccount, setResetPasswordAccount] =\n    useState<AdminAccount | null>(null);\n  const [accountPassword, setAccountPassword] = useState(\"\");\n  const [accountPasswordConfirm, setAccountPasswordConfirm] = useState(\"\");\n  const [showAccountPassword, setShowAccountPassword] = useState(false);\n  const [showAccountPasswordConfirm, setShowAccountPasswordConfirm] =\n    useState(false);\n  const [accountPasswordError, setAccountPasswordError] = useState(\"\");\n\n  const profileFromParams = useMemo(() => {\n    const name = searchParams.get(\"name\") ?? \"\";\n    const email = searchParams.get(\"email\") ?? \"\";\r\n    const phone = searchParams.get(\"phone\") ?? \"\";\r\n    const kycStatus = searchParams.get(\"kycStatus\") ?? \"NOT_STARTED\";\r\n    const isMailVerified = searchParams.get(\"isMailVerified\") === \"true\";\r\n\n    return { name, email, phone, kycStatus, isMailVerified };\n  }, [searchParams]);\n\n  const tabFromParams = searchParams.get(\"tab\") ?? \"\";\n\n  useEffect(() => {\n    const normalized = tabFromParams.toLowerCase();\n    if (\n      normalized === \"active-trades\" ||\n      normalized === \"active_trades\" ||\n      normalized === \"active\" ||\n      normalized === \"positions\"\n    ) {\n      setActiveTab(\"Active Trades\");\n    }\n  }, [tabFromParams]);\n\r\n\t  const accountsQuery = useAdminUserAccounts({\n\t    userId,\n\t    page: 1,\n\t    limit: 50,\n\t  });\n  const accountList = useMemo(\n    () => accountsQuery.data?.data ?? [],\n    [accountsQuery.data?.data]\n  );\n  const accountIds = useMemo(\n    () => accountList.map((account) => account._id).filter(Boolean),\n    [accountList]\n  );\n  const accountIdSet = useMemo(() => new Set(accountIds), [accountIds]);\n\n  const closedTradesQuery = useTradeAdminClosedTrades({\n    page: closedPage,\n    limit: closedLimit,\n    userId: userId ?? \"0\",\n    accountId: closedAccountFilter || undefined,\n    sortBy: \"closeTime\",\n    sortDir: \"desc\",\n  });\n\n  const closedTrades = useMemo(\n    () => closedTradesQuery.data?.data ?? [],\n    [closedTradesQuery.data?.data]\n  );\n  const closedPagination = closedTradesQuery.data?.pagination;\n  const closedTotalPages = closedPagination?.totalPages ?? 1;\n  const closedTotal = closedPagination?.total ?? closedTrades.length;\n  const closedSummary = useMemo(() => {\n    return closedTrades.reduce(\n      (acc, trade) => {\n        acc.pageTrades += 1;\n        acc.totalVolume += trade.volume ?? 0;\n        acc.totalPnl += trade.realizedPnL ?? 0;\n        if ((trade.realizedPnL ?? 0) > 0) acc.wins += 1;\n        return acc;\n      },\n      { pageTrades: 0, totalVolume: 0, totalPnl: 0, wins: 0 }\n    );\n  }, [closedTrades]);\n\n  const pendingOpenQuery = useTradeAdminPendingOpenOrders({\n    page: pendingPage,\n    limit: pendingLimit,\n    userId: userId ?? \"0\",\n    accountId: pendingAccountFilter || undefined,\n    sortBy: \"createdAt\",\n    sortDir: \"desc\",\n  });\n\n  const pendingOpenTrades = useMemo(\n    () => pendingOpenQuery.data?.data ?? [],\n    [pendingOpenQuery.data?.data]\n  );\n  const pendingSymbols = useMemo(\n    () =>\n      Array.from(\n        new Set(\n          pendingOpenTrades\n            .map((order) => (order.symbol ?? \"\").toUpperCase())\n            .filter(Boolean)\n        )\n      ),\n    [pendingOpenTrades]\n  );\n  const marketToken = getAccessTokenFromCookie();\n  const pendingQuotes = useLiveQuotesBySymbols(marketToken, pendingSymbols);\n  const pendingPagination = pendingOpenQuery.data?.pagination;\n  const pendingTotalPages = pendingPagination?.totalPages ?? 1;\n  const pendingTotal = pendingPagination?.total ?? pendingOpenTrades.length;\n  const pendingSummary = useMemo(() => {\n    return pendingOpenTrades.reduce(\n      (acc, order) => {\n        acc.pageOrders += 1;\n        const side = (order.side ?? \"\").toUpperCase();\n        if (side === \"BUY\") acc.buy += 1;\n        if (side === \"SELL\") acc.sell += 1;\n        acc.totalVolume += order.volume ?? 0;\n        return acc;\n      },\n      { pageOrders: 0, buy: 0, sell: 0, totalVolume: 0 }\n    );\n  }, [pendingOpenTrades]);\n\r\n\t  const accountOptions = useMemo<SelectOption[]>(() => {\n\t    if (!accountList.length) {\n      return [\r\n        {\r\n          value: \"\",\r\n          label: accountsQuery.isLoading ? \"Loading accounts...\" : \"All Accounts\",\r\n          dotClass: \"bg-slate-300\",\r\n        },\r\n      ];\r\n    }\r\n\r\n    return [\r\n      { value: \"\", label: \"All Accounts\", dotClass: \"bg-slate-300\" },\r\n\t      ...accountList.map((account) => {\n        const typeLabel =\r\n          account.account_type?.toLowerCase() === \"demo\" ? \"Demo\" : \"Live\";\r\n        const planLabel = account.plan_name ? ` â€¢ ${account.plan_name}` : \"\";\r\n        return {\r\n          value: account._id,\r\n          label: `${account.account_number ?? account._id} â€¢ ${typeLabel}${planLabel}`,\r\n          dotClass:\r\n            account.account_type?.toLowerCase() === \"demo\"\r\n              ? \"bg-slate-500\"\r\n              : \"bg-emerald-500\",\r\n        };\r\n      }),\r\n    ];\r\n\t  }, [accountList, accountsQuery.isLoading]);\n\n\t  const nonDemoAccounts = useMemo(\n\t    () =>\n\t      accountList.filter(\n\t        (account) => (account.account_type ?? \"\").toLowerCase() !== \"demo\"\n\t      ),\n\t    [accountList]\n\t  );\n\n\t  const accountSummary = useMemo(\n\t    () =>\n\t      nonDemoAccounts.reduce(\n\t        (acc, account) => ({\n\t          totalBalance: acc.totalBalance + (account.balance ?? 0),\n\t          totalHoldBalance: acc.totalHoldBalance + (account.hold_balance ?? 0),\n\t          totalEquity: acc.totalEquity + (account.equity ?? 0),\n\t        }),\n\t        { totalBalance: 0, totalHoldBalance: 0, totalEquity: 0 }\n\t      ),\n\t    [nonDemoAccounts]\n\t  );\n\n\t  const transactionsQuery = useAdminUserTransactions({\n    userId,\r\n    page: txPage,\r\n    limit: txLimit,\r\n    fromDate: fromDate || undefined,\r\n    toDate: toDate || undefined,\r\n    account: txAccountId || undefined,\r\n    type: txType || undefined,\r\n    status: txStatus || undefined,\r\n    referenceId: txReferenceId || undefined,\r\n    sortBy: txSortBy || undefined,\r\n    sortDir: txSortDir || undefined,\r\n  });\r\n\r\n  const txData = transactionsQuery.data?.data ?? [];\r\n  const txPagination = transactionsQuery.data?.pagination;\r\n  const txSummary = transactionsQuery.data?.summary;\r\n  const txTotalPages = txPagination?.totalPages ?? 1;\r\n  const txTotal = txPagination?.total ?? txData.length;\r\n\r\n  const formatAmount = (value?: number) => {\n    if (value === undefined || value === null) return \"--\";\n    return value.toLocaleString(\"en-IN\");\n  };\n\n  const getAmountClass = (\n    value?: number,\n    positiveClass = \"text-emerald-600\"\n  ) => {\n    if (value === undefined || value === null || Number.isNaN(value))\n      return \"text-[var(--text-muted)]\";\n    if (value < 0) return \"text-rose-600\";\n    if (value === 0) return \"text-slate-600\";\n    return positiveClass;\n  };\n\r\n  const formatDateTime = (value?: string) => {\n    if (!value) return \"--\";\n    const date = new Date(value);\n    if (Number.isNaN(date.getTime())) return value;\n    return date.toLocaleString(\"en-GB\", {\n      day: \"2-digit\",\n      month: \"2-digit\",\r\n      year: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n      second: \"2-digit\",\n    });\n  };\n\n  const formatLiveNumber = (value?: number, digits = 2) => {\n    if (value === undefined || value === null || Number.isNaN(value)) return \"--\";\n    return value.toLocaleString(\"en-IN\", {\n      minimumFractionDigits: digits,\n      maximumFractionDigits: digits,\n    });\n  };\n\n  const formatLivePrice = (value?: number) => {\n    if (value === undefined || value === null || Number.isNaN(value)) return \"--\";\n    const digits = Math.abs(value) >= 100 ? 2 : 5;\n    return formatLiveNumber(value, digits);\n  };\n\n  const parseNullableNumber = (value: string) => {\n    const trimmed = value.trim();\n    if (!trimmed) return null;\n    const num = Number(trimmed);\n    if (!Number.isFinite(num)) return null;\n    return num;\n  };\n\n  const getLiveStatusClass = (status: string) => {\n    if (status === \"connected\")\n      return \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\";\n    if (status === \"connecting\")\n      return \"border-amber-500/40 bg-amber-500/10 text-amber-700\";\n    if (status === \"error\")\n      return \"border-rose-500/40 bg-rose-500/10 text-rose-700\";\n    return \"border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)]\";\n  };\n\n  const getSideClass = (side?: string) => {\n    const normalized = (side ?? \"\").toUpperCase();\n    if (normalized === \"BUY\")\n      return \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\";\n    if (normalized === \"SELL\")\n      return \"border-rose-500/40 bg-rose-500/10 text-rose-700\";\n    return \"border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)]\";\n  };\n\n  const getOrderTypeClass = (orderType?: string) => {\n    const normalized = (orderType ?? \"\").toUpperCase();\n    if (normalized === \"MARKET\")\n      return \"border-violet-500/40 bg-violet-500/10 text-violet-700\";\n    if (normalized.includes(\"LIMIT\"))\n      return \"border-sky-500/40 bg-sky-500/10 text-sky-700\";\n    if (normalized.includes(\"STOP\"))\n      return \"border-amber-500/40 bg-amber-500/10 text-amber-700\";\n    return \"border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)]\";\n  };\n\n  const getPnlClass = (value?: number) => {\n    if (value === undefined || value === null || Number.isNaN(value))\n      return \"text-[var(--text-muted)]\";\n    if (value > 0) return \"text-emerald-600\";\n    if (value < 0) return \"text-rose-600\";\n    return \"text-[var(--text-muted)]\";\n  };\n\n  const getPendingLivePrice = (order: {\n    symbol?: string;\n    side?: string;\n  }) => {\n    const symbol = (order.symbol ?? \"\").toUpperCase();\n    if (!symbol) return undefined;\n    const quote = pendingQuotes[symbol];\n    if (!quote) return undefined;\n    const bid = Number(quote.bid);\n    const ask = Number(quote.ask);\n    const side = (order.side ?? \"\").toUpperCase();\n    if (side === \"BUY\" && Number.isFinite(ask)) return ask;\n    if (side === \"SELL\" && Number.isFinite(bid)) return bid;\n    if (Number.isFinite(ask)) return ask;\n    if (Number.isFinite(bid)) return bid;\n    return undefined;\n  };\n\n  const getPendingTriggerInfo = (order: {\n    orderType?: string;\n    orderKind?: string;\n    side?: string;\n    price?: number;\n  }) => {\n    const livePrice = getPendingLivePrice(order);\n    const target = order.price;\n    if (\n      livePrice === undefined ||\n      target === undefined ||\n      target === null ||\n      Number.isNaN(target)\n    ) {\n      return { status: \"na\" as const };\n    }\n\n    const side = (order.side ?? \"\").toUpperCase();\n    const kind = (order.orderType ?? order.orderKind ?? \"\").toUpperCase();\n    let triggered = false;\n\n    if (kind.includes(\"LIMIT\")) {\n      if (side === \"BUY\") triggered = livePrice <= target;\n      if (side === \"SELL\") triggered = livePrice >= target;\n    } else if (kind.includes(\"STOP\")) {\n      if (side === \"BUY\") triggered = livePrice >= target;\n      if (side === \"SELL\") triggered = livePrice <= target;\n    }\n\n    if (triggered) return { status: \"ready\" as const };\n\n    return {\n      status: \"away\" as const,\n      value: Math.abs(target - livePrice),\n    };\n  };\n\n  const filteredLivePositions = useMemo(() => {\n    if (!liveAccountFilter) return livePositions;\n    return livePositions.filter(\n      (position) => position.accountId === liveAccountFilter\n    );\n  }, [liveAccountFilter, livePositions]);\n\n  const markPositionClosed = useCallback((positionId: string) => {\n    if (!positionId) return;\n    closedPositionsRef.current.set(positionId, Date.now());\n    if (livePositionsRef.current.delete(positionId)) {\n      setLivePositions(Array.from(livePositionsRef.current.values()));\n    }\n    while (closedPositionsRef.current.size > 500) {\n      const oldestKey = closedPositionsRef.current.keys().next().value;\n      if (!oldestKey) break;\n      closedPositionsRef.current.delete(oldestKey);\n    }\n  }, []);\n\n  const liveSummary = useMemo(\n    () =>\n      filteredLivePositions.reduce(\n        (acc, position) => {\n          acc.total += 1;\n          const side = (position.side ?? \"\").toUpperCase();\n          if (side === \"BUY\") acc.buy += 1;\n          if (side === \"SELL\") acc.sell += 1;\n          acc.pnl += position.floatingPnL ?? 0;\n          acc.last = position.updatedAt ?? acc.last;\n          return acc;\n        },\n        { total: 0, buy: 0, sell: 0, pnl: 0, last: \"\" }\n      ),\n    [filteredLivePositions]\n  );\n\n  const resolveTxType = (tx: AdminTransaction) =>\n    (tx.transactionType ?? tx.type ?? \"\").toString();\n  const resolveTxStatus = (tx: AdminTransaction) =>\n    (tx.status ?? \"\").toString();\n\n  useEffect(() => {\n    if (activeTab !== \"Active Trades\") {\n      if (wsRef.current) {\n        wsRef.current.close(1000, \"active_tab_change\");\n        wsRef.current = null;\n      }\n      setLiveStatus(\"idle\");\n      return;\n    }\n\n    if (!accountIds.length) {\n      if (wsRef.current) {\n        wsRef.current.close(1000, \"no_accounts\");\n        wsRef.current = null;\n      }\n      setLiveStatus(\"idle\");\n      return;\n    }\n    const socketUrl = resolveAccountSocketUrl();\n    if (!socketUrl) {\n      if (wsRef.current) {\n        wsRef.current.close(1000, \"no_socket_url\");\n        wsRef.current = null;\n      }\n      setLiveStatus(\"error\");\n      return;\n    }\n\n    const existing = wsRef.current;\n    if (\n      existing &&\n      (existing.readyState === WebSocket.OPEN ||\n        existing.readyState === WebSocket.CONNECTING)\n    ) {\n      if (existing.readyState === WebSocket.OPEN) {\n        accountIds.forEach((accountId) => {\n          existing.send(\n            JSON.stringify({\n              type: \"identify\",\n              accountId,\n            })\n          );\n        });\n      }\n      return;\n    }\n\n    setLiveStatus(\"connecting\");\n    const ws = new WebSocket(socketUrl);\n    wsRef.current = ws;\n\n    const sendIdentifyAll = () => {\n      accountIds.forEach((accountId) => {\n        ws.send(\n          JSON.stringify({\n            type: \"identify\",\n            accountId,\n          })\n        );\n      });\n    };\n\n    ws.onopen = () => {\n      setLiveStatus(\"connected\");\n      sendIdentifyAll();\n    };\n\n    ws.onmessage = (event) => {\n      const raw =\n        typeof event.data === \"string\"\n          ? event.data\n          : event.data instanceof ArrayBuffer\n          ? new TextDecoder().decode(event.data)\n          : \"\";\n      const messages = parseSocketMessages(raw);\n      if (!messages.length) return;\n\n      messages.forEach((msg) => {\n        const type = (msg?.type ?? \"\").toString().toLowerCase();\n        const data = msg?.data ?? msg;\n\n        if (!data?.accountId || !accountIdSet.has(data.accountId)) return;\n\n        if (type === \"live_account\") {\n          return;\n        }\n\n        if (\n          type !== \"live_position\" &&\n          type.includes(\"position\") &&\n          (type.includes(\"close\") || type.includes(\"closed\"))\n        ) {\n          const positionId = data.positionId ?? data.position_id;\n          if (positionId) {\n            markPositionClosed(positionId);\n          }\n          return;\n        }\n\n        if (type === \"live_position\") {\n          const positionId = data.positionId ?? data.position_id;\n          if (!positionId) return;\n          if (closedPositionsRef.current.has(positionId)) return;\n\n          const rawStatus = data.status ?? data.positionStatus ?? \"\";\n          const normalizedStatus = rawStatus.toString().toLowerCase();\n          const volumeValue =\n            typeof data.volume === \"number\" ? data.volume : Number(data.volume);\n          const isClosedFlag = data.isClosed === true || data.closed === true;\n          const isOpenFlag = data.isOpen === false || data.open === false;\n          const closeTime =\n            data.closeTime ??\n            data.closedAt ??\n            data.closed_at ??\n            data.close_time ??\n            data.closeTimestamp ??\n            data.close_ts;\n          const closePrice =\n            data.closePrice ?? data.close_price ?? data.closedPrice ?? data.closed_price;\n          const closeReasonRaw = data.closeReason ?? data.close_reason ?? data.reason ?? \"\";\n          const closeReason = closeReasonRaw.toString().toLowerCase();\n          const hasCloseReason = closeReason.length > 0;\n          const closeReasonMatches =\n            hasCloseReason &&\n            (closeReason.includes(\"stop\") ||\n              closeReason.includes(\"sl\") ||\n              closeReason.includes(\"take\") ||\n              closeReason.includes(\"tp\") ||\n              closeReason.includes(\"close\") ||\n              closeReason.includes(\"liquid\") ||\n              closeReason.includes(\"margin\"));\n\n          if (\n            isClosedFlag ||\n            isOpenFlag ||\n            normalizedStatus === \"closed\" ||\n            normalizedStatus === \"close\" ||\n            normalizedStatus === \"closing\" ||\n            normalizedStatus === \"cancelled\" ||\n            normalizedStatus === \"canceled\" ||\n            Boolean(closeTime) ||\n            Boolean(closePrice) ||\n            closeReasonMatches ||\n            (Number.isFinite(volumeValue) && volumeValue <= 0)\n          ) {\n            markPositionClosed(positionId);\n            return;\n          }\n\n          const prev = livePositionsRef.current.get(positionId);\n          const snapshot: LivePositionSnapshot = {\n            positionId,\n            accountId: data.accountId,\n            symbol: data.symbol ?? prev?.symbol,\n            side: data.side ?? prev?.side,\n            volume: Number.isFinite(volumeValue) ? volumeValue : prev?.volume,\n            openPrice: data.openPrice ?? prev?.openPrice,\n            currentPrice: data.currentPrice ?? prev?.currentPrice,\n            floatingPnL: data.floatingPnL ?? prev?.floatingPnL,\n            stopLoss: data.stopLoss ?? prev?.stopLoss ?? null,\n            takeProfit: data.takeProfit ?? prev?.takeProfit ?? null,\n            openTime: data.openTime ?? prev?.openTime,\n            updatedAt: new Date().toISOString(),\n          };\n          livePositionsRef.current.set(positionId, snapshot);\n          setLivePositions(Array.from(livePositionsRef.current.values()));\n        }\n      });\n    };\n\n    ws.onerror = () => setLiveStatus(\"error\");\n    ws.onclose = () => {\n      wsRef.current = null;\n      setLiveStatus(\"idle\");\n    };\n\n    return () => {\n      ws.close(1000, \"component_unmount\");\n      wsRef.current = null;\n    };\n  }, [activeTab, accountIds, accountIdSet, markPositionClosed]);\n\r\n  useEffect(() => {\r\n    const profile = userQuery.data;\r\n    const source = profile ?? profileFromParams;\r\n\r\n    setLocalProfile({\r\n      name: source.name ?? \"\",\r\n      email: source.email ?? \"\",\r\n      phone: source.phone ?? \"\",\r\n      isMailVerified: Boolean(source.isMailVerified),\r\n      kycStatus: source.kycStatus ?? \"NOT_STARTED\",\r\n    });\r\n\r\n    setForm({\r\n      name: source.name ?? \"\",\r\n      phone: source.phone ?? \"\",\r\n      isMailVerified: Boolean(source.isMailVerified),\r\n      kycStatus: source.kycStatus ?? \"NOT_STARTED\",\r\n      date_of_birth: profile?.date_of_birth\r\n        ? profile.date_of_birth.slice(0, 10)\r\n        : \"\",\r\n      gender: profile?.gender ?? \"\",\r\n      address_line_1: profile?.address_line_1 ?? \"\",\r\n      address_line_2: profile?.address_line_2 ?? \"\",\r\n      city: profile?.city ?? \"\",\r\n      state: profile?.state ?? \"\",\r\n      country: profile?.country ?? \"\",\r\n      pincode: profile?.pincode ?? \"\",\r\n    });\r\n\r\n    setTouched({});\r\n  }, [profileFromParams, userQuery.data]);\r\n\r\n  useEffect(() => {\n    if (!toast) return;\n    const t = setTimeout(() => setToast(\"\"), 3000);\n    return () => clearTimeout(t);\n  }, [toast]);\n\n  useEffect(() => {\n    if (!resetPasswordOpen) return;\n    setAccountPassword(\"\");\n    setAccountPasswordConfirm(\"\");\n    setAccountPasswordError(\"\");\n    setShowAccountPassword(false);\n    setShowAccountPasswordConfirm(false);\n  }, [resetPasswordOpen, resetPasswordAccount, resetPasswordType]);\n\r\n  const displayName = localProfile.name || \"User\";\n  const displayEmail = localProfile.email || \"--\";\n  const selectedAccountTypeMeta = useMemo(\n    () => getAccountTypeMeta(selectedAccount?.account_type),\n    [selectedAccount?.account_type]\n  );\n  const SelectedAccountTypeIcon = selectedAccountTypeMeta.icon;\n\n  const kycBadgeClass =\n    kycStyles[localProfile.kycStatus ?? \"\"] ||\r\n    \"border-[var(--border-subtle)] bg-[var(--chip-bg)] text-[var(--text-muted)]\";\r\n\r\n  const mailBadgeClass = localProfile.isMailVerified\r\n    ? \"border-emerald-500/40 bg-emerald-500/5 text-emerald-600\"\r\n    : \"border-amber-500/40 bg-amber-500/5 text-amber-600\";\r\n\r\n  const canSubmit = useMemo(\r\n    () => !updateMutation.isPending,\r\n    [updateMutation.isPending]\r\n  );\r\n\r\n  const handleChange =\r\n    (key: keyof AdminUserUpdatePayload) =>\r\n    (event: ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n      const value = event.target.value;\r\n      setForm((prev) => ({ ...prev, [key]: value }));\r\n      setTouched((prev) => ({ ...prev, [key]: true }));\r\n    };\r\n\r\n  const handleSubmit = (event: FormEvent) => {\r\n    event.preventDefault();\r\n    if (!userId) return;\r\n\r\n    const payload = (Object.keys(form) as Array<keyof AdminUserUpdatePayload>).reduce(\r\n      (acc, key) => {\r\n        if (touched[key]) {\r\n          acc[key] = form[key] as never;\r\n        }\r\n        return acc;\r\n      },\r\n      {} as AdminUserUpdatePayload\r\n    );\r\n\r\n    if (Object.keys(payload).length === 0) {\r\n      setToast(\"No changes to update.\");\r\n      setEditOpen(false);\r\n      return;\r\n    }\r\n\r\n    updateMutation.mutate(\r\n      { id: userId, payload },\r\n      {\r\n        onSuccess: (resp: any) => {\r\n          const msg =\r\n            resp?.message || resp?.data?.message || \"Profile updated successfully\";\r\n          const nextProfile = {\r\n            name: form.name ?? localProfile.name,\r\n            email: localProfile.email,\r\n            phone: form.phone ?? localProfile.phone,\r\n            isMailVerified: form.isMailVerified ?? localProfile.isMailVerified,\r\n            kycStatus: form.kycStatus ?? localProfile.kycStatus,\r\n          };\r\n\r\n          setLocalProfile(nextProfile);\r\n          setTouched({});\r\n          setEditOpen(false);\r\n          setToast(msg);\r\n        },\r\n        onError: (err: any) => {\r\n          const msg =\r\n            err?.response?.data?.message ||\r\n            err?.message ||\r\n            \"Update failed. Please try again.\";\r\n          setToast(msg);\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleCopy = async (value: string, label: string) => {\n    if (!value) return;\n    try {\n      await navigator.clipboard.writeText(value);\n      setToast(`${label} copied.`);\n    } catch {\n      setToast(\"Copy failed.\");\n    }\n  };\n\n  const openAccountView = (account: AdminAccount) => {\n    setSelectedAccount(account);\n    setAccountViewOpen(true);\n  };\n\n  const openAccountEdit = (account: AdminAccount) => {\n    setSelectedAccount(account);\n    setAccountForm(buildAccountEditForm(account));\n    setAccountFormError(\"\");\n    setAccountEditOpen(true);\n  };\n\n  const closeAccountEdit = () => {\n    setAccountEditOpen(false);\n    setAccountFormError(\"\");\n  };\n\n  const openPositionAction = (position: LivePositionSnapshot) => {\n    setPositionAction(position);\n    setPositionForm({\n      stopLoss: position.stopLoss ? String(position.stopLoss) : \"\",\n      takeProfit: position.takeProfit ? String(position.takeProfit) : \"\",\n    });\n    setPositionActionError(\"\");\n    setPositionActionOpen(true);\n  };\n\n  const closePositionAction = () => {\n    setPositionActionOpen(false);\n    setPositionAction(null);\n    setPositionActionError(\"\");\n  };\n\n  const openPendingAction = (order: TradeAdminPendingOrder) => {\n    setPendingAction(order);\n    setPendingEditForm({\n      price: order.price ? String(order.price) : \"\",\n      stopLoss: order.stopLoss ? String(order.stopLoss) : \"\",\n      takeProfit: order.takeProfit ? String(order.takeProfit) : \"\",\n    });\n    setPendingActionError(\"\");\n    setPendingActionOpen(true);\n  };\n\n  const closePendingAction = () => {\n    setPendingActionOpen(false);\n    setPendingAction(null);\n    setPendingActionError(\"\");\n  };\n\n  const handlePositionModifySubmit = (event: FormEvent) => {\n    event.preventDefault();\n    if (!positionAction) return;\n\n    const stopLoss = parseNullableNumber(positionForm.stopLoss);\n    const takeProfit = parseNullableNumber(positionForm.takeProfit);\n\n    modifyPositionMutation.mutate(\n      {\n        accountId: positionAction.accountId,\n        positionId: positionAction.positionId,\n        userId,\n        stopLoss: stopLoss ?? undefined,\n        takeProfit: takeProfit ?? undefined,\n      },\n      {\n        onSuccess: () => {\n          setToast(\"Position updated.\");\n          closePositionAction();\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            \"Position update failed.\";\n          setPositionActionError(msg);\n        },\n      }\n    );\n  };\n\n  const handlePendingModifySubmit = (event: FormEvent) => {\n    event.preventDefault();\n    if (!pendingAction) return;\n\n    const price = parseNullableNumber(pendingEditForm.price);\n    const stopLoss = parseNullableNumber(pendingEditForm.stopLoss);\n    const takeProfit = parseNullableNumber(pendingEditForm.takeProfit);\n\n    if (price === null && stopLoss === null && takeProfit === null) {\n      setPendingActionError(\"Enter price or stopLoss/takeProfit.\");\n      return;\n    }\n\n    modifyPendingMutation.mutate(\n      {\n        accountId: pendingAction.accountId,\n        orderId: pendingAction.orderId,\n        price: price ?? undefined,\n        stopLoss: stopLoss ?? undefined,\n        takeProfit: takeProfit ?? undefined,\n      },\n      {\n        onSuccess: () => {\n          setToast(\"Pending order updated.\");\n          closePendingAction();\n          pendingOpenQuery.refetch();\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            \"Pending order update failed.\";\n          setPendingActionError(msg);\n        },\n      }\n    );\n  };\n\n  const handlePendingCancel = (order: TradeAdminPendingOrder) => {\n    const cancelUserId = order.userId ?? userId ?? \"\";\n    if (!cancelUserId) {\n      setToast(\"User ID is required to cancel this order.\");\n      return;\n    }\n    cancelPendingMutation.mutate(\n      { accountId: order.accountId, orderId: order.orderId, userId: cancelUserId },\n      {\n        onSuccess: () => {\n          setToast(\"Pending order cancelled.\");\n          pendingOpenQuery.refetch();\n          if (pendingAction?.orderId === order.orderId) {\n            closePendingAction();\n          }\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            \"Cancel pending order failed.\";\n          setToast(msg);\n        },\n      }\n    );\n  };\n\n  const handlePositionClose = (position: LivePositionSnapshot) => {\n    closePositionMutation.mutate(\n      {\n        accountId: position.accountId,\n        positionId: position.positionId,\n        userId,\n      },\n      {\n        onSuccess: () => {\n          markPositionClosed(position.positionId);\n          setToast(\"Position closed.\");\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            \"Close position failed.\";\n          setToast(msg);\n        },\n      }\n    );\n  };\n\n  const handleAccountFormField =\n    <K extends keyof AccountEditForm>(key: K) =>\n    (event: ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n      setAccountForm((prev) => ({\n        ...prev,\n        [key]: event.target.value as AccountEditForm[K],\n      }));\n    };\n\n  const handleAccountUpdateSubmit = (event: FormEvent) => {\n    event.preventDefault();\n    if (!selectedAccount?._id) return;\n\n    setAccountFormError(\"\");\n\n    const leverage = Number(accountForm.leverage);\n    const spreadPips = Number(accountForm.spread_pips);\n    const commissionPerLot = Number(accountForm.commission_per_lot);\n    const swapCharge = Number(accountForm.swap_charge);\n\n    const numericValues = [leverage, spreadPips, commissionPerLot, swapCharge];\n    const invalidNumber = numericValues.some(\n      (value) => Number.isNaN(value) || !Number.isFinite(value) || value < 0\n    );\n\n    if (invalidNumber) {\n      setAccountFormError(\"Please enter valid numeric values (0 or greater).\");\n      return;\n    }\n\n    const payload: AdminAccountUpdatePayload = {\n      leverage,\n      spread_enabled: accountForm.spread_enabled === \"true\",\n      spread_pips: spreadPips,\n      commission_per_lot: commissionPerLot,\n      swap_enabled: accountForm.swap_enabled === \"true\",\n      swap_charge: swapCharge,\n      status: accountForm.status,\n    };\n\n    updateAccountMutation.mutate(\n      { accountId: selectedAccount._id, payload },\n      {\n        onSuccess: (updatedAccount) => {\n          if (updatedAccount) {\n            setSelectedAccount(updatedAccount);\n          }\n          setToast(\"Account updated successfully.\");\n          setAccountEditOpen(false);\n        },\n        onError: (error) => {\n          const err = error as {\n            response?: { data?: { message?: string } };\n            message?: string;\n          };\n          setAccountFormError(\n            err?.response?.data?.message || err?.message || \"Failed to update account.\"\n          );\n        },\n      }\n    );\n  };\n\n  const handlePasswordSubmit = (event: FormEvent) => {\n    event.preventDefault();\n    if (!userId) return;\n    setPasswordError(\"\");\n\r\n    const newPassword = passwordForm.newPassword.trim();\r\n    const confirmPassword = passwordForm.confirmPassword.trim();\r\n\r\n    if (!newPassword || !confirmPassword) {\r\n      setPasswordError(\"Please enter and confirm the new password.\");\r\n      return;\r\n    }\r\n    if (newPassword.length < 6) {\r\n      setPasswordError(\"Password must be at least 6 characters.\");\r\n      return;\r\n    }\r\n    if (newPassword !== confirmPassword) {\r\n      setPasswordError(\"Passwords do not match.\");\r\n      return;\r\n    }\r\n\r\n    changePasswordMutation.mutate(\r\n      { userId, newPassword },\r\n      {\r\n        onSuccess: (resp: any) => {\r\n          const msg =\r\n            resp?.message ||\r\n            resp?.data?.message ||\r\n            \"Password updated successfully\";\r\n          setToast(msg);\r\n          setPasswordForm({ newPassword: \"\", confirmPassword: \"\" });\r\n          setPasswordOpen(false);\r\n        },\r\n        onError: (err: any) => {\r\n          const msg =\r\n            err?.response?.data?.message ||\r\n            err?.message ||\r\n            \"Unable to update password.\";\r\n          setPasswordError(msg);\r\n        },\r\n      }\n    );\n  };\n\n  const openResetPassword = (account: AdminAccount, type: \"trade\" | \"watch\") => {\n    setResetPasswordAccount(account);\n    setResetPasswordType(type);\n    setResetPasswordOpen(true);\n  };\n\n  const closeResetPassword = () => {\n    setResetPasswordOpen(false);\n  };\n\n  const handleResetAccountPassword = () => {\n    setAccountPasswordError(\"\");\n    const accountId = resetPasswordAccount?._id;\n    if (!accountId) {\n      setAccountPasswordError(\"Select an account first.\");\n      return;\n    }\n    const password = accountPassword.trim();\n    const confirmation = accountPasswordConfirm.trim();\n    if (!password || !confirmation) {\n      setAccountPasswordError(\"Both password fields are required.\");\n      return;\n    }\n    if (password.length < 6) {\n      setAccountPasswordError(\"Password must be at least 6 characters.\");\n      return;\n    }\n    if (password !== confirmation) {\n      setAccountPasswordError(\"Passwords do not match.\");\n      return;\n    }\n\n    const mutation =\n      resetPasswordType === \"trade\"\n        ? resetTradePasswordMutation\n        : resetWatchPasswordMutation;\n    const label = resetPasswordType === \"trade\" ? \"Trade\" : \"Investor\";\n\n    mutation.mutate(\n      { accountId, newPassword: password },\n      {\n        onSuccess: (resp) => {\n          setToast(resp?.message || `${label} password reset.`);\n          closeResetPassword();\n        },\n        onError: (err: any) => {\n          const msg =\n            err?.response?.data?.message ||\n            err?.message ||\n            `Failed to reset ${label.toLowerCase()} password.`;\n          setAccountPasswordError(msg);\n        },\n      }\n    );\n  };\n\r\n  return (\n    <div className=\"container-pad w-full max-w-full min-w-0 overflow-x-hidden space-y-5 text-[var(--foreground)]\">\n      <div className=\"flex min-w-0 flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-center sm:justify-between\">\n        <button\r\n          onClick={() => router.back()}\r\n          className=\"inline-flex items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\"\r\n        >\r\n          <ChevronLeft size={16} /> Back\r\n        </button>\r\n\r\n        <div className=\"flex w-full flex-wrap items-center gap-2 sm:w-auto sm:justify-end\">\n          <button className=\"inline-flex w-full sm:w-auto items-center justify-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\">\r\n            <span className=\"h-7 w-7 rounded-md bg-[var(--primary)]/10 text-[var(--primary)] flex items-center justify-center\">\r\n              <Download size={14} />\r\n            </span>\r\n            Export Trades\r\n          </button>\r\n          <button className=\"inline-flex w-full sm:w-auto items-center justify-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\">\r\n            <span className=\"h-7 w-7 rounded-md bg-emerald-500/10 text-emerald-600 flex items-center justify-center\">\r\n              <Download size={14} />\r\n            </span>\r\n            Export Funds\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-4 sm:p-5\">\r\n        {userQuery.isLoading ? (\r\n          <div className=\"py-6\">\r\n            <GlobalLoader />\r\n          </div>\r\n        ) : userQuery.isError ? (\r\n          <div className=\"flex flex-col gap-2 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700\">\r\n            <span>Unable to load latest user data from server.</span>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => userQuery.refetch()}\r\n              className=\"w-fit rounded-md border border-red-200 bg-white px-3 py-1 text-xs font-semibold hover:bg-red-100\"\r\n            >\r\n              Retry\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex min-w-0 flex-col gap-4 lg:flex-row lg:flex-wrap lg:items-center lg:justify-between\">\n            <div className=\"min-w-0 flex-1\">\n              <h2 className=\"text-lg sm:text-xl font-semibold\">{displayName}</h2>\n              <div className=\"mt-1 flex min-w-0 flex-wrap items-center gap-4 text-sm text-[var(--text-muted)]\">\n                <span className=\"inline-flex min-w-0 flex-wrap items-center gap-1.5 break-all\">\n                  <Mail size={14} />\n                  {displayEmail}\n                  {displayEmail && displayEmail !== \"--\" && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleCopy(displayEmail, \"Email\")}\r\n                      className=\"inline-flex h-6 w-6 items-center justify-center rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)] hover:bg-[var(--hover-bg)]\"\r\n                      aria-label=\"Copy email\"\r\n                    >\r\n                      <Copy size={12} />\r\n                    </button>\r\n                  )}\r\n                </span>\r\n                <span className=\"inline-flex min-w-0 flex-wrap items-center gap-1.5 break-all\">\n                  <Phone size={14} />\n                  {localProfile.phone || \"--\"}\n                  {localProfile.phone && localProfile.phone !== \"--\" && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleCopy(localProfile.phone, \"Phone\")}\r\n                      className=\"inline-flex h-6 w-6 items-center justify-center rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] text-[var(--text-muted)] hover:bg-[var(--hover-bg)]\"\r\n                      aria-label=\"Copy phone\"\r\n                    >\r\n                      <Copy size={12} />\r\n                    </button>\r\n                  )}\r\n                </span>\r\n              </div>\r\n\r\n              <div className=\"mt-3 flex flex-wrap items-center gap-2 text-xs\">\r\n                <span\r\n                  className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 uppercase tracking-wide ${mailBadgeClass}`}\r\n                >\r\n                  <Mail size={12} />\r\n                  {localProfile.isMailVerified ? \"MAIL VERIFIED\" : \"MAIL UNVERIFIED\"}\r\n                </span>\r\n                <span\r\n                  className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 uppercase tracking-wide ${kycBadgeClass}`}\r\n                >\r\n                  <ShieldCheck size={12} />\r\n                  KYC {(localProfile.kycStatus || \"STATUS\").replaceAll(\"_\", \" \")}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex w-full flex-wrap items-center gap-2 lg:w-auto lg:justify-end\">\n              <button\n                onClick={() => setViewOpen(true)}\n                className=\"inline-flex w-full sm:w-auto items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\"\n              >\n                <Eye size={16} /> View Details\n              </button>\n              <button\n                onClick={() => setEditOpen(true)}\n                className=\"inline-flex w-full sm:w-auto items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\"\n              >\n                <Pencil size={16} /> Update\n              </button>\n              <button\n                onClick={() => setPasswordOpen(true)}\n                className=\"inline-flex w-full sm:w-auto items-center gap-2 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-sm font-medium hover:bg-[var(--hover-bg)]\"\n              >\n                <KeyRound size={16} /> Change Password\n              </button>\n            </div>\n          </div>\r\n        )}\r\n      </div>\r\n\r\n\t      <div className=\"flex flex-wrap gap-2\">\n\t        {(\n\t          [\"Fund History\", \"Accounts\", \"Active Trades\", \"Closed Trades\", \"Pending Trades\"] as const\n\t        ).map((tab) => (\n            <button\n              key={tab}\n              onClick={() => setActiveTab(tab)}\n              className={`rounded-full border px-4 py-2 text-sm font-medium transition ${\n                activeTab === tab\n                  ? \"border-[var(--primary)]/40 bg-[var(--primary)]/10 text-[var(--primary)]\"\n                  : \"border-[var(--card-border)] bg-[var(--card-bg)] hover:bg-[var(--hover-bg)]\"\n              }`}\n            >\n              {tab}\n            </button>\n          ))}\n      </div>\n\r\n\t      {activeTab === \"Fund History\" && (\n\t        <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-5\">\n          <div className=\"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between\">\r\n            <div>\r\n              <h3 className=\"text-lg font-semibold\">Fund - Withdrawal & Deposits</h3>\r\n              <div className=\"mt-1 flex flex-wrap items-center gap-3 text-xs text-[var(--text-muted)]\">\r\n                <span>Total: {txTotal}</span>\r\n                {txSummary?.totalAmount !== undefined && (\r\n                  <span>Total Amount: {txSummary.totalAmount.toLocaleString(\"en-IN\")}</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-wrap items-end gap-2\">\r\n              <div className=\"flex w-full flex-col gap-1 sm:w-auto\">\r\n                <span className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                  From\r\n                </span>\r\n                <div className=\"relative w-full sm:w-auto\">\r\n                  <Calendar\r\n                    size={16}\r\n                    className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\"\r\n                  />\r\n                  <input\r\n                    type=\"date\"\r\n                    value={draftFromDate || \"\"}\r\n                    onChange={(e) => setDraftFromDate(e.target.value || \"\")}\r\n                    className=\"w-full sm:w-[170px] rounded-lg border border-[var(--input-border)] bg-[var(--card-bg)] pl-9 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex w-full flex-col gap-1 sm:w-auto\">\r\n                <span className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                  To\r\n                </span>\r\n                <div className=\"relative w-full sm:w-auto\">\r\n                  <Calendar\r\n                    size={16}\r\n                    className=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]\"\r\n                  />\r\n                  <input\r\n                    type=\"date\"\r\n                    value={draftToDate || \"\"}\r\n                    onChange={(e) => setDraftToDate(e.target.value || \"\")}\r\n                    className=\"w-full sm:w-[170px] rounded-lg border border-[var(--input-border)] bg-[var(--card-bg)] pl-9 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/20\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setFromDate(draftFromDate);\r\n                  setToDate(draftToDate);\r\n                  setTxPage(1);\r\n                }}\r\n                className=\"inline-flex w-full sm:w-auto items-center justify-center gap-2 rounded-lg bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)]\"\r\n              >\r\n                Apply Dates\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-4 grid grid-cols-1 gap-2 md:grid-cols-2 lg:grid-cols-4\">\r\n            <div>\r\n              <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                Account\r\n              </label>\r\n              <CustomSelect\r\n                value={txAccountId}\r\n                onChange={(next) => {\r\n                  setTxAccountId(next);\r\n                  setTxPage(1);\r\n                }}\r\n                placeholder=\"All Accounts\"\r\n                toneClass=\"border-slate-300/70\"\r\n                options={accountOptions}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                Type\r\n              </label>\r\n              <CustomSelect\r\n                value={txType}\r\n                onChange={(next) => {\r\n                  setTxType(next);\r\n                  setTxPage(1);\r\n                }}\r\n                placeholder=\"All Types\"\r\n                toneClass=\"border-amber-300/70\"\r\n                options={[\r\n                  { value: \"\", label: \"All Types\", dotClass: \"bg-slate-300\" },\r\n                  { value: \"DEPOSIT\", label: \"Deposit\", dotClass: \"bg-emerald-500\" },\r\n                  { value: \"WITHDRAW\", label: \"Withdraw\", dotClass: \"bg-amber-500\" },\r\n                  { value: \"TRADE_PROFIT\", label: \"Trade Profit\", dotClass: \"bg-sky-500\" },\r\n                  { value: \"TRADE_LOSS\", label: \"Trade Loss\", dotClass: \"bg-rose-500\" },\r\n                  { value: \"BONUS\", label: \"Bonus\", dotClass: \"bg-purple-500\" },\r\n                  { value: \"ADJUSTMENT\", label: \"Adjustment\", dotClass: \"bg-slate-500\" },\r\n                ]}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                Status\r\n              </label>\r\n              <CustomSelect\r\n                value={txStatus}\r\n                onChange={(next) => {\r\n                  setTxStatus(next);\r\n                  setTxPage(1);\r\n                }}\r\n                placeholder=\"All Status\"\r\n                toneClass=\"border-rose-300/70\"\r\n                options={[\r\n                  { value: \"\", label: \"All Status\", dotClass: \"bg-slate-300\" },\r\n                  { value: \"SUCCESS\", label: \"Success\", dotClass: \"bg-emerald-500\" },\r\n                  { value: \"PENDING\", label: \"Pending\", dotClass: \"bg-amber-500\" },\r\n                  { value: \"FAILED\", label: \"Failed\", dotClass: \"bg-rose-500\" },\r\n                  { value: \"REJECTED\", label: \"Rejected\", dotClass: \"bg-slate-500\" },\r\n                ]}\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                Reference Id\r\n              </label>\r\n              <input\r\n                value={txReferenceId}\r\n                onChange={(e) => {\r\n                  setTxReferenceId(e.target.value);\r\n                  setTxPage(1);\r\n                }}\r\n                placeholder=\"Search reference id\"\r\n                className=\"mt-1 w-full rounded-lg border border-[var(--input-border)] bg-[var(--input-bg)] px-3 py-2 text-sm\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              <div>\r\n                <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                  Sort By\r\n                </label>\r\n                <CustomSelect\r\n                  value={txSortBy}\r\n                  onChange={(next) => {\r\n                    setTxSortBy(next);\r\n                    setTxPage(1);\r\n                  }}\r\n                  placeholder=\"Created At\"\r\n                  toneClass=\"border-sky-300/70\"\r\n                  options={[\r\n                    { value: \"createdAt\", label: \"Created At\", dotClass: \"bg-emerald-500\" },\r\n                    { value: \"amount\", label: \"Amount\", dotClass: \"bg-sky-500\" },\r\n                    { value: \"status\", label: \"Status\", dotClass: \"bg-amber-500\" },\r\n                    { value: \"type\", label: \"Type\", dotClass: \"bg-slate-500\" },\r\n                  ]}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n                  Direction\r\n                </label>\r\n                <CustomSelect\r\n                  value={txSortDir}\r\n                  onChange={(next) => {\r\n                    setTxSortDir(next);\r\n                    setTxPage(1);\r\n                  }}\r\n                  placeholder=\"Desc\"\r\n                  toneClass=\"border-violet-300/70\"\r\n                  options={[\r\n                    { value: \"desc\", label: \"Desc\", dotClass: \"bg-slate-600\" },\r\n                    { value: \"asc\", label: \"Asc\", dotClass: \"bg-slate-400\" },\r\n                  ]}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-3 flex flex-wrap items-center gap-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setTxType(\"\");\r\n                setTxStatus(\"\");\r\n                setTxReferenceId(\"\");\r\n                setTxAccountId(\"\");\r\n                setTxSortBy(\"createdAt\");\r\n                setTxSortDir(\"desc\");\r\n                setTxPage(1);\r\n              }}\r\n              className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-xs font-medium hover:bg-[var(--hover-bg)]\"\r\n            >\r\n              Reset Filters\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"mt-4 overflow-x-auto\">\r\n            <table className=\"min-w-[980px] w-full text-left text-sm\">\r\n              <thead className=\"bg-[var(--input-bg)] text-[var(--text-muted)] text-xs uppercase\">\r\n                <tr>\r\n                  <th className=\"px-4 py-3\">Amount</th>\r\n                  <th className=\"px-4 py-3\">Created At</th>\r\n                  <th className=\"px-4 py-3\">Type</th>\r\n                  <th className=\"px-4 py-3\">Status</th>\r\n                  <th className=\"px-4 py-3\">Reference</th>\r\n                  <th className=\"px-4 py-3\">Remark</th>\r\n                  <th className=\"px-4 py-3\">Balance After</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {transactionsQuery.isLoading ? (\r\n                  <tr>\r\n                    <td colSpan={7} className=\"py-8 text-center\">\r\n                      <GlobalLoader />\r\n                    </td>\r\n                  </tr>\r\n                ) : transactionsQuery.isError ? (\r\n                  <tr>\r\n                    <td colSpan={7} className=\"py-8 text-center text-sm text-[var(--danger)]\">\r\n                      Failed to load transactions.\r\n                    </td>\r\n                  </tr>\r\n                ) : txData.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan={7} className=\"py-8 text-center text-sm text-[var(--text-muted)]\">\r\n                      No transactions found for selected date range.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  txData.map((tx: AdminTransaction) => (\r\n                    <tr\r\n                      key={tx._id ?? `${tx.createdAt}-${tx.amount}`}\r\n                      className=\"border-t border-[var(--card-border)]\"\r\n                    >\r\n                      <td className=\"px-4 py-3 font-medium\">{formatAmount(tx.amount)}</td>\r\n                      <td className=\"px-4 py-3\">{formatDateTime(tx.createdAt)}</td>\r\n                      <td className=\"px-4 py-3\">\r\n                        {resolveTxType(tx) ? (\r\n                          <span\r\n                            className={`inline-flex items-center rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-wide ${\r\n                              txTypeStyles[resolveTxType(tx)] ??\r\n                              \"border-[var(--card-border)] bg-[var(--chip-bg)] text-[var(--text-muted)]\"\r\n                            }`}\r\n                          >\r\n                            {resolveTxType(tx).replaceAll(\"_\", \" \")}\r\n                          </span>\r\n                        ) : (\r\n                          \"--\"\r\n                        )}\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">\r\n                        {resolveTxStatus(tx) ? (\r\n                          <span\r\n                            className={`inline-flex items-center rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-wide ${\r\n                              txStatusStyles[resolveTxStatus(tx)] ??\r\n                              \"border-[var(--card-border)] bg-[var(--chip-bg)] text-[var(--text-muted)]\"\r\n                            }`}\r\n                          >\r\n                            {resolveTxStatus(tx)}\r\n                          </span>\r\n                        ) : (\r\n                          \"--\"\r\n                        )}\r\n                      </td>\r\n                      <td className=\"px-4 py-3\">{tx.referenceId ?? \"--\"}</td>\r\n                      <td className=\"px-4 py-3\">{tx.remark ?? tx.notes ?? \"--\"}</td>\r\n                      <td className=\"px-4 py-3\">{formatAmount(tx.balanceAfter)}</td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n\r\n          <Pagination\r\n            page={txPage}\r\n            totalPages={txTotalPages}\r\n            limit={txLimit}\r\n            onPageChange={setTxPage}\r\n            onLimitChange={(next) => {\r\n              setTxLimit(next);\r\n              setTxPage(1);\r\n            }}\r\n          />\r\n\t        </div>\n\t      )}\n\n\t      {activeTab === \"Accounts\" && (\n\t        <div className=\"w-full max-w-full overflow-x-hidden rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-5\">\n\t          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\n\t            <div>\n\t              <h3 className=\"text-lg font-semibold\">Accounts Overview</h3>\n\t              <p className=\"text-xs text-[var(--text-muted)] mt-1\">\n\t                View all user accounts, balances and trading settings\n\t              </p>\n\t            </div>\n\t            <span className=\"inline-flex items-center rounded-full border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-1 text-xs font-semibold text-[var(--text-main)]\">\n\t              Total Live Accounts: {nonDemoAccounts.length}\n\t            </span>\n\t          </div>\n\n\t          {accountsQuery.isLoading ? (\n\t            <div className=\"py-10\">\n\t              <GlobalLoader />\n\t            </div>\n\t          ) : accountsQuery.isError ? (\n\t            <div className=\"mt-4 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700\">\n\t              Failed to load account details.\n\t            </div>\n\t          ) : accountList.length === 0 ? (\n\t            <div className=\"mt-4 rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-6 text-center text-sm text-[var(--text-muted)]\">\n\t              No accounts found for this user.\n\t            </div>\n\t          ) : (\n\t            <>\n\t              <div className=\"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 xl:grid-cols-4\">\n\t                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n\t                  <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n\t                    Total Balance\n\t                  </p>\n                  <p className={`mt-1 text-lg font-semibold ${getAmountClass(accountSummary.totalBalance, \"text-emerald-600\")}`}>\n                    ${formatAmount(accountSummary.totalBalance)}\n                  </p>\n\t                </div>\n\t                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n\t                  <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n\t                    Total Hold Balance\n\t                  </p>\n                  <p className={`mt-1 text-lg font-semibold ${getAmountClass(accountSummary.totalHoldBalance, \"text-amber-600\")}`}>\n                    ${formatAmount(accountSummary.totalHoldBalance)}\n                  </p>\n\t                </div>\n\t                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n\t                  <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n\t                    Total Equity\n\t                  </p>\n                  <p className={`mt-1 text-lg font-semibold ${getAmountClass(accountSummary.totalEquity, \"text-sky-600\")}`}>\n                    ${formatAmount(accountSummary.totalEquity)}\n                  </p>\n\t                </div>\n\t                <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n\t                  <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\n\t                    Active Accounts\n\t                  </p>\n\t                  <p className=\"mt-1 text-lg font-semibold text-[var(--text-main)]\">\n\t                    {\n\t                      nonDemoAccounts.filter(\n\t                        (account) => (account.status ?? \"\").toLowerCase() === \"active\"\n\t                      ).length\n\t                    }\n\t                  </p>\n\t                </div>\n\t              </div>\n\n\t              <div className=\"mt-4 space-y-3 md:hidden\">\n\t                {accountList.map((account) => {\n\t                  const statusValue = (account.status ?? \"unknown\").toUpperCase();\n\t                  const statusClass =\n\t                    statusValue === \"ACTIVE\"\n\t                      ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n\t                      : statusValue === \"INACTIVE\"\n\t                      ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n\t                      : \"border-[var(--card-border)] bg-[var(--chip-bg)] text-[var(--text-muted)]\";\n\t                  const typeMeta = getAccountTypeMeta(account.account_type);\n\t                  const TypeIcon = typeMeta.icon;\n\n\t                  return (\n\t                    <div\n\t                      key={account._id}\n\t                      className={`rounded-lg border p-3 ${typeMeta.cardClassName}`}\n\t                    >\n\t                      <div className=\"flex items-center justify-between gap-2\">\n\t                        <p className=\"font-mono text-xs font-semibold\">\n\t                          {account.account_number ?? account._id}\n\t                        </p>\n\t                        <span\n\t                          className={`inline-flex items-center rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase ${statusClass}`}\n\t                        >\n\t                          {statusValue}\n\t                        </span>\n\t                      </div>\n\t                      <div className=\"mt-2 grid grid-cols-2 gap-2 text-xs\">\n\t                        <p><span className=\"text-[var(--text-muted)]\">Plan:</span> {account.plan_name ?? \"--\"}</p>\n\t                        <p className=\"inline-flex items-center gap-1.5\">\n\t                          <span className=\"text-[var(--text-muted)]\">Type:</span>\n\t                          <span\n\t                            className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase ${typeMeta.className}`}\n\t                          >\n\t                            <TypeIcon size={11} />\n\t                            {typeMeta.label}\n\t                          </span>\n\t                        </p>\n                        <p>\n                          <span className=\"text-[var(--text-muted)]\">Balance:</span>{\" \"}\n                          <span className={`font-semibold ${getAmountClass(account.balance, \"text-emerald-600\")}`}>\n                            ${formatAmount(account.balance)}\n                          </span>\n                        </p>\n                        <p>\n                          <span className=\"text-[var(--text-muted)]\">Hold:</span>{\" \"}\n                          <span className={`font-semibold ${getAmountClass(account.hold_balance, \"text-amber-600\")}`}>\n                            ${formatAmount(account.hold_balance)}\n                          </span>\n                        </p>\n                        <p>\n                          <span className=\"text-[var(--text-muted)]\">Equity:</span>{\" \"}\n                          <span className={`font-semibold ${getAmountClass(account.equity, \"text-sky-600\")}`}>\n                            ${formatAmount(account.equity)}\n                          </span>\n                        </p>\n\t                        <p><span className=\"text-[var(--text-muted)]\">Currency:</span> {account.currency ?? \"--\"}</p>\n\t                        <p><span className=\"text-[var(--text-muted)]\">Leverage:</span> {account.leverage ? `x${account.leverage}` : \"--\"}</p>\n\t                        <p><span className=\"text-[var(--text-muted)]\">Commission:</span> {account.commission_per_lot ?? \"--\"}</p>\n\t                      </div>\n                      <div className=\"mt-3 flex items-center gap-2\">\n                        <button\n                          type=\"button\"\n                          onClick={() => openAccountView(account)}\n                          className=\"inline-flex flex-1 items-center justify-center gap-1.5 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-xs font-medium hover:bg-[var(--hover-bg)]\"\n                        >\n                          <Eye size={13} />\n                          View\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => openAccountEdit(account)}\n                          className=\"inline-flex flex-1 items-center justify-center gap-1.5 rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] px-3 py-2 text-xs font-medium hover:bg-[var(--hover-bg)]\"\n                        >\n                          <Pencil size={13} />\n                          Edit\n                        </button>\n                      </div>\n                      <div className=\"mt-2 grid grid-cols-2 gap-2\">\n                        <button\n                          type=\"button\"\n                          onClick={() => openResetPassword(account, \"trade\")}\n                          className=\"inline-flex items-center justify-center gap-1.5 rounded-lg border border-emerald-500/30 bg-emerald-500/10 px-3 py-2 text-[11px] font-semibold text-emerald-700 hover:bg-emerald-500/20\"\n                        >\n                          <KeyRound size={12} />\n                          Reset Trade\n                        </button>\n                        <button\n                          type=\"button\"\n                          onClick={() => openResetPassword(account, \"watch\")}\n                          className=\"inline-flex items-center justify-center gap-1.5 rounded-lg border border-sky-500/30 bg-sky-500/10 px-3 py-2 text-[11px] font-semibold text-sky-700 hover:bg-sky-500/20\"\n                        >\n                          <KeyRound size={12} />\n                          Reset Investor\n                        </button>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n\n\t              <div className=\"mt-4 hidden w-full min-w-0 max-w-full overflow-x-auto md:block\">\n\t                <table className=\"w-full table-auto text-left text-sm\">\n\t                  <thead className=\"bg-[var(--input-bg)] text-[var(--text-muted)] text-xs uppercase\">\n\t                    <tr>\n\t                      <th className=\"px-4 py-3\">Account</th>\n\t                      <th className=\"px-4 py-3\">Plan</th>\n\t                      <th className=\"px-4 py-3\">Type</th>\n\t                      <th className=\"px-4 py-3\">Leverage</th>\n\t                      <th className=\"px-4 py-3\">Spread</th>\n\t                      <th className=\"px-4 py-3\">Commission/Lot</th>\n\t                      <th className=\"px-4 py-3\">Swap</th>\n\t                      <th className=\"px-4 py-3\">Balance</th>\n\t                      <th className=\"px-4 py-3\">Hold</th>\n\t                      <th className=\"px-4 py-3\">Equity</th>\n\t                      <th className=\"px-4 py-3\">Currency</th>\n\t                      <th className=\"px-4 py-3\">Status</th>\n\t                      <th className=\"px-4 py-3\">First Deposit</th>\n\t                      <th className=\"px-4 py-3\">Created</th>\n\t                      <th className=\"px-4 py-3\">Updated</th>\n\t                      <th className=\"px-4 py-3\">Actions</th>\n\t                    </tr>\n\t                  </thead>\n\t                  <tbody>\n\t                    {accountList.map((account) => {\n\t                      const statusValue = (account.status ?? \"unknown\").toUpperCase();\n\t                      const statusClass =\n\t                        statusValue === \"ACTIVE\"\n\t                          ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n\t                          : statusValue === \"INACTIVE\"\n\t                          ? \"border-amber-500/40 bg-amber-500/10 text-amber-700\"\n\t                          : \"border-[var(--card-border)] bg-[var(--chip-bg)] text-[var(--text-muted)]\";\n\t                      const typeMeta = getAccountTypeMeta(account.account_type);\n\t                      const TypeIcon = typeMeta.icon;\n\t                      const rowToneClass =\n\t                        typeMeta.label === \"DEMO\"\n\t                          ? \"bg-slate-500/[0.03]\"\n\t                          : typeMeta.label === \"LIVE\"\n\t                          ? \"bg-emerald-500/[0.02]\"\n\t                          : \"\";\n\n\t                      return (\n\t                        <tr\n\t                          key={account._id}\n\t                          className={`border-t border-[var(--card-border)] ${rowToneClass}`}\n\t                        >\n\t                          <td className=\"px-4 py-3 font-mono\">\n\t                            {account.account_number ?? account._id}\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">{account.plan_name ?? \"--\"}</td>\n\t                          <td className=\"px-4 py-3\">\n\t                            <span\n\t                              className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase ${typeMeta.className}`}\n\t                            >\n\t                              <TypeIcon size={11} />\n\t                              {typeMeta.label}\n\t                            </span>\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">\n\t                            {account.leverage ? `x${account.leverage}` : \"--\"}\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">\n\t                            {account.spread_enabled === false\n\t                              ? \"Disabled\"\n\t                              : `${account.spread_pips ?? 0} pips`}\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">{account.commission_per_lot ?? \"--\"}</td>\n\t                          <td className=\"px-4 py-3\">\n\t                            {account.swap_enabled === false\n\t                              ? \"Disabled\"\n\t                              : `${account.swap_charge ?? \"--\"}`}\n\t                          </td>\n                          <td className={`px-4 py-3 font-medium ${getAmountClass(account.balance, \"text-emerald-600\")}`}>\n                            ${formatAmount(account.balance)}\n                          </td>\n                          <td className={`px-4 py-3 font-medium ${getAmountClass(account.hold_balance, \"text-amber-600\")}`}>\n                            ${formatAmount(account.hold_balance)}\n                          </td>\n                          <td className={`px-4 py-3 font-medium ${getAmountClass(account.equity, \"text-sky-600\")}`}>\n                            ${formatAmount(account.equity)}\n                          </td>\n\t                          <td className=\"px-4 py-3 uppercase\">{account.currency ?? \"--\"}</td>\n\t                          <td className=\"px-4 py-3\">\n\t                            <span\n\t                              className={`inline-flex items-center rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-wide ${statusClass}`}\n\t                            >\n\t                              {statusValue}\n\t                            </span>\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">\n\t                            <span\n\t                              className={`inline-flex items-center rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-wide ${\n\t                                account.first_deposit\n\t                                  ? \"border-emerald-500/40 bg-emerald-500/10 text-emerald-700\"\n\t                                  : \"border-slate-400/40 bg-slate-500/10 text-slate-700\"\n\t                              }`}\n\t                            >\n\t                              {account.first_deposit ? \"Yes\" : \"No\"}\n\t                            </span>\n\t                          </td>\n\t                          <td className=\"px-4 py-3\">{formatDateTime(account.createdAt)}</td>\n\t                          <td className=\"px-4 py-3\">{formatDateTime(account.updatedAt)}</td>\n                          <td className=\"px-4 py-3\">\n                            <div className=\"flex items-center gap-2\">\n                              <button\n                                type=\"button\"\n                                onClick={() => openAccountView(account)}\n                                className=\"inline-flex items-center gap-1.5 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2.5 py-1 text-xs font-medium hover:bg-[var(--hover-bg)]\"\n                              >\n                                <Eye size={12} />\n                                View\n                              </button>\n                              <button\n                                type=\"button\"\n                                onClick={() => openAccountEdit(account)}\n                                className=\"inline-flex items-center gap-1.5 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2.5 py-1 text-xs font-medium hover:bg-[var(--hover-bg)]\"\n                              >\n                                <Pencil size={12} />\n                                Edit\n                              </button>\n                              <button\n                                type=\"button\"\n                                onClick={() => openResetPassword(account, \"trade\")}\n                                className=\"inline-flex items-center gap-1.5 rounded-md border border-emerald-500/30 bg-emerald-500/10 px-2.5 py-1 text-[11px] font-semibold text-emerald-700 hover:bg-emerald-500/20\"\n                              >\n                                <KeyRound size={12} />\n                                Trade PW\n                              </button>\n                              <button\n                                type=\"button\"\n                                onClick={() => openResetPassword(account, \"watch\")}\n                                className=\"inline-flex items-center gap-1.5 rounded-md border border-sky-500/30 bg-sky-500/10 px-2.5 py-1 text-[11px] font-semibold text-sky-700 hover:bg-sky-500/20\"\n                              >\n                                <KeyRound size={12} />\n                                Investor PW\n                              </button>\n                            </div>\n                          </td>\n                        </tr>\n                      );\n                    })}\n\t                  </tbody>\n\t                </table>\n\t              </div>\n\t            </>\n\t          )}\n\t        </div>\n\t      )}\n\t\n\t\n\t      {activeTab === \"Active Trades\" && (\n\t        <div className=\"rounded-2xl border border-[var(--card-border)] bg-gradient-to-br from-[var(--card-bg)] via-[var(--card-bg)] to-emerald-500/5 p-6\">\n          <div className=\"flex flex-wrap items-center justify-between gap-3\">\n            <div>\n              <div className=\"inline-flex items-center rounded-full border border-sky-500/30 bg-sky-500/10 px-2.5 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-sky-700\">\n                Live Stream\n              </div>\n              <h3 className=\"mt-2 text-lg font-semibold\">Active Positions</h3>\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                WebSocket:\n                <span\n                  className={`ml-2 inline-flex items-center rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getLiveStatusClass(\n                    liveStatus\n                  )}`}\n                >\n                  {liveStatus}\n                </span>\n              </p>\n            </div>\n            <div className=\"flex flex-wrap items-center gap-3\">\n              <div className=\"text-xs text-[var(--text-muted)]\">\n                Accounts: {accountIds.length} | Positions: {filteredLivePositions.length}\n              </div>\n              <div className=\"min-w-[200px]\">\n                <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n                  Account Filter\n                </p>\n                <CustomSelect\n                  value={liveAccountFilter}\n                  onChange={setLiveAccountFilter}\n                  options={accountOptions}\n                  placeholder=\"All Accounts\"\n                  buttonClassName=\"h-9 text-xs\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4\">\n            <div className=\"rounded-xl border border-emerald-500/30 bg-emerald-500/[0.06] p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-emerald-700\">BUY</p>\n              <p className=\"mt-1 text-xl font-semibold text-emerald-700\">\n                {liveSummary.buy}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-rose-500/30 bg-rose-500/[0.06] p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-rose-700\">SELL</p>\n              <p className=\"mt-1 text-xl font-semibold text-rose-700\">\n                {liveSummary.sell}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-sky-500/30 bg-sky-500/[0.06] p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-sky-700\">Total</p>\n              <p className=\"mt-1 text-xl font-semibold text-sky-700\">\n                {liveSummary.total}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-amber-500/30 bg-amber-500/[0.06] p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-amber-700\">Floating PnL</p>\n              <p className={`mt-1 text-xl font-semibold ${getPnlClass(liveSummary.pnl)}`}>\n                {formatLiveNumber(liveSummary.pnl, 2)}\n              </p>\n            </div>\n          </div>\n\n          {filteredLivePositions.length === 0 ? (\n            <div className=\"mt-4 rounded-xl border border-dashed border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-8 text-center text-sm text-[var(--text-muted)]\">\n              No live positions for this account. Try another filter or keep this tab\n              open to receive updates.\n            </div>\n          ) : (\n            <div className=\"mt-4 space-y-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-[1200px] w-full text-left text-sm\">\n                <thead className=\"bg-[var(--input-bg)] text-xs uppercase text-[var(--text-muted)]\">\n                  <tr>\n                    <th className=\"px-4 py-3\">Symbol</th>\n                    <th className=\"px-4 py-3\">Side</th>\n                    <th className=\"px-4 py-3\">Volume</th>\n                    <th className=\"px-4 py-3\">Open Price</th>\n                    <th className=\"px-4 py-3\">Current Price</th>\n                    <th className=\"px-4 py-3\">Stop Loss</th>\n                    <th className=\"px-4 py-3\">Take Profit</th>\n                    <th className=\"px-4 py-3\">Floating PnL</th>\n                    <th className=\"px-4 py-3\">Account ID</th>\n                    <th className=\"px-4 py-3\">Position ID</th>\n                    <th className=\"px-4 py-3\">Updated</th>\n                    <th className=\"px-4 py-3\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {filteredLivePositions.map((position) => (\n                    <tr\n                      key={position.positionId}\n                      className=\"border-b border-[var(--card-border)] even:bg-[var(--input-bg)]/40\"\n                    >\n                      <td className=\"px-4 py-3 font-medium\">\n                        {position.symbol ?? \"--\"}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        <span\n                          className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getSideClass(\n                            position.side\n                          )}`}\n                        >\n                          {position.side ?? \"--\"}\n                        </span>\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {formatLiveNumber(position.volume, 2)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {formatLivePrice(position.openPrice)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {formatLivePrice(position.currentPrice)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {formatLivePrice(position.stopLoss ?? undefined)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        {formatLivePrice(position.takeProfit ?? undefined)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        <span className={getPnlClass(position.floatingPnL)}>\n                          {formatLiveNumber(position.floatingPnL, 2)}\n                        </span>\n                      </td>\n                      <td className=\"px-4 py-3 font-mono text-xs\">\n                        {position.accountId}\n                      </td>\n                      <td className=\"px-4 py-3 font-mono text-xs\">\n                        {position.positionId}\n                      </td>\n                      <td className=\"px-4 py-3 text-xs\">\n                        {formatDateTime(position.updatedAt)}\n                      </td>\n                      <td className=\"px-4 py-3\">\n                        <div className=\"flex flex-wrap items-center gap-2\">\n                          <button\n                            type=\"button\"\n                            onClick={() => openPositionAction(position)}\n                            className=\"inline-flex items-center gap-1.5 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2.5 py-1 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n                          >\n                            <Pencil size={12} />\n                            Modify\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => handlePositionClose(position)}\n                            className=\"inline-flex items-center gap-1.5 rounded-md border border-rose-500/40 bg-rose-500/10 px-2.5 py-1 text-xs font-semibold text-rose-700 hover:bg-rose-500/20\"\n                          >\n                            <XCircle size={12} />\n                            Close\n                          </button>\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {activeTab === \"Closed Trades\" && (\n        <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-6\">\n          <div className=\"flex flex-wrap items-center justify-between gap-3\">\n            <div>\n              <h3 className=\"text-lg font-semibold\">Closed Trades</h3>\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                Total: {closedTotal}\n              </p>\n            </div>\n            <div className=\"min-w-[200px]\">\n              <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n                Account Filter\n              </p>\n              <CustomSelect\n                value={closedAccountFilter}\n                onChange={(value) => {\n                  setClosedAccountFilter(value);\n                  setClosedPage(1);\n                }}\n                options={accountOptions}\n                placeholder=\"All Accounts\"\n                buttonClassName=\"h-9 text-xs\"\n              />\n            </div>\n          </div>\n\n          <div className=\"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4\">\n            <div className=\"rounded-xl border border-sky-500/30 bg-sky-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-sky-700\">\n                Total Trades\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-sky-700\">\n                {closedTotal}\n              </p>\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                On page: {closedSummary.pageTrades}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-amber-500/30 bg-amber-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-amber-700\">\n                Total Volume (page)\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-amber-700\">\n                {formatLiveNumber(closedSummary.totalVolume, 2)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-emerald-500/30 bg-emerald-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-emerald-700\">\n                Net PnL (page)\n              </p>\n              <p\n                className={`mt-1 text-xl font-semibold ${getPnlClass(\n                  closedSummary.totalPnl\n                )}`}\n              >\n                {formatLiveNumber(closedSummary.totalPnl, 2)}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-violet-500/30 bg-violet-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-violet-700\">\n                Win Rate (page)\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-violet-700\">\n                {closedSummary.pageTrades\n                  ? Math.round((closedSummary.wins / closedSummary.pageTrades) * 100)\n                  : 0}\n                %\n              </p>\n            </div>\n          </div>\n\n          {closedTradesQuery.isLoading ? (\n            <div className=\"mt-6\">\n              <GlobalLoader />\n            </div>\n          ) : closedTrades.length === 0 ? (\n            <div className=\"mt-4 rounded-xl border border-dashed border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-8 text-center text-sm text-[var(--text-muted)]\">\n              No closed trades found for this user.\n            </div>\n          ) : (\n            <div className=\"mt-4 space-y-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-[1200px] w-full text-left text-sm\">\n                  <thead className=\"bg-[var(--input-bg)] text-xs uppercase text-[var(--text-muted)]\">\n                    <tr>\n                      <th className=\"px-4 py-3\">Symbol</th>\n                      <th className=\"px-4 py-3\">Side</th>\n                      <th className=\"px-4 py-3\">Order Type</th>\n                      <th className=\"px-4 py-3\">Volume</th>\n                      <th className=\"px-4 py-3\">Open</th>\n                      <th className=\"px-4 py-3\">Close</th>\n                      <th className=\"px-4 py-3\">Realized PnL</th>\n                      <th className=\"px-4 py-3\">Open Time</th>\n                      <th className=\"px-4 py-3\">Close Time</th>\n                      <th className=\"px-4 py-3\">Account ID</th>\n                      <th className=\"px-4 py-3\">Position ID</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {closedTrades.map((trade) => (\n                      <tr\n                        key={trade._id}\n                        className=\"border-b border-[var(--card-border)] even:bg-[var(--input-bg)]/40\"\n                      >\n                        <td className=\"px-4 py-3 font-medium\">\n                          {trade.symbol ?? \"--\"}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getSideClass(\n                              trade.side\n                            )}`}\n                          >\n                            {trade.side ?? \"--\"}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getOrderTypeClass(\n                              trade.orderType\n                            )}`}\n                          >\n                            {trade.orderType ?? \"--\"}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLiveNumber(trade.volume, 2)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(trade.openPrice)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(trade.closePrice)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span className={getPnlClass(trade.realizedPnL)}>\n                            {formatLiveNumber(trade.realizedPnL, 2)}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3 text-xs\">\n                          {formatDateTime(trade.openTime)}\n                        </td>\n                        <td className=\"px-4 py-3 text-xs\">\n                          {formatDateTime(trade.closeTime)}\n                        </td>\n                        <td className=\"px-4 py-3 font-mono text-xs\">\n                          {trade.accountId}\n                        </td>\n                        <td className=\"px-4 py-3 font-mono text-xs\">\n                          {trade.positionId}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n\n              <Pagination\n                page={closedPage}\n                totalPages={closedTotalPages}\n                limit={closedLimit}\n                onPageChange={setClosedPage}\n                onLimitChange={(value) => {\n                  setClosedLimit(value);\n                  setClosedPage(1);\n                }}\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {activeTab === \"Pending Trades\" && (\n        <div className=\"rounded-2xl border border-[var(--card-border)] bg-[var(--card-bg)] p-6\">\n          <div className=\"flex flex-wrap items-center justify-between gap-3\">\n            <div>\n              <h3 className=\"text-lg font-semibold\">Open Pending Orders</h3>\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                Total: {pendingTotal}\n              </p>\n            </div>\n            <div className=\"min-w-[200px]\">\n              <p className=\"text-[10px] uppercase tracking-wide text-[var(--text-muted)]\">\n                Account Filter\n              </p>\n              <CustomSelect\n                value={pendingAccountFilter}\n                onChange={(value) => {\n                  setPendingAccountFilter(value);\n                  setPendingPage(1);\n                }}\n                options={accountOptions}\n                placeholder=\"All Accounts\"\n                buttonClassName=\"h-9 text-xs\"\n              />\n            </div>\n          </div>\n\n          <div className=\"mt-4 grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4\">\n            <div className=\"rounded-xl border border-sky-500/30 bg-sky-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-sky-700\">\n                Total Orders\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-sky-700\">\n                {pendingTotal}\n              </p>\n              <p className=\"text-xs text-[var(--text-muted)]\">\n                On page: {pendingSummary.pageOrders}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-emerald-500/30 bg-emerald-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-emerald-700\">\n                BUY\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-emerald-700\">\n                {pendingSummary.buy}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-rose-500/30 bg-rose-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-rose-700\">\n                SELL\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-rose-700\">\n                {pendingSummary.sell}\n              </p>\n            </div>\n            <div className=\"rounded-xl border border-amber-500/30 bg-amber-500/10 p-3\">\n              <p className=\"text-[11px] uppercase tracking-wide text-amber-700\">\n                Total Volume (page)\n              </p>\n              <p className=\"mt-1 text-xl font-semibold text-amber-700\">\n                {formatLiveNumber(pendingSummary.totalVolume, 2)}\n              </p>\n            </div>\n          </div>\n\n          {pendingOpenQuery.isLoading ? (\n            <div className=\"mt-6\">\n              <GlobalLoader />\n            </div>\n          ) : pendingOpenTrades.length === 0 ? (\n            <div className=\"mt-4 rounded-xl border border-dashed border-[var(--card-border)] bg-[var(--input-bg)] px-4 py-8 text-center text-sm text-[var(--text-muted)]\">\n              No open pending orders found for this user.\n            </div>\n          ) : (\n            <div className=\"mt-4 space-y-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-[1200px] w-full text-left text-sm\">\n                  <thead className=\"bg-[var(--input-bg)] text-xs uppercase text-[var(--text-muted)]\">\n                    <tr>\n                      <th className=\"px-4 py-3\">Symbol</th>\n                      <th className=\"px-4 py-3\">Side</th>\n                      <th className=\"px-4 py-3\">Order Type</th>\n                      <th className=\"px-4 py-3\">Price</th>\n                      <th className=\"px-4 py-3\">Live Price</th>\n                      <th className=\"px-4 py-3\">Trigger Left</th>\n                      <th className=\"px-4 py-3\">Volume</th>\n                      <th className=\"px-4 py-3\">Stop Loss</th>\n                      <th className=\"px-4 py-3\">Take Profit</th>\n                      <th className=\"px-4 py-3\">Created</th>\n                      <th className=\"px-4 py-3\">Updated</th>\n                      <th className=\"px-4 py-3\">Account ID</th>\n                      <th className=\"px-4 py-3\">Order ID</th>\n                      <th className=\"px-4 py-3\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {pendingOpenTrades.map((order) => (\n                      <tr\n                        key={order._id}\n                        className=\"border-b border-[var(--card-border)] even:bg-[var(--input-bg)]/40\"\n                      >\n                        <td className=\"px-4 py-3 font-medium\">\n                          {order.symbol ?? \"--\"}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getSideClass(\n                              order.side\n                            )}`}\n                          >\n                            {order.side ?? \"--\"}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={`inline-flex rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${getOrderTypeClass(\n                              order.orderType\n                            )}`}\n                          >\n                            {order.orderType ?? \"--\"}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(order.price)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(getPendingLivePrice(order))}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {(() => {\n                            const info = getPendingTriggerInfo(order);\n                            if (info.status === \"ready\") {\n                              return (\n                                <span className=\"inline-flex rounded-full border border-emerald-500/40 bg-emerald-500/10 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-emerald-700\">\n                                  Ready\n                                </span>\n                              );\n                            }\n                            if (info.status === \"away\") {\n                              return (\n                                <span className=\"text-xs font-semibold text-[var(--text-muted)]\">\n                                  {formatLivePrice(info.value)} away\n                                </span>\n                              );\n                            }\n                            return <span className=\"text-xs text-[var(--text-muted)]\">--</span>;\n                          })()}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLiveNumber(order.volume, 2)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(order.stopLoss ?? undefined)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {formatLivePrice(order.takeProfit ?? undefined)}\n                        </td>\n                        <td className=\"px-4 py-3 text-xs\">\n                          {formatDateTime(order.createdAt)}\n                        </td>\n                        <td className=\"px-4 py-3 text-xs\">\n                          {formatDateTime(order.updatedAt)}\n                        </td>\n                        <td className=\"px-4 py-3 font-mono text-xs\">\n                          {order.accountId}\n                        </td>\n                        <td className=\"px-4 py-3 font-mono text-xs\">\n                          {order.orderId}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <div className=\"flex flex-wrap items-center gap-2\">\n                            <button\n                              type=\"button\"\n                              onClick={() => openPendingAction(order)}\n                              className=\"inline-flex items-center gap-1.5 rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-2.5 py-1 text-xs font-semibold hover:bg-[var(--hover-bg)]\"\n                            >\n                              <Pencil size={12} />\n                              Modify\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => handlePendingCancel(order)}\n                              className=\"inline-flex items-center gap-1.5 rounded-md border border-rose-500/40 bg-rose-500/10 px-2.5 py-1 text-xs font-semibold text-rose-700 hover:bg-rose-500/20\"\n                            >\n                              <XCircle size={12} />\n                              Cancel\n                            </button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n\n              <Pagination\n                page={pendingPage}\n                totalPages={pendingTotalPages}\n                limit={pendingLimit}\n                onPageChange={setPendingPage}\n                onLimitChange={(value) => {\n                  setPendingLimit(value);\n                  setPendingPage(1);\n                }}\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      <Modal\n        title=\"Account Details\"\n        open={accountViewOpen}\n        onClose={() => setAccountViewOpen(false)}\n        size=\"md\"\n      >\n        {!selectedAccount ? (\n          <p className=\"text-sm text-[var(--text-muted)]\">No account selected.</p>\n        ) : (\n          <div className=\"space-y-4\">\n            <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3\">\n              <div className=\"flex flex-wrap items-center justify-between gap-2\">\n                <p className=\"font-mono text-sm font-semibold\">\n                  {selectedAccount.account_number ?? selectedAccount._id}\n                </p>\n                <span\n                  className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase ${\n                    selectedAccountTypeMeta.className\n                  }`}\n                >\n                  <SelectedAccountTypeIcon size={11} />\n                  {selectedAccountTypeMeta.label}\n                </span>\n              </div>\n              <p className=\"mt-2 text-xs text-[var(--text-muted)]\">\n                Plan: {selectedAccount.plan_name ?? \"--\"}\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-3 text-sm\">\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Balance</p>\n                <p className={`mt-1 font-semibold ${getAmountClass(selectedAccount.balance, \"text-emerald-600\")}`}>\n                  ${formatAmount(selectedAccount.balance)}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Hold</p>\n                <p className={`mt-1 font-semibold ${getAmountClass(selectedAccount.hold_balance, \"text-amber-600\")}`}>\n                  ${formatAmount(selectedAccount.hold_balance)}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Equity</p>\n                <p className={`mt-1 font-semibold ${getAmountClass(selectedAccount.equity, \"text-sky-600\")}`}>\n                  ${formatAmount(selectedAccount.equity)}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Status</p>\n                <p className=\"mt-1 font-semibold uppercase text-[var(--text-main)]\">\n                  {selectedAccount.status ?? \"--\"}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Leverage</p>\n                <p className=\"mt-1 font-semibold text-[var(--text-main)]\">\n                  {selectedAccount.leverage ? `x${selectedAccount.leverage}` : \"--\"}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\n                <p className=\"text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">Currency</p>\n                <p className=\"mt-1 font-semibold uppercase text-[var(--text-main)]\">\n                  {selectedAccount.currency ?? \"--\"}\n                </p>\n              </div>\n            </div>\n\n          </div>\n        )}\n      </Modal>\n\n      <Modal\n        title={`Reset ${\n          resetPasswordType === \"trade\" ? \"Trade\" : \"Investor\"\n        } Password`}\n        open={resetPasswordOpen}\n        onClose={closeResetPassword}\n        size=\"sm\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closeResetPassword}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleResetAccountPassword}\n              disabled={\n                resetPasswordType === \"trade\"\n                  ? resetTradePasswordMutation.isPending\n                  : resetWatchPasswordMutation.isPending\n              }\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\n            >\n              {resetPasswordType === \"trade\"\n                ? resetTradePasswordMutation.isPending\n                  ? \"Resetting...\"\n                  : \"Reset Trade Password\"\n                : resetWatchPasswordMutation.isPending\n                ? \"Resetting...\"\n                : \"Reset Investor Password\"}\n            </button>\n          </div>\n        }\n      >\n        <div className=\"space-y-4\">\n          {accountPasswordError ? (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {accountPasswordError}\n            </div>\n          ) : null}\n\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] px-3 py-2 text-xs text-[var(--text-muted)]\">\n            Account:{\" \"}\n            <span className=\"font-mono text-[var(--foreground)]\">\n              {resetPasswordAccount?.account_number ??\n                resetPasswordAccount?._id ??\n                \"--\"}\n            </span>\n          </div>\n\n          <div>\n            <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n              New Password\n            </label>\n            <div className=\"mt-1 flex items-center gap-2 rounded-lg border border-[var(--input-border)] bg-[var(--card-bg)] px-3 py-2\">\n              <input\n                type={showAccountPassword ? \"text\" : \"password\"}\n                value={accountPassword}\n                onChange={(event) => setAccountPassword(event.target.value)}\n                placeholder=\"Enter new password\"\n                className=\"w-full bg-transparent text-sm outline-none\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowAccountPassword((prev) => !prev)}\n                className=\"text-[var(--text-muted)] hover:text-[var(--foreground)]\"\n              >\n                {showAccountPassword ? <EyeOff size={16} /> : <Eye size={16} />}\n              </button>\n            </div>\n          </div>\n\n          <div>\n            <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n              Confirm Password\n            </label>\n            <div className=\"mt-1 flex items-center gap-2 rounded-lg border border-[var(--input-border)] bg-[var(--card-bg)] px-3 py-2\">\n              <input\n                type={showAccountPasswordConfirm ? \"text\" : \"password\"}\n                value={accountPasswordConfirm}\n                onChange={(event) => setAccountPasswordConfirm(event.target.value)}\n                placeholder=\"Confirm new password\"\n                className=\"w-full bg-transparent text-sm outline-none\"\n              />\n              <button\n                type=\"button\"\n                onClick={() =>\n                  setShowAccountPasswordConfirm((prev) => !prev)\n                }\n                className=\"text-[var(--text-muted)] hover:text-[var(--foreground)]\"\n              >\n                {showAccountPasswordConfirm ? (\n                  <EyeOff size={16} />\n                ) : (\n                  <Eye size={16} />\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n\n      <Modal\n        title=\"Edit Account Settings\"\n        open={accountEditOpen}\n        onClose={closeAccountEdit}\n        size=\"md\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closeAccountEdit}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              form=\"edit-account-form\"\n              disabled={updateAccountMutation.isPending || !selectedAccount}\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\n            >\n              {updateAccountMutation.isPending ? \"Updating...\" : \"Update Account\"}\n            </button>\n          </div>\n        }\n      >\n        <form id=\"edit-account-form\" onSubmit={handleAccountUpdateSubmit} className=\"space-y-4\">\n          {accountFormError && (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {accountFormError}\n            </div>\n          )}\n\n          {!selectedAccount ? (\n            <p className=\"text-sm text-[var(--text-muted)]\">No account selected.</p>\n          ) : (\n            <>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3 text-sm\">\n                <p className=\"font-mono font-semibold\">\n                  {selectedAccount.account_number ?? selectedAccount._id}\n                </p>\n                <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n                  Configure account trading parameters and status.\n                </p>\n              </div>\n\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Leverage</label>\n                  <FieldControl icon={Rocket}>\n                    <input\n                      type=\"number\"\n                      min={0}\n                      value={accountForm.leverage}\n                      onChange={handleAccountFormField(\"leverage\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Spread Enabled</label>\n                  <FieldControl icon={Globe}>\n                    <select\n                      value={accountForm.spread_enabled}\n                      onChange={handleAccountFormField(\"spread_enabled\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    >\n                      <option value=\"true\">Enabled</option>\n                      <option value=\"false\">Disabled</option>\n                    </select>\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Spread Pips</label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      min={0}\n                      step=\"0.01\"\n                      value={accountForm.spread_pips}\n                      onChange={handleAccountFormField(\"spread_pips\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Commission Per Lot</label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      min={0}\n                      step=\"0.01\"\n                      value={accountForm.commission_per_lot}\n                      onChange={handleAccountFormField(\"commission_per_lot\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Swap Enabled</label>\n                  <FieldControl icon={Globe}>\n                    <select\n                      value={accountForm.swap_enabled}\n                      onChange={handleAccountFormField(\"swap_enabled\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    >\n                      <option value=\"true\">Enabled</option>\n                      <option value=\"false\">Disabled</option>\n                    </select>\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Swap Charge</label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      min={0}\n                      step=\"0.01\"\n                      value={accountForm.swap_charge}\n                      onChange={handleAccountFormField(\"swap_charge\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div className=\"sm:col-span-2\">\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">Status</label>\n                  <FieldControl icon={ShieldCheck}>\n                    <select\n                      value={accountForm.status}\n                      onChange={handleAccountFormField(\"status\")}\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    >\n                      <option value=\"active\">Active</option>\n                      <option value=\"disabled\">Disabled</option>\n                    </select>\n                  </FieldControl>\n                </div>\n              </div>\n            </>\n          )}\n        </form>\n      </Modal>\n\n      <Modal\n        title=\"Modify Position\"\n        open={positionActionOpen}\n        onClose={closePositionAction}\n        size=\"sm\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closePositionAction}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              form=\"position-action-form\"\n              disabled={modifyPositionMutation.isPending || !positionAction}\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\n            >\n              {modifyPositionMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n            </button>\n          </div>\n        }\n      >\n        <form\n          id=\"position-action-form\"\n          onSubmit={handlePositionModifySubmit}\n          className=\"space-y-4\"\n        >\n          {positionActionError ? (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {positionActionError}\n            </div>\n          ) : null}\n\n          {!positionAction ? (\n            <p className=\"text-sm text-[var(--text-muted)]\">No position selected.</p>\n          ) : (\n            <>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3 text-sm\">\n                <p className=\"font-mono font-semibold\">{positionAction.positionId}</p>\n                <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n                  Account: {positionAction.accountId}\n                </p>\n              </div>\n\n              <div className=\"grid gap-3 sm:grid-cols-2\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Stop Loss\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={positionForm.stopLoss}\n                      onChange={(event) =>\n                        setPositionForm((prev) => ({\n                          ...prev,\n                          stopLoss: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Take Profit\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={positionForm.takeProfit}\n                      onChange={(event) =>\n                        setPositionForm((prev) => ({\n                          ...prev,\n                          takeProfit: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n              </div>\n            </>\n          )}\n        </form>\n      </Modal>\n\n      <Modal\n        title=\"Modify Pending Order\"\n        open={pendingActionOpen}\n        onClose={closePendingAction}\n        size=\"sm\"\n        footer={\n          <div className=\"flex items-center justify-end gap-2\">\n            <button\n              type=\"button\"\n              onClick={closePendingAction}\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              form=\"pending-action-form\"\n              disabled={modifyPendingMutation.isPending || !pendingAction}\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\n            >\n              {modifyPendingMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n            </button>\n          </div>\n        }\n      >\n        <form\n          id=\"pending-action-form\"\n          onSubmit={handlePendingModifySubmit}\n          className=\"space-y-4\"\n        >\n          {pendingActionError ? (\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\n              {pendingActionError}\n            </div>\n          ) : null}\n\n          {!pendingAction ? (\n            <p className=\"text-sm text-[var(--text-muted)]\">\n              No pending order selected.\n            </p>\n          ) : (\n            <>\n              <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--input-bg)] p-3 text-sm\">\n                <p className=\"font-mono font-semibold\">{pendingAction.orderId}</p>\n                <p className=\"mt-1 text-xs text-[var(--text-muted)]\">\n                  Account: {pendingAction.accountId}\n                </p>\n              </div>\n\n              <div className=\"grid gap-3 sm:grid-cols-2\">\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Price\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={pendingEditForm.price}\n                      onChange={(event) =>\n                        setPendingEditForm((prev) => ({\n                          ...prev,\n                          price: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Stop Loss\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={pendingEditForm.stopLoss}\n                      onChange={(event) =>\n                        setPendingEditForm((prev) => ({\n                          ...prev,\n                          stopLoss: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n                <div>\n                  <label className=\"text-xs font-medium text-[var(--text-muted)]\">\n                    Take Profit\n                  </label>\n                  <FieldControl icon={Hash}>\n                    <input\n                      type=\"number\"\n                      step=\"0.0001\"\n                      value={pendingEditForm.takeProfit}\n                      onChange={(event) =>\n                        setPendingEditForm((prev) => ({\n                          ...prev,\n                          takeProfit: event.target.value,\n                        }))\n                      }\n                      className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\n                    />\n                  </FieldControl>\n                </div>\n              </div>\n            </>\n          )}\n        </form>\n      </Modal>\n\n      <Modal\n        title=\"User Details\"\n        open={viewOpen}\n        onClose={() => setViewOpen(false)}\n        size=\"lg\"\r\n      >\r\n        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <User size={12} /> Full Name\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.name ?? localProfile.name ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Mail size={12} /> Email\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.email ?? localProfile.email ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Phone size={12} /> Phone\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.phone ?? localProfile.phone ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Mail size={12} /> Mail Verified\r\n            </div>\r\n            <div className=\"mt-2\">\r\n              <span\r\n                className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold uppercase ${mailBadgeClass}`}\r\n              >\r\n                {localProfile.isMailVerified ? \"Verified\" : \"Unverified\"}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <ShieldCheck size={12} /> KYC Status\r\n            </div>\r\n            <div className=\"mt-2\">\r\n              <span\r\n                className={`inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold uppercase ${kycBadgeClass}`}\r\n              >\r\n                {(localProfile.kycStatus || \"STATUS\").replaceAll(\"_\", \" \")}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Calendar size={12} /> Date of Birth\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.date_of_birth\r\n                ? userQuery.data.date_of_birth.slice(0, 10)\r\n                : \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Users size={12} /> Gender\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.gender ?? form.gender ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3 sm:col-span-2\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <MapPin size={12} /> Address Line 1\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.address_line_1 ?? form.address_line_1 ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3 sm:col-span-2\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Building2 size={12} /> Address Line 2\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.address_line_2 ?? form.address_line_2 ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <MapPin size={12} /> City\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.city ?? form.city ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <MapPin size={12} /> State\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.state ?? form.state ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Globe size={12} /> Country\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.country ?? form.country ?? \"--\"}\r\n            </p>\r\n          </div>\r\n          <div className=\"rounded-lg border border-[var(--card-border)] bg-[var(--card-bg)] p-3\">\r\n            <div className=\"flex items-center gap-2 text-[11px] uppercase tracking-wide text-[var(--text-muted)]\">\r\n              <Hash size={12} /> Pincode\r\n            </div>\r\n            <p className=\"mt-1 text-sm font-medium\">\r\n              {userQuery.data?.pincode ?? form.pincode ?? \"--\"}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n\r\n      <Modal\r\n        title=\"Edit Profile\"\r\n        open={editOpen}\r\n        onClose={() => setEditOpen(false)}\r\n        size=\"xl\"\r\n        footer={\r\n          <div className=\"flex flex-wrap items-center justify-end gap-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setEditOpen(false)}\r\n              className=\"rounded-md border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              form=\"edit-profile-form\"\r\n              disabled={!canSubmit}\r\n              className=\"rounded-md bg-[var(--primary)] px-4 py-2 text-sm font-semibold text-white hover:bg-[var(--primary-dark)] disabled:opacity-60\"\r\n            >\r\n              Save Changes\r\n            </button>\r\n          </div>\r\n        }\r\n      >\r\n        <form id=\"edit-profile-form\" onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Full Name</label>\r\n              <FieldControl icon={User}>\r\n                <input\r\n                  value={form.name ?? \"\"}\r\n                  onChange={handleChange(\"name\")}\r\n                  placeholder=\"Enter full name\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Phone</label>\r\n              <FieldControl icon={Phone}>\r\n                <input\r\n                  value={form.phone ?? \"\"}\r\n                  onChange={handleChange(\"phone\")}\r\n                  placeholder=\"Enter phone number\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-xs font-medium text-[var(--text-muted)]\">\r\n                <Mail size={12} /> Mail Verified\r\n              </label>\r\n              <CustomSelect\r\n                value={form.isMailVerified ? \"true\" : \"false\"}\r\n                onChange={(next) => {\r\n                  setForm((prev) => ({ ...prev, isMailVerified: next === \"true\" }));\r\n                  setTouched((prev) => ({ ...prev, isMailVerified: true }));\r\n                }}\r\n                placeholder=\"Select status\"\r\n                options={[\r\n                  { value: \"true\", label: \"Verified\", dotClass: \"bg-emerald-500\" },\r\n                  { value: \"false\", label: \"Unverified\", dotClass: \"bg-amber-500\" },\r\n                ]}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-xs font-medium text-[var(--text-muted)]\">\r\n                <ShieldCheck size={12} /> KYC Status\r\n              </label>\r\n              <CustomSelect\r\n                value={form.kycStatus || \"NOT_STARTED\"}\r\n                onChange={(next) => {\r\n                  setForm((prev) => ({ ...prev, kycStatus: next }));\r\n                  setTouched((prev) => ({ ...prev, kycStatus: true }));\r\n                }}\r\n                placeholder=\"Select KYC status\"\r\n                options={[\r\n                  { value: \"VERIFIED\", label: \"Verified\", dotClass: \"bg-emerald-500\" },\r\n                  { value: \"PENDING\", label: \"Pending\", dotClass: \"bg-amber-500\" },\r\n                  { value: \"NOT_STARTED\", label: \"Not Started\", dotClass: \"bg-slate-500\" },\r\n                  { value: \"REJECTED\", label: \"Rejected\", dotClass: \"bg-rose-500\" },\r\n                ]}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Date of Birth</label>\r\n              <FieldControl icon={Calendar}>\r\n                <input\r\n                  type=\"date\"\r\n                  value={form.date_of_birth ?? \"\"}\r\n                  onChange={handleChange(\"date_of_birth\")}\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-xs font-medium text-[var(--text-muted)]\">\r\n                <Users size={12} /> Gender\r\n              </label>\r\n              <CustomSelect\r\n                value={form.gender ?? \"\"}\r\n                onChange={(next) => {\r\n                  setForm((prev) => ({ ...prev, gender: next }));\r\n                  setTouched((prev) => ({ ...prev, gender: true }));\r\n                }}\r\n                placeholder=\"Select gender\"\r\n                options={[\r\n                  { value: \"MALE\", label: \"Male\", dotClass: \"bg-sky-500\" },\r\n                  { value: \"FEMALE\", label: \"Female\", dotClass: \"bg-pink-500\" },\r\n                  { value: \"OTHER\", label: \"Other\", dotClass: \"bg-slate-500\" },\r\n                ]}\r\n              />\r\n            </div>\r\n            <div className=\"sm:col-span-2\">\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Address Line 1</label>\r\n              <FieldControl icon={MapPin}>\r\n                <input\r\n                  value={form.address_line_1 ?? \"\"}\r\n                  onChange={handleChange(\"address_line_1\")}\r\n                  placeholder=\"Enter address line 1\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div className=\"sm:col-span-2\">\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Address Line 2</label>\r\n              <FieldControl icon={Building2}>\r\n                <input\r\n                  value={form.address_line_2 ?? \"\"}\r\n                  onChange={handleChange(\"address_line_2\")}\r\n                  placeholder=\"Enter address line 2\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">City</label>\r\n              <FieldControl icon={MapPin}>\r\n                <input\r\n                  value={form.city ?? \"\"}\r\n                  onChange={handleChange(\"city\")}\r\n                  placeholder=\"Enter city\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">State</label>\r\n              <FieldControl icon={MapPin}>\r\n                <input\r\n                  value={form.state ?? \"\"}\r\n                  onChange={handleChange(\"state\")}\r\n                  placeholder=\"Enter state\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Country</label>\r\n              <FieldControl icon={Globe}>\r\n                <input\r\n                  value={form.country ?? \"\"}\r\n                  onChange={handleChange(\"country\")}\r\n                  placeholder=\"Enter country\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-[var(--text-muted)]\">Pincode</label>\r\n              <FieldControl icon={Hash}>\r\n                <input\r\n                  value={form.pincode ?? \"\"}\r\n                  onChange={handleChange(\"pincode\")}\r\n                  placeholder=\"Enter pincode\"\r\n                  className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n                />\r\n              </FieldControl>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </Modal>\r\n\r\n      <Modal\r\n        title=\"Change Password\"\r\n        open={passwordOpen}\r\n        onClose={() => setPasswordOpen(false)}\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setPasswordOpen(false)}\r\n              className=\"rounded-sm border border-[var(--card-border)] bg-[var(--card-bg)] px-4 py-2 text-sm font-semibold hover:bg-[var(--hover-bg)]\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              form=\"change-password-form\"\r\n              className=\"rounded-sm border border-black bg-black px-4 py-2 text-sm font-semibold text-white hover:bg-black/80\"\r\n            >\r\n              Change\r\n            </button>\r\n          </div>\r\n        }\r\n      >\r\n        <form id=\"change-password-form\" onSubmit={handlePasswordSubmit} className=\"space-y-4\">\r\n          {passwordError && (\r\n            <div className=\"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600\">\r\n              {passwordError}\r\n            </div>\r\n          )}\r\n          <div>\r\n            <label className=\"text-xs font-medium text-[var(--text-muted)]\">New Password</label>\r\n            <FieldControl\r\n              icon={KeyRound}\r\n              trailing={\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword((prev) => !prev)}\r\n                  className=\"text-[var(--text-muted)] hover:text-[var(--text-main)]\"\r\n                >\r\n                  {showPassword ? <EyeOff size={16} /> : <Eye size={16} />}\r\n                </button>\r\n              }\r\n            >\r\n              <input\r\n                type={showPassword ? \"text\" : \"password\"}\r\n                value={passwordForm.newPassword}\r\n                onChange={(e) => setPasswordForm((prev) => ({ ...prev, newPassword: e.target.value }))}\r\n                placeholder=\"Enter new password\"\r\n                className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n              />\r\n            </FieldControl>\r\n          </div>\r\n          <div>\r\n            <label className=\"text-xs font-medium text-[var(--text-muted)]\">Confirm Password</label>\r\n            <FieldControl\r\n              icon={KeyRound}\r\n              trailing={\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowConfirmPassword((prev) => !prev)}\r\n                  className=\"text-[var(--text-muted)] hover:text-[var(--text-main)]\"\r\n                >\r\n                  {showConfirmPassword ? <EyeOff size={16} /> : <Eye size={16} />}\r\n                </button>\r\n              }\r\n            >\r\n              <input\r\n                type={showConfirmPassword ? \"text\" : \"password\"}\r\n                value={passwordForm.confirmPassword}\r\n                onChange={(e) => setPasswordForm((prev) => ({ ...prev, confirmPassword: e.target.value }))}\r\n                placeholder=\"Confirm new password\"\r\n                className=\"w-full bg-transparent text-sm text-[var(--text-main)] outline-none placeholder:text-[var(--text-muted)]\"\r\n              />\r\n            </FieldControl>\r\n          </div>\r\n        </form>\r\n      </Modal>\r\n\r\n      {toast && <Toast message={toast} />}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\verification\\kyc\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\admin\\verification\\pending-kyc\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'limit' is assigned a value but never used.","line":18,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nimport { useGetAdminAllKyc } from \"@/hooks/kyc/useGetAdminAllKyc\";\r\nimport { useUpdateKycStatus } from \"@/hooks/kyc/useUpdateKycStatus\";\r\nimport { AdminKyc } from \"@/services/kyc/kyc.types\";\r\n\r\nimport AdminKycTable from \"../../components/kyc/AdminKycTable\";\r\nimport Pagination from \"../../components/ui/pagination\";\r\nimport AdminKycViewModal from \"../../components/kyc/AdminKycViewModal\";\r\nimport AdminCard from \"../../components/ui/AdminCard\";\r\nimport GlobalLoader from \"../../components/ui/GlobalLoader\";\r\n\r\nexport default function PendingKycPage() {\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(10);\r\n  const [selectedKyc, setSelectedKyc] =\r\n    useState<AdminKyc | null>(null);\r\n\r\n  const { data, isLoading } = useGetAdminAllKyc({\r\n    status: \"PENDING\",\r\n    page,\r\n    limit: 10,\r\n  });\r\n\r\n  const { mutate: updateStatus, isPending } =\r\n    useUpdateKycStatus();\r\n\r\n  const list = data?.data?.list ?? [];\r\n  const pagination = data?.data?.pagination;\r\n\r\n  const approve = (kyc: AdminKyc) => {\r\n    updateStatus(\r\n      { id: kyc._id, payload: { status: \"VERIFIED\" } },\r\n      {\r\n        onSuccess: () => {\r\n          toast.success(\"KYC approved\");\r\n          setSelectedKyc(null);\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  const reject = (kyc: AdminKyc, reason: string) => {\r\n    updateStatus(\r\n      {\r\n        id: kyc._id,\r\n        payload: {\r\n          status: \"REJECTED\",\r\n          rejectionReason: reason,\r\n        },\r\n      },\r\n      {\r\n        onSuccess: () => {\r\n          toast.success(\"KYC rejected\");\r\n          setSelectedKyc(null);\r\n        },\r\n      }\r\n    );\r\n  };\r\nif (isLoading) {\r\n    return(\r\n      <>\r\n        <div className=\"p-6 text-center text-sm\"><GlobalLoader/></div>\r\n      </>\r\n    )\r\n  }\r\n  return (\r\n    <>\r\n      <AdminCard title=\"Pending KYC Requests\">\r\n  {isLoading ? (\r\n    <p>Loadingâ€¦</p>\r\n  ) : list.length === 0 ? (\r\n    /* âœ… EMPTY STATE */\r\n    <div className=\"flex flex-col items-center justify-center py-16 text-center\">\r\n      <div\r\n        className=\"mb-3 rounded-full px-4 py-2 text-sm font-semibold\"\r\n        style={{\r\n          background: \"var(--hover-bg)\",\r\n          color: \"var(--text-muted)\",\r\n        }}\r\n      >\r\n        ðŸŽ‰ All Clear\r\n      </div>\r\n\r\n      <h3 className=\"text-lg font-semibold\">\r\n        No Pending KYC Requests\r\n      </h3>\r\n\r\n      <p className=\"mt-1 max-w-md text-sm text-[var(--text-muted)]\">\r\n        There are currently no users waiting for KYC approval.\r\n        New requests will appear here automatically.\r\n      </p>\r\n    </div>\r\n  ) : (\r\n    <>\r\n      <AdminKycTable\r\n        list={list}\r\n        onView={(k) => setSelectedKyc(k)}\r\n      />\r\n\r\n      {pagination && (\r\n        <Pagination\r\n          page={pagination.page}\r\n          totalPages={pagination.totalPages}\r\n          limit={pagination.limit}\r\n          onPageChange={setPage}\r\n          onLimitChange={(l) => {\r\n            setLimit(l);\r\n            setPage(1);\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  )}\r\n</AdminCard>\r\n\r\n\r\n      {/* MODAL MUST BE OUTSIDE CARD */}\r\n      {selectedKyc && (\r\n        <AdminKycViewModal\r\n          data={selectedKyc}\r\n          loading={isPending}\r\n          onClose={() => setSelectedKyc(null)}\r\n          onApprove={() => approve(selectedKyc)}\r\n          onReject={(reason) =>\r\n            reject(selectedKyc, reason)\r\n          }\r\n        />\r\n      )}\r\n      \r\n    </>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\not-found.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\app\\theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\deposit\\useAdminDeposits.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\deposit\\useCreateAdminDeposit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\deposit\\useDepositActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\deposit\\useEditDepositAmount.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\instruments\\useCreateInstrument.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\instruments\\useDeleteInstrument.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\instruments\\useInstruments.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\instruments\\useUpdateInstrument.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\kyc\\useGetAdminAllKyc.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\kyc\\useUpdateKycStatus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\notification\\useBroadcastNotification.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[250,253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[250,253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMutation } from \"@tanstack/react-query\";\r\nimport { broadcastNotificationService } from \"@/services/notification/notification.services\";\r\n\r\nexport const useBroadcastNotification = () => {\r\n  return useMutation({\r\n    mutationFn: (payload: any) => broadcastNotificationService(payload),\r\n  });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\notification\\useGetAdminNotifications.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'NotificationListResponse' is defined but never used.","line":4,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from \"@tanstack/react-query\";\r\nimport {\r\n  getAdminNotificationsService,\r\n  NotificationListResponse,\r\n} from \"@/services/notification/notification.services\";\r\n\r\ninterface UseGetAdminNotificationsProps {\r\n  page: number;\r\n  limit: number;\r\n}\r\n\r\nexport const useGetAdminNotifications = ({\r\n  page,\r\n  limit,\r\n}: UseGetAdminNotificationsProps) => {\r\n  return useQuery({\r\n    queryKey: [\"admin-notifications\", page, limit] as const,\r\n    queryFn: () => getAdminNotificationsService(page, limit),\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n  });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\payment-method\\useAddPaymentMethod.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\payment-method\\useDeletePaymentMethod.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\payment-method\\usePaymentMethods.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\payment-method\\useTogglePaymentStatus.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[295,298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[295,298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { paymentService } from \"@/services/payment-method/payment-method.service\";\r\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\n\r\nexport const useTogglePaymentStatus = () => {\r\n  const qc = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: ({ id, is_active }: any) =>\r\n      paymentService.toggle(id, is_active),\r\n    onSuccess: () => qc.invalidateQueries({ queryKey: [\"payment-methods\"] }),\r\n  });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\payment-method\\useUpdatePaymentMethod.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[293,296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[293,296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { paymentService } from \"@/services/payment-method/payment-method.service\";\r\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\n\r\nexport const useUpdatePaymentMethod = () => {\r\n  const qc = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: ({ id, payload }: any) =>\r\n      paymentService.update(id, payload),\r\n    onSuccess: () => qc.invalidateQueries({ queryKey: [\"payment-methods\"] }),\r\n  });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAccountPlans.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdmin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdminUser.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[392,395],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[392,395],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from \"@tanstack/react-query\";\nimport { fetchAdminUserById } from \"@/services/user.service\";\n\nexport const useAdminUser = (userId?: string) =>\n  useQuery({\n    queryKey: [\"admin-user\", userId],\n    queryFn: () => fetchAdminUserById(userId as string),\n    enabled: Boolean(userId),\n    staleTime: 1000 * 30,\n    refetchOnWindowFocus: false,\n    retry: (failureCount, error: any) => {\n      const status = error?.response?.status;\n      if (status === 404) return false;\n      return failureCount < 2;\n    },\n  });\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdminUserAccounts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdminUserFunds.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdminUserTransactions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAdminUsers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useAuth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useChangeAdminUserPassword.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useHealthStatus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useInquiry.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useLiveQuotesBySymbols.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1098,1101],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1098,1101],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`flush` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\Admin-frontend-als\\hooks\\useLiveQuotesBySymbols.ts:62:17\n  60 |                     close: nextClose ?? bufferRef.current[s].close,\n  61 |                 };\n> 62 |                 flush();\n     |                 ^^^^^ `flush` accessed before it is declared\n  63 |                 return;\n  64 |             }\n  65 |\n\nE:\\Admin-frontend-als\\hooks\\useLiveQuotesBySymbols.ts:161:5\n  159 |     }, [symbols]);\n  160 |\n> 161 |     function flush() {\n      |     ^^^^^^^^^^^^^^^^^^\n> 162 |         if (frameRef.current) return;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 163 |         frameRef.current = requestAnimationFrame(() => {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 164 |             frameRef.current = null;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 165 |             setQuotes({ ...bufferRef.current });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 166 |         });\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 167 |     }\n      | ^^^^^^ `flush` is declared here\n  168 |\n  169 |     return quotes;\n  170 | }","line":62,"column":17,"nodeType":null,"endLine":62,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { MarketSocket } from \"@/services/marketSocket.service\";\r\nimport { QuoteLiveState } from \"@/types/market\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ntype QuoteMap = Record<string, QuoteLiveState>;\r\n\r\nexport function useLiveQuotesBySymbols(\r\n    token: string,\r\n    symbols: string[]\r\n) {\r\n    const socketRef = useRef<MarketSocket | null>(null);\r\n    const bufferRef = useRef<QuoteMap>({});\r\n    const subscribedRef = useRef<Set<string>>(new Set());\r\n    const frameRef = useRef<number | null>(null);\r\n\r\n    const [quotes, setQuotes] = useState<QuoteMap>({});\r\n\r\n    function pickNumber(...values: Array<number | string | undefined | null>) {\r\n        for (const v of values) {\r\n            if (v === undefined || v === null) continue;\r\n            const n = Number(v);\r\n            if (Number.isFinite(n)) return n;\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /* SOCKET INIT */\r\n    useEffect(() => {\r\n        if (!token) return;\r\n        const socket = new MarketSocket();\r\n        socketRef.current = socket;\r\n\r\n        socket.connect(token, (msg: any) => {\r\n            if (msg.status === \"subscribed\") {\r\n                const s = msg.symbol;\r\n                if (!bufferRef.current[s]) return;\r\n\r\n                const nextOpen = pickNumber(\r\n                    msg.dayOpen,\r\n                    msg.open,\r\n                    msg.data?.dayOpen,\r\n                    msg.data?.open\r\n                );\r\n                const nextClose = pickNumber(\r\n                    msg.dayClose,\r\n                    msg.close,\r\n                    msg.data?.dayClose,\r\n                    msg.data?.close,\r\n                    msg.prevClose,\r\n                    msg.data?.prevClose\r\n                );\r\n\r\n                bufferRef.current[s] = {\r\n                    ...bufferRef.current[s],\r\n                    high: Number(msg.dayHigh),\r\n                    low: Number(msg.dayLow),\r\n                    open: nextOpen ?? bufferRef.current[s].open,\r\n                    close: nextClose ?? bufferRef.current[s].close,\r\n                };\r\n                flush();\r\n                return;\r\n            }\r\n\r\n            if (msg.type === \"orderbook\") {\r\n                const s = msg.data.code;\r\n                const bid = msg.data.bids?.[0];\r\n                const ask = msg.data.asks?.[0];\r\n                if (!bid || !ask) return;\r\n\r\n                const old = bufferRef.current[s];\r\n                if (!old) return;\r\n\r\n                const nextOpen = pickNumber(\r\n                    msg.data?.dayOpen,\r\n                    msg.data?.open,\r\n                    msg.data?.openPrice\r\n                );\r\n                const nextClose = pickNumber(\r\n                    msg.data?.dayClose,\r\n                    msg.data?.close,\r\n                    msg.data?.prevClose\r\n                );\r\n\r\n                bufferRef.current[s] = {\r\n                    ...old,\r\n                    bid: bid.price,\r\n                    ask: ask.price,\r\n                    bidVolume: bid.volume,\r\n                    askVolume: ask.volume,\r\n                    high: msg.data.dayHigh ?? old.high,\r\n                    low: msg.data.dayLow ?? old.low,\r\n                    open: nextOpen ?? old.open,\r\n                    close: nextClose ?? old.close,\r\n                    bidDir:\r\n                        old.bid === \"--\"\r\n                            ? \"same\"\r\n                            : Number(bid.price) > Number(old.bid)\r\n                                ? \"up\"\r\n                                : Number(bid.price) < Number(old.bid)\r\n                                    ? \"down\"\r\n                                    : old.bidDir,\r\n                    askDir:\r\n                        old.ask === \"--\"\r\n                            ? \"same\"\r\n                            : Number(ask.price) > Number(old.ask)\r\n                                ? \"up\"\r\n                                : Number(ask.price) < Number(old.ask)\r\n                                    ? \"down\"\r\n                                    : old.askDir,\r\n                };\r\n\r\n                flush();\r\n            }\r\n\r\n        });\r\n\r\n        // subscribe any symbols that were queued before socket was ready\r\n        subscribedRef.current.forEach((s) => {\r\n            socket.subscribe(s);\r\n        });\r\n\r\n        return () => {\r\n            socket.close();\r\n            socketRef.current = null;\r\n        };\r\n    }, [token]);\r\n\r\n    /* SYMBOL SYNC */\r\n    useEffect(() => {\r\n        const next = new Set(symbols);\r\n\r\n        symbols.forEach((s) => {\r\n            if (!subscribedRef.current.has(s)) {\r\n                subscribedRef.current.add(s);\r\n                bufferRef.current[s] = {\r\n                    symbol: s,\r\n                    bid: \"--\",\r\n                    ask: \"--\",\r\n                    bidVolume: \"--\",\r\n                    askVolume: \"--\",\r\n                    bidDir: \"same\",\r\n                    askDir: \"same\",\r\n                };\r\n                socketRef.current?.subscribe(s);\r\n            }\r\n        });\r\n\r\n        Object.keys(bufferRef.current).forEach((s) => {\r\n            if (!next.has(s)) {\r\n                delete bufferRef.current[s];\r\n                subscribedRef.current.delete(s);\r\n                socketRef.current?.unsubscribe(s);\r\n            }\r\n        });\r\n\r\n        flush();\r\n    }, [symbols]);\r\n\r\n    function flush() {\r\n        if (frameRef.current) return;\r\n        frameRef.current = requestAnimationFrame(() => {\r\n            frameRef.current = null;\r\n            setQuotes({ ...bufferRef.current });\r\n        });\r\n    }\r\n\r\n    return quotes;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useResetAccountPasswords.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminBrokerage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminClosedTrades.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminOpenTrades.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminOrderActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminPendingOpenOrders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminPendingOrders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useTradeAdminSummary.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useUpdateAdminUser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\useUpdateAdminUserAccount.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\withdrawals\\useCreateAdminWithdrawal.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\withdrawals\\useWithdrawalActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\hooks\\withdrawals\\useWithdrawals.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\proxy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\queries\\defaultWatchlist.queries.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\queries\\marketSchedule.queries.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\accountAuth.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\accountPlan.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\admin.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\adminDeposit.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\auth\\auth.services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\cloudinary.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\defaultWatchlist.service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[474,477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[474,477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[663,666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[663,666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from \"@/api/axios\";\r\n\r\nexport type DefaultWatchlistItem = {\r\n  code: string;\r\n  name: string;\r\n};\r\n\r\ntype ApiResponse<T> = {\r\n  success: boolean;\r\n  message: string;\r\n  data: T;\r\n};\r\n\r\nexport async function fetchDefaultWatchlist() {\r\n  const res = await api.get<ApiResponse<DefaultWatchlistItem[]>>(\r\n    \"/watchlist/default/list\"\r\n  );\r\n  return res.data;\r\n}\r\n\r\nexport async function addDefaultWatchlist(code: string) {\r\n  const res = await api.post<ApiResponse<any>>(\r\n    \"/watchlist/default/add\",\r\n    { code }\r\n  );\r\n  return res.data;\r\n}\r\n\r\nexport async function removeDefaultWatchlist(code: string) {\r\n  const res = await api.delete<ApiResponse<any>>(\r\n    `/watchlist/default/remove/${code}`\r\n  );\r\n  return res.data;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\health.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\inquiry\\inquiry.services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\instrument.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\kyc\\kyc.services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\kyc\\kyc.types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\marketSchedule.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\marketSocket.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\notification\\notification.services.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[811,814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[811,814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from \"@/api/axios\";\r\n\r\nexport type NotificationType = \"MAINTENANCE\" | \"HOLIDAY\" | \"GENERAL\" | \"INFORMATION\";\r\n\r\nexport type Notification = {\r\n  _id: string;\r\n  title: string;\r\n  message: string;\r\n  data: {\r\n    type: NotificationType;\r\n  };\r\n  isActive: boolean;\r\n  expireAt: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  __v: number;\r\n};\r\n\r\nexport interface NotificationListResponse {\r\n  list: Notification[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    totalPages: number;\r\n    totalItems: number;\r\n  };\r\n}\r\n\r\nexport type BroadcastNotificationPayload = {\r\n  title: string;\r\n  message: string;\r\n  expireAt: string;\r\n  data: {\r\n    type: NotificationType;\r\n  };\r\n};\r\n\r\nexport async function broadcastNotificationService(\r\n  payload: BroadcastNotificationPayload\r\n): Promise<any> {\r\n  const res = await api.post(\"/notification/admin/broadcast\", payload);\r\n  return res.data;\r\n}\r\n\r\nexport async function getAdminNotificationsService(\r\n  page: number = 1,\r\n  limit: number = 10\r\n): Promise<NotificationListResponse> {\r\n  const res = await api.get(\"/notification\", {\r\n    params: { page, limit },\r\n  });\r\n  \r\n  // Transform API response to match expected structure\r\n  const apiData = res.data.data as Notification[];\r\n  const totalItems = apiData.length * 3; // Estimate based on your data\r\n  \r\n  return {\r\n    list: apiData,\r\n    pagination: {\r\n      page,\r\n      limit,\r\n      totalPages: Math.ceil(totalItems / limit),\r\n      totalItems,\r\n    },\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\payment-method\\payment-method.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\tradeAdmin.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\user.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\userFunds.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\services\\withdrawal.service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\account.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\accountPlan.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\health.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\inquiry.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\instrument.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\market.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\transaction.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Admin-frontend-als\\types\\user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]